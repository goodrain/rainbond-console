(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[44],{"1+/a":function(e,t,a){"use strict";var r=a("g09b"),o=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a("jehZ"));a("+L6B");var u=r(a("2/Rp"));a("Pwec");var s,i,d,l=r(a("CtXQ")),p=a("MuoO"),c=a("7DNP"),m=o(a("q1tI")),g=a("LLXN"),h=(r(a("I3bc")),r(a("XZXw"))),f=a("vSx2"),v=r(a("2pvv")),_=r(a("QDog")),b=(r(a("tH/r")),r(a("2lxJ"))),y=(r(a("mWxT")),r(a("9Qkj"))),C=r(a("X5up")),A=r(a("/KFZ")),N=r(a("oqMN")),I=(s=(0,p.connect)(e=>{var t=e.teamControl,a=e.global,r=e.enterprise,o=e.user;return{currentUser:o.currentUser,rainbondInfo:a.rainbondInfo,currentTeam:t.currentTeam,currentRegionName:t.currentRegionName,currentEnterprise:r.currentEnterprise,enterprise:a.enterprise,currentTeamPermissionsInfo:t.currentTeamPermissionsInfo}},null,null,{pure:!1}),s((d=class extends m.PureComponent{constructor(e){var t,a,r;super(e),this.handleTabChange=(e=>{var t=this.props.dispatch,a=_.default.getAppID();t(c.routerRedux.push("/team/".concat(_.default.getCurrTeamName(),"/region/").concat(_.default.getCurrRegionName(),"/create/yaml/").concat(e,"?group_id=").concat(a)))}),this.state={teamAppCreatePermission:y.default.queryPermissionsInfo(this.props.currentTeamPermissionsInfo&&this.props.currentTeamPermissionsInfo.team,"team_app_create"),region_id:null===(t=this.props.currentTeam)||void 0===t?void 0:null===(a=t.region[0])||void 0===a?void 0:a.region_id,eid:null===(r=this.props.currentUser)||void 0===r?void 0:r.enterprise_id}}componentWillMount(){}render(){var e,t,a,r=this.props,o=r.rainbondInfo,s=(r.enterprise,r.match),i=r.currentEnterprise,d=r.currentTeam,p=r.currentRegionName,I=this.state.teamAppCreatePermission.isAccess,M=!(null===o||void 0===o?void 0:null===(e=o.security_restrictions)||void 0===e?void 0:e.enable);if(!I)return y.default.noPermission();var T={yaml:C.default,importCluster:v.default,helm:A.default,outerCustom:N.default},E=[{key:"yaml",tab:(0,g.formatMessage)({id:"teamAdd.create.upload.uploadFiles.yaml"})},{key:"outerCustom",tab:(0,g.formatMessage)({id:"appOverview.list.table.btn.third_party"})}];M&&E.push({key:"importCluster",tab:(0,g.formatMessage)({id:"teamAdd.create.upload.uploadFiles.k8s"})},{key:"helm",tab:(0,g.formatMessage)({id:"teamAdd.create.upload.uploadFiles.helm"})});var P=s.params.type;P=P.split("?")[0],P||(P="yaml");var k=T[P],w=[];w=(0,f.createTeam)((0,f.createEnterprise)(w,i),d,p),w.push({title:"\u521b\u5efa\u7ec4\u4ef6"});var R=_.default.getAppID(),S=(null===(t=this.props.location)||void 0===t?void 0:null===(a=t.query)||void 0===a?void 0:a.type)||"";return m.default.createElement(h.default,{breadcrumbList:w,title:M?(0,g.formatMessage)({id:"teamAdd.create.upload.title"}):"YAML",onTabChange:this.handleTabChange,content:m.default.createElement("p",null,M?(0,g.formatMessage)({id:"teamAdd.create.upload.desc"}):"\u652f\u6301\u4ece Kubernetes YAML\u521b\u5efa\u7ec4\u4ef6"),tabActiveKey:P,tabList:E,titleSvg:b.default.getPageHeaderSvg("yaml",18),extraContent:m.default.createElement(u.default,{onClick:()=>{var e=this.props.dispatch;e(c.routerRedux.push("/team/".concat(_.default.getCurrTeamName(),"/region/").concat(_.default.getCurrRegionName(),"/create/wizard?group_id=").concat(R,"&type=").concat(S)))},type:"default"},m.default.createElement(l.default,{type:"rollback"}),(0,g.formatMessage)({id:"button.return"}))},k?m.default.createElement(k,(0,n.default)({eid:this.state.eid,region_id:this.state.region_id},this.props,{type:this.props.match.params.type,tabList:E,groupId:R})):m.default.createElement(m.default.Fragment,null,(0,g.formatMessage)({id:"teamAdd.create.error"})))}},i=d))||i);t.default=I},X5up:function(e,t,a){"use strict";var r=a("g09b"),o=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var n,u,s,i=r(a("bx4M")),d=r(a("jehZ")),l=r(a("p0pE")),p=a("MuoO"),c=a("7DNP"),m=o(a("q1tI")),g=(a("LLXN"),r(a("IMHh"))),h=r(a("/BFj")),f=r(a("QDog")),v=r(a("9Qkj")),_=r(a("51sS")),b=(n=(0,p.connect)(e=>{var t=e.user,a=e.global;return{currUser:t.currentUser,groups:a.groups}}),n((s=class extends m.PureComponent{constructor(e){super(e),this.onAddGroup=(()=>{this.setState({addGroup:!0})}),this.cancelAddGroup=(()=>{this.setState({addGroup:!1})}),this.handleAddGroup=(e=>{var t=this.props.form.setFieldsValue;this.props.dispatch({type:"application/addGroup",payload:(0,l.default)({team_name:f.default.getCurrTeamName()},e),callback:e=>{e&&this.props.dispatch({type:"global/fetchGroups",payload:{team_name:f.default.getCurrTeamName(),region_name:f.default.getCurrRegionName()},callback:()=>{t({group_id:e.group_id}),this.cancelAddGroup()}})}})}),this.hideShowKey=(()=>{this.setState({showKey:!1})}),this.handleSubmit=((e,t)=>{var a=f.default.getCurrTeamName(),r=f.default.getCurrRegionName(),o=this.props,n=o.dispatch,u=o.groups;if(!e.group_name){var s=u.find(t=>t.group_id==e.group_id);e.group_name=s.group_name}n(c.routerRedux.push("/team/".concat(a,"/region/").concat(r,"/importMessageYaml?event_id=").concat(t,"&group_id=").concat(e.group_id,"&group_name=").concat(e.group_name)))}),this.installApp=((e,t)=>{var a=this.props.dispatch,r=f.default.getCurrTeamName(),o=f.default.getCurrRegionName();a({type:"application/addGroup",payload:{region_name:o,team_name:r,group_name:e.group_name,k8s_app:e.k8s_app,note:""},callback:a=>{a&&a.group_id&&(v.default.refreshPermissionsInfo(),e.group_id=a.group_id,e.group_name=a.group_name,this.handleSubmit(e,t))},handleError:()=>{}})}),this.handleInstallApp=((e,t)=>{e.group_id?this.handleSubmit(e,t):this.installApp(e,t)}),this.state={}}render(){return m.default.createElement(i.default,null,m.default.createElement(h.default,null),m.default.createElement("div",{className:_.default.formWrap},m.default.createElement(g.default,(0,d.default)({onSubmit:this.handleInstallApp},this.props))))}},u=s))||u);t.default=b}}]);