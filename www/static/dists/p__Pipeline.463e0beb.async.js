(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[72],{dAKh:function(e,t,a){"use strict";var n=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var i,o,s,l=n(a("W9HT")),c=r(a("q1tI")),m=a("MuoO"),d=a("7DNP"),p=(n(a("XZXw")),n(a("QDog"))),u=(i=(0,m.connect)(e=>{var t=e.user,a=e.teamControl,n=e.global;return{user:t.currentUser,teamControl:a.currentTeam,teamOverview:n.teamOverview}}),i((s=class extends c.Component{constructor(e){super(e),this.receiveMessage=(e=>{if(void 0!==e&&e.data&&"GOTO_DEPLOY_DETAIL"==e.data.flag){var t=e.data,a=t.region_name,n=t.team_name,r=t.service_alias;this.props.dispatch(d.routerRedux.push("/team/".concat(n,"/region/").concat(a,"/apps/").concat(p.default.getAppID(),"/overview?type=components&componentID=").concat(r,"&tab=overview")))}}),this.loadOverview=(()=>{var e=this.props.dispatch;e({type:"index/fetchOverview",payload:{team_name:p.default.getCurrTeamName(),region_name:p.default.getCurrRegionName()},callback:e=>{e&&e.bean&&this.setState({team_name:e.bean.team_alias})}})}),this.fetchPluginInfo=(()=>{var e=this.props,t=e.dispatch,a=e.match.params,n=(a.teamName,a.regionName),r=e.user;t({type:"teamControl/fetchPluginUrl",payload:{enterprise_id:r.enterprise_id,region_name:n},callback:e=>{e.list.map(e=>{"pipeline"==e.name&&this.setState({domianUrl:e.urls[0]})})}})}),this.fetchInfo=(()=>{var e=this.props.dispatch;e({type:"teamControl/fetchToken",payload:{team_name:p.default.getCurrTeamName(),tokenNode:"pipeline"},callback:e=>{e&&200==e.status_code&&this.setState({token:e.bean.access_key||!1})}})}),this.state={token:null,domianUrl:null,pipelineArr:[]}}componentDidMount(){this.fetchPluginInfo(),this.fetchInfo(),window.addEventListener("message",this.receiveMessage,!1)}componentWillUnmount(){window.removeEventListener("message",this.receiveMessage)}render(){var e=this.state,t=e.token,a=e.domianUrl,n=this.props,r=n.teamControl,i=n.teamOverview,o=i&&i.team_id||!1,s=r.team_alias||!1;return c.default.createElement("div",{style:{margin:"0px"}},t&&o&&a&&s?c.default.createElement("div",{style:{height:"100vh"}},c.default.createElement("iframe",{src:"".concat(a,"/app-service?token=").concat(t,"&teamId=").concat(o,"&teamName=").concat(s),style:{width:"100%",height:"100%"},id:"myframe",sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",scrolling:"auto",frameBorder:"no",border:"0",marginWidth:"0",marginHeight:"0"})):c.default.createElement("div",{style:{height:" 70vh ",display:"flex",alignItems:"center",justifyContent:"center"}},c.default.createElement(l.default,{size:"large"})))}},o=s))||o),h=u;t.default=h}}]);