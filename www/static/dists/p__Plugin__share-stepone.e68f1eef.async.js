(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[66],{vYQB:function(e,a,t){"use strict";var l=t("g09b"),r=t("tAuX");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("IzEo");var u=l(t("bx4M"));t("14J3");var n=l(t("BMrR"));t("DZo9");var i=l(t("8z0m"));t("jCWc");var d=l(t("kPKH")),s=l(t("jehZ")),p=l(t("p0pE"));t("Pwec");var o=l(t("CtXQ"));t("lUTK");var f=l(t("BvKs"));t("OaEy");var c=l(t("2fM7"));t("7Kak");var m=l(t("9yH6"));t("+L6B");var h=l(t("2/Rp"));t("5NDa");var g=l(t("5rEg"));t("y8nQ");var v,E,b,I,y=l(t("Vl3Y")),_=t("MuoO"),C=t("7DNP"),S=r(t("q1tI")),N=l(t("nyIC")),R=l(t("WnAZ")),k=l(t("tbSg")),L=l(t("XZXw")),P=l(t("8+Sn")),T=l(t("QDog")),w=(y.default.Item,g.default.TextArea),D=(h.default.Group,m.default.Group),M=(c.default.Option,f.default.SubMenu,{labelCol:{span:8},wrapperCol:{span:16}}),x=P.default.get("token"),A={};x&&(A.Authorization="GRJWT ".concat(x),A.X_REGION_NAME=T.default.getCurrRegionName(),A.X_TEAM_NAME=T.default.getCurrTeamName());var q=S.default.createElement("div",null,S.default.createElement(o.default,{type:"plus"}),S.default.createElement("div",{className:"ant-upload-text"},"\u4e0a\u4f20\u56fe\u6807")),G=(v=(0,_.connect)(e=>{var a=e.user,t=e.application,l=e.loading;return{currUser:a.currentUser,apps:t.apps,groupDetail:t.groupDetail||{},loading:l}}),E=y.default.create(),v(b=E((I=class extends S.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{this.props.dispatch;this.props.form.validateFields((e,a)=>{var t=a.pic&&a.pic.file&&a.pic.file.response&&a.pic.file.response.data&&a.pic.file.response.data.bean?a.pic.file.response.data.bean.file_url:"",l=(0,p.default)({},this.state.info,a,{pic:t||this.state.info.pic});if(!e){var r=this.props.dispatch,u=this.getParams();r({type:"plugin/submitSharePlugin",payload:{team_name:T.default.getCurrTeamName(),shareId:u.shareId,share_plugin_info:l},callback:e=>{r(C.routerRedux.push("/team/".concat(T.default.getCurrTeamName(),"/region/").concat(T.default.getCurrRegionName(),"/shareplugin/step-two/").concat(u.pluginId,"/").concat(u.shareId)))}})}})}),this.handleGiveup=(()=>{var e=this.props.match.params.pluginId,a=this.props.dispatch;a({type:"plugin/giveupSharePlugin",payload:{team_name:T.default.getCurrTeamName(),share_id:this.props.match.params.shareId},callback:t=>{a(C.routerRedux.push("/team/".concat(T.default.getCurrTeamName(),"/region/").concat(T.default.getCurrRegionName(),"/myplugns/").concat(e)))}})}),this.handleLogoChange=(e=>{var a=e.fileList;this.setState({fileList:a})}),this.handleLogoRemove=(()=>{this.setState({fileList:[]})}),this.state={toDelete:!1,recordShare:!1,checkShare:!0,ShareStep:0,ID:0,info:null,key:"",fileList:[]}}getParams(){return{pluginId:this.props.match.params.pluginId,shareId:this.props.match.params.shareId}}componentDidMount(){this.getShareInfo()}getShareInfo(){var e=this.props,a=e.dispatch,t=(e.form,e.index,T.default.getCurrTeamName()),l=(T.default.getCurrRegionName(),this.getParams());a({type:"plugin/getPluginShareInfo",payload:(0,p.default)({team_name:t},l),callback:e=>{e&&(this.setState({info:e.bean.share_plugin_info}),e.bean.share_plugin_info.pic&&this.setState({fileList:[{uid:-1,name:e.bean.share_plugin_info.pic,status:"done",url:e.bean.share_plugin_info.pic}]}))},handleError:e=>{e&&e.status}})}componentWillUnmount(){}render(){var e=this.state.info,a=this.props.form,t=a.getFieldDecorator,l=(a.getFieldValue,this.props.loading),r=this.state.fileList;return null===e?null:S.default.createElement(L.default,null,S.default.createElement("div",null,S.default.createElement(u.default,{style:{marginBottom:24},title:"\u57fa\u672c\u4fe1\u606f",bordered:!1,bodyStyle:{padding:0}},S.default.createElement("div",{style:{padding:"24px"}},S.default.createElement(y.default,{layout:"horizontal",className:k.default.stepForm},S.default.createElement(n.default,{gutter:24},S.default.createElement(d.default,{span:"12"},S.default.createElement(y.default.Item,(0,s.default)({},M,{label:"\u63d2\u4ef6\u540d"}),t("plugin_name",{initialValue:e.plugin_name,rules:[{required:!0,message:"\u63d2\u4ef6\u540d\u4e0d\u80fd\u4e3a\u7a7a"}]})(S.default.createElement(g.default,{placeholder:"\u9ed8\u8ba4\u4f7f\u7528\u4e0a\u6b21\u63d2\u4ef6\u540d"})))),S.default.createElement(d.default,{span:"12"},S.default.createElement(y.default.Item,(0,s.default)({},M,{label:"\u7248\u672c"}),t("version",{initialValue:e.version,rules:[{required:!0,message:"\u7248\u672c\u4e0d\u80fd\u4e3a\u7a7a"}]})(S.default.createElement(g.default,{placeholder:"\u9ed8\u8ba4\u4f7f\u7528\u4e0a\u6b21\u7684\u7248\u672c"})))),S.default.createElement(d.default,{span:"12"},S.default.createElement(y.default.Item,(0,s.default)({},M,{label:"\u53d1\u5e03\u8303\u56f4"}),t("scope",{initialValue:e.scope||"team",rules:[{required:!0}]})(S.default.createElement(D,null,S.default.createElement(m.default,{value:"team"},"\u56e2\u961f"),S.default.createElement(m.default,{value:"enterprise"},"\u516c\u53f8"),S.default.createElement(m.default,{value:"goodrain"},"\u516c\u6709\u4e91\u5e94\u7528\u5e02\u573a"))))),S.default.createElement(d.default,{span:"12"},S.default.createElement(y.default.Item,(0,s.default)({},M,{label:"\u63d2\u4ef6\u8bf4\u660e"}),t("desc",{initialValue:e.desc,rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u63d2\u4ef6\u8bf4\u660e"}]})(S.default.createElement(w,{placeholder:"\u8bf7\u8f93\u5165\u63d2\u4ef6\u8bf4\u660e"})))),S.default.createElement(d.default,{span:"12"},S.default.createElement(y.default.Item,(0,s.default)({},M,{label:"\u56fe\u6807"}),t("pic",{rules:[{required:!1,message:"\u8bf7\u4e0a\u4f20\u56fe\u6807"}]})(S.default.createElement(i.default,{className:"logo-uploader",name:"file",accept:"image/jpg,image/jpeg,image/png",action:N.default.imageUploadUrl,listType:"picture-card",fileList:r,headers:A,onChange:this.handleLogoChange,onRemove:this.handleLogoRemove},r.length>0?null:q)))))))),S.default.createElement(R.default,null,S.default.createElement(h.default,{type:"primary",htmlType:"submit",onClick:this.handleSubmit},"\u63d0\u4ea4"),S.default.createElement(h.default,{disabled:l.effects["plugin/giveupSharePlugin"],onClick:this.handleGiveup},"\u653e\u5f03\u53d1\u5e03"))))}},b=I))||b)||b);a.default=G}}]);