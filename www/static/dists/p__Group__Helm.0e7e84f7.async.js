(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[66],{"0fGy":function(e,t,a){"use strict";var s=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var l=s(a("bx4M"));a("g9YV");var o=s(a("wCAj"));a("y8nQ");var i=s(a("Vl3Y"));a("5NDa");var n=s(a("5rEg"));a("qVdP");var p=s(a("jsC+"));a("Pwec");var d=s(a("CtXQ"));a("lUTK");var u=s(a("BvKs"));a("P2fV");var c=s(a("NJEC"));a("+L6B");var m=s(a("2/Rp"));a("Awhp");var h=s(a("KrTs"));a("5Dmo");var f=s(a("3S7+"));a("/xke");var g,v,_,y=s(a("TeRw")),b=a("MuoO"),w=a("7DNP"),E=s(a("wd/R")),S=r(a("q1tI")),M=a("LLXN"),C=s(a("6JQQ")),I=s(a("movk")),A=(a("xpXo"),a("4/zt"),s(a("lpA0"))),k=s(a("8+Sn")),x=s(a("QDog")),O=s(a("VJda")),D=(g=(0,b.connect)(e=>{var t=e.global,a=e.loading;return{groups:t.groups,batchMoveLoading:a.effects["appControl/putBatchMove"],reStartLoading:a.effects["appControl/putReStart"],startLoading:a.effects["appControl/putStart"],stopLoading:a.effects["appControl/putStop"]}},null,null,{pure:!1}),g((_=class extends S.Component{constructor(e){super(e),this.onSelectChange=(e=>{this.setState({selectedRowKeys:e})}),this.updateApp=(()=>{this.timer&&clearInterval(this.timer),this.loadComponents();var e=this.props.clearTime;this.timer=setInterval(()=>{e||this.loadComponents()},5e3)}),this.loadComponents=(()=>{var e=this.props,t=e.dispatch,a=e.groupId,s=this.state,r=s.current,l=s.pageSize,o=s.query,i=s.sortValue,n=s.orderValue;t({type:"application/fetchApps",payload:{team_name:x.default.getCurrTeamName(),region_name:x.default.getCurrRegionName(),group_id:a,page:r,page_size:l,query:o,sort:i,order:n},callback:e=>{e&&200===e.status_code&&this.setState({apps:e.list||[],total:e.total||0,tableDataLoading:!1})}})}),this.deleteData=(()=>{var e=this.props,t=e.dispatch,a=e.groupId,s=this.state,r=s.current,l=s.pageSize,o=s.query;t({type:"application/fetchApps",payload:{team_name:x.default.getCurrTeamName(),region_name:x.default.getCurrRegionName(),group_id:a,page:r,page_size:l,query:o},callback:e=>{e&&200===e.status_code&&this.setState({apps:e.list||[],total:e.total||0},()=>{this.handleBatchDeletes(),this.hideMoveGroup()})}})}),this.handleOperation=((e,t)=>{var a=this.props.dispatch,s={putReStart:(0,M.formatMessage)({id:"notification.hint.component.putReStart"}),putStart:(0,M.formatMessage)({id:"notification.hint.component.putStart"}),putStop:(0,M.formatMessage)({id:"notification.hint.component.putStop"})};a({type:"appControl/".concat(e),payload:{team_name:x.default.getCurrTeamName(),app_alias:t.service_alias},callback:t=>{t&&y.default.success({message:s[e]})},handleError:e=>{y.default.error({message:e.data.msg_show})}})}),this.handleOperationState=(e=>{this.setState({operationState:e})}),this.handleBatchOperation=(e=>{var t=this.props.dispatch,a=this.getSelectedKeys(),s={stop:(0,M.formatMessage)({id:"notification.hint.component.putBatchStop"}),start:(0,M.formatMessage)({id:"notification.hint.component.putBatchStart"}),restart:(0,M.formatMessage)({id:"notification.hint.component.putBatchRestart"}),upgrade:(0,M.formatMessage)({id:"notification.hint.component.putBatchUpgrade"}),deploy:(0,M.formatMessage)({id:"notification.hint.component.putBatchDeploy"})};t({type:"appControl/batchOperation",payload:{action:e,team_name:x.default.getCurrTeamName(),serviceIds:a&&a.join(",")},callback:t=>{this.handleOperationState(!1),t&&s[e]&&y.default.success({message:s[e]})},handleError:e=>{y.default.error({message:e.data.msg_show})}})}),this.handleBatchDelete=(()=>{var e=this.getSelected();this.setState({batchDeleteApps:e,batchDeleteShow:!0})}),this.hideBatchDelete=(()=>{this.deleteData(),this.updateGroupMenu()}),this.handleBatchDeletes=(()=>{this.setState({batchDeleteApps:[],batchDeleteShow:!1,selectedRowKeys:[]})}),this.updateGroupMenu=(()=>{this.props.dispatch({type:"global/fetchGroups",payload:{team_name:x.default.getCurrTeamName(),region_name:x.default.getCurrRegionName()}})}),this.handleBatchMove=(e=>{var t=this.getSelectedKeys(),a=this.props.dispatch;a({type:"appControl/putBatchMove",payload:{team_name:x.default.getCurrTeamName(),serviceIds:t.join(","),move_group_id:e},callback:e=>{e&&(y.default.success({message:(0,M.formatMessage)({id:"notification.hint.component.putBatchMove"})}),this.hideBatchDelete())}})}),this.hideMoveGroup=(()=>{this.setState({moveGroupShow:!1})}),this.showBatchMove=(()=>{this.setState({moveGroupShow:!0})}),this.CanBatchOperation=(()=>{var e=this.getSelected();return e&&e.length>0}),this.handelChange=(e=>{this.setState({changeQuery:e.target.value})}),this.handleSearch=(()=>{this.setState({tableDataLoading:!0,current:1,query:this.state.changeQuery},()=>{this.updateApp()})}),this.handleTableChange=((e,t,a)=>{a&&a.field&&"status_cn"==a.field?this.setState({sortValue:1,orderValue:a.order,tableDataLoading:!0},()=>{this.loadComponents()}):a&&a.field&&"min_memory"==a.field?this.setState({sortValue:2,orderValue:a.order,tableDataLoading:!0},()=>{this.loadComponents()}):a&&a.field&&"update_time"==a.field?this.setState({sortValue:3,orderValue:a.order,tableDataLoading:!0},()=>{this.loadComponents()}):this.setState({sortValue:1,orderValue:"descend",tableDataLoading:!0},()=>{this.loadComponents()})}),this.titleCase=(e=>{e=e.toLowerCase();for(var t=e.split(" "),a=0;a<t.length;a++)t[a]=t[a].substring(0,1).toUpperCase()+t[a].substring(1);return t.join(" ")}),this.state={selectedRowKeys:[],apps:[],current:1,total:0,pageSize:10,moveGroupShow:!1,batchDeleteApps:[],batchDeleteShow:!1,operationState:!1,query:"",changeQuery:"",tableDataLoading:!0,sortValue:1,orderValue:"descend",language:"zh-CN"===k.default.get("language")}}componentDidMount(){this.updateApp()}shouldComponentUpdate(){return!0}componentWillUnmount(){clearInterval(this.timer),this.props.dispatch({type:"application/clearApps"})}getSelectedKeys(){var e=this.getSelected();return e.map(e=>e.service_id)}getSelected(){var e=this.state,t=e.selectedRowKeys,a=e.apps,s=[];return t.map(e=>{a.map(t=>{e==t.service_id&&s.push(t)})}),s}render(){var e=this.props,t=e.componentPermissions,a=t.isStart,s=t.isStop,r=t.isDelete,g=t.isEdit,v=t.isUpdate,_=t.isConstruct,y=(e.componentPermissions,e.batchMoveLoading),b=e.reStartLoading,k=e.startLoading,D=e.stopLoading,N=e.groupId,T=e.groups,R=this.state,L=R.selectedRowKeys,V=R.current,B=R.total,H=R.apps,q=R.pageSize,U=R.batchDeleteShow,F=R.batchDeleteApps,P=R.moveGroupShow,j=R.operationState,G=R.tableDataLoading,J=R.language,K={selectedRowKeys:L,onChange:this.onSelectChange},z={showQuickJumper:!0,showTotal:e=>"".concat(J?"\u5171 ".concat(e," \u6761"):"Total ".concat(e," items")),pageSize:q,current:V,total:B,showSizeChanger:!0,onChange:e=>{this.setState({current:e,selectedRowKeys:[]},()=>{this.loadComponents()})},onShowSizeChange:(e,t)=>{this.setState({current:e,pageSize:t},()=>{this.loadComponents()})}},Q=[{title:(0,M.formatMessage)({id:"appOverview.list.table.btn.name"}),dataIndex:"service_cname",render:(e,t)=>S.default.createElement(w.Link,{to:"/team/".concat(x.default.getCurrTeamName(),"/region/").concat(x.default.getCurrRegionName(),"/apps/").concat(x.default.getAppID(),"/overview?type=components&componentID=").concat(t.service_alias,"&tab=overview")}," ",t.service_source&&"third_party"===t.service_source?S.default.createElement("span",null,S.default.createElement(f.default,{title:(0,M.formatMessage)({id:"appOverview.list.table.btn.third_party"})},S.default.createElement("span",{style:{borderRadius:"50%",height:"20px",width:"20px",display:"inline-block",background:"#1890ff",verticalAlign:"top",marginRight:"3px"}},S.default.createElement("span",{style:{display:"block",color:"#FFFFFF",height:"20px",lineHeight:"20px",textAlign:"center"}},"3")),e)):S.default.createElement("span",null,e)," ")},{title:(0,M.formatMessage)({id:"appOverview.list.table.memory"}),dataIndex:"min_memory",sorter:!0,render:(e,t)=>S.default.createElement("span",null,t.service_source&&"third_party"===t.service_source?"-":"".concat(e,"MB"))},{title:(0,M.formatMessage)({id:"appOverview.list.table.status"}),dataIndex:J?"status_cn":"status",sorter:!0,render:(e,t)=>t.service_source&&"third_party"===t.service_source?S.default.createElement(h.default,{status:A.default.appStatusToBadgeStatus(t.status),text:"\u8fd0\u884c\u4e2d"===e?this.titleCase((0,M.formatMessage)({id:"status.component.health"})):"\u8fd0\u884c\u5f02\u5e38"===e?this.titleCase((0,M.formatMessage)({id:"status.component.not_health"})):"\u5df2\u5173\u95ed"===e?this.titleCase((0,M.formatMessage)({id:"status.component.off_line"})):this.titleCase(e)}):S.default.createElement(h.default,{status:A.default.appStatusToBadgeStatus(t.status),text:this.titleCase(e)})},{title:(0,M.formatMessage)({id:"appOverview.list.table.updateTime"}),dataIndex:"update_time",sorter:!0,render:e=>(0,E.default)(e).locale("zh-cn").format("YYYY-MM-DD HH:mm:ss")},{title:(0,M.formatMessage)({id:"appOverview.list.table.operate"}),dataIndex:"action",render:(e,t)=>S.default.createElement(S.Fragment,null,t.service_source&&"third_party"!==t.service_source&&S.default.createElement(S.Fragment,null,v&&S.default.createElement(c.default,{title:(0,M.formatMessage)({id:"confirmModal.component.restart.title"}),onConfirm:()=>{this.handleOperation("putReStart",t)}},S.default.createElement(m.default,{type:"link"},(0,M.formatMessage)({id:"appOverview.list.table.restart"}))),a&&S.default.createElement(c.default,{title:(0,M.formatMessage)({id:"confirmModal.component.start.title"}),onConfirm:()=>{this.handleOperation("putStart",t)}},S.default.createElement(m.default,{type:"link"},(0,M.formatMessage)({id:"appOverview.list.table.start"}))),s&&S.default.createElement(c.default,{title:(0,M.formatMessage)({id:"confirmModal.component.stop.title"}),onConfirm:()=>{this.handleOperation("putStop",t)}},S.default.createElement(m.default,{type:"link"},(0,M.formatMessage)({id:"appOverview.btn.stop"})))))}],X=[{permissions:_,name:(0,M.formatMessage)({id:"appOverview.btn.build"}),action:"deploy"},{permissions:v,name:(0,M.formatMessage)({id:"appOverview.btn.update"}),action:"upgrade"},{permissions:v,name:(0,M.formatMessage)({id:"appOverview.list.table.restart"}),action:"restart"},{permissions:s,name:(0,M.formatMessage)({id:"appOverview.btn.stop"}),action:"stop"},{permissions:a,name:(0,M.formatMessage)({id:"appOverview.list.table.start"}),action:"start"},{permissions:g,name:(0,M.formatMessage)({id:"appOverview.list.table.move"}),action:!1,customMethods:this.showBatchMove},{permissions:r,name:(0,M.formatMessage)({id:"appOverview.list.table.delete"}),action:!1,customMethods:this.handleBatchDelete}],Y=S.default.createElement(u.default,null,X.map(e=>{var t=e.permissions,a=e.name,s=e.action,r=e.customMethods;return t&&S.default.createElement(u.default.Item,{style:{textAlign:"center"}},S.default.createElement("a",{loading:j===s&&j,onClick:()=>{s?(this.handleOperationState(s),this.handleBatchOperation(s)):r()}},a))})),W=S.default.createElement("div",{className:O.default.tableList},S.default.createElement("div",{className:O.default.tableListOperator},S.default.createElement(p.default,{overlay:Y,trigger:["click"],placement:"topCenter",disabled:!this.CanBatchOperation()},S.default.createElement(m.default,{style:{padding:"8px 16px"}},(0,M.formatMessage)({id:"appOverview.list.table.batchOperate"})," ",S.default.createElement(d.default,{type:"down"})))));return S.default.createElement("div",{className:O.default.container},S.default.createElement(l.default,{style:{minHeight:400},bordered:!1,bodyStyle:{padding:"10px 10px"}},S.default.createElement(i.default,{layout:"inline",style:{marginBottom:"10px"}},S.default.createElement(i.default.Item,null,S.default.createElement(n.default,{style:{width:250},placeholder:(0,M.formatMessage)({id:"appOverview.list.input.seach.hint"}),onChange:this.handelChange,onPressEnter:this.handleSearch})),S.default.createElement(i.default.Item,null,S.default.createElement(m.default,{type:"primary",onClick:this.handleSearch,icon:"search"},(0,M.formatMessage)({id:"appOverview.list.btn.seach"})))),S.default.createElement("div",{className:O.default.list},S.default.createElement(o.default,{pagination:z,rowSelection:K,onChange:this.handleTableChange,columns:Q,loading:b||k||D||G,dataSource:H||[],rowKey:e=>e.service_id}),W),U&&S.default.createElement(I.default,{batchDeleteApps:F,onCancel:this.hideBatchDelete,onOk:this.hideBatchDelete}),P&&S.default.createElement(C.default,{loading:y,currGroupID:N,groups:T,onOk:this.handleBatchMove,onCancel:this.hideMoveGroup})))}},v=_))||v);t.default=D},"8vpL":function(e,t,a){"use strict";var s=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var l=s(a("kLXV"));a("/xke");var o,i,n,p=s(a("TeRw")),d=a("MuoO"),u=a("7DNP"),c=r(a("q1tI")),m=a("LLXN"),h=s(a("nyIC")),f=s(a("q76B")),g=s(a("QDog")),v=(s(a("hMqj")),s(a("J5jb")),s(a("rIpq")),s(a("zcww")),s(a("+iC2")),s(a("TO+K")),s(a("e6Ls"))),_=(s(a("R2TL")),o=(0,d.connect)(e=>{var t=e.user,a=e.appControl,s=e.global,r=e.teamControl,l=e.enterprise,o=e.loading;return{currUser:t.currentUser,appDetail:a.appDetail,pods:a.pods,groups:s.groups,build_upgrade:a.build_upgrade,currentTeam:r.currentTeam,currentRegionName:r.currentRegionName,currentEnterprise:l.currentEnterprise,deleteAppLoading:o.effects["appControl/deleteApp"],reStartLoading:o.effects["appControl/putReStart"],startLoading:o.effects["appControl/putStart"],stopLoading:o.effects["appControl/putStop"],moveGroupLoading:o.effects["appControl/moveGroup"],editNameLoading:o.effects["appControl/editName"],updateRollingLoading:o.effects["appControl/putUpdateRolling"],deployLoading:o.effects["appControl/putUpgrade"],buildInformationLoading:o.effects["appControl/getBuildInformation"]}},null,null,{withRef:!0}),o((n=class extends c.default.Component{constructor(){var e;super(...arguments),e=this,this.state={flag:!1,appAlias:"",promptModal:null,closes:!1,start:!1,updated:!1,actionIng:!1,keyes:!1,srcUrl:"/static/www/weavescope/index.html",teamName:"",regionName:"",build:!1},this.cancelDeleteApp=function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e.setState({flag:!1})},this.handleDeleteApp=(()=>{var e=g.default.getCurrTeamName(),t=g.default.getCurrRegionName(),a=this.props,s=a.group_id,r=a.dispatch;r({type:"appControl/deleteApp",payload:{team_name:e,app_alias:this.state.appAlias},callback:()=>{this.cancelDeleteApp(!1),this.refreshFrame(),r({type:"global/fetchGroups",payload:{team_name:e}}),r(u.routerRedux.replace("/team/".concat(e,"/region/").concat(t,"/apps/").concat(s)))}})}),this.handleOffHelpfulHints=(()=>{this.setState({promptModal:null,closes:!1})}),this.saveRef=(e=>{this.ref=e}),this.getChildCom=(()=>{return this.ref?this.ref.getWrappedInstance({}):null}),this.handleOperation=(e=>{var t=this.state.actionIng,a=g.default.getCurrTeamName(),s=(g.default.getCurrRegionName(),this.props),r=(s.group_id,s.dispatch);if(t)p.default.warning({message:(0,m.formatMessage)({id:"notification.warn.executing"})});else{var l={putReStart:(0,m.formatMessage)({id:"notification.success.operationRestart"}),putStart:(0,m.formatMessage)({id:"notification.success.operationStart"}),putStop:(0,m.formatMessage)({id:"notification.success.operationClose"}),putUpdateRolling:(0,m.formatMessage)({id:"notification.success.operationUpdata"}),putBuild:(0,m.formatMessage)({id:"notification.success.deployment"})};r({type:"appControl/".concat(e),payload:{team_name:a,app_alias:this.state.appAlias},callback:t=>{t&&p.default.success({message:l[e]}),this.handleOffHelpfulHints(),this.refreshFrame()}})}}),this.handleJumpAgain=(()=>{var e=this.state.promptModal;if("build"===e)return this.handleDeploy(),null;var t="stop"===e?"putStop":"start"===e?"putStart":"restart"===e?"putReStart":"build"===e?"putBuild":"rolling"===e?"putUpdateRolling":"";this.handleOperation(t)}),this.refreshFrame=(()=>{document.getElementById("myframe").contentWindow.location.reload(!0)}),this.handleDeploy=(()=>{var e=this.state,t=e.actionIng,a=e.appAlias,s=g.default.getCurrTeamName(),r=(g.default.getCurrRegionName(),this.props),l=(r.build_upgrade,r.dispatch);t?p.default.warning({message:(0,m.formatMessage)({id:"notification.warn.executing"})}):l({type:"appControl/putDeploy",payload:{team_name:s,app_alias:a,group_version:"",is_upgrate:""},callback:e=>{e&&p.default.success({message:(0,m.formatMessage)({id:"notification.success.deployment"})}),this.handleOffHelpfulHints(),this.refreshFrame()}})})}componentWillMount(){var e=this,t=g.default.getCurrTeamName(),a=g.default.getCurrRegionName(),s=this.props,r=s.group_id,l=s.dispatch,o="".concat(h.default.baseUrl,"/console/teams/").concat(t,"/regions/").concat(a,"/topological?group_id=").concat(r),i="".concat(h.default.baseUrl,"/console/teams/").concat(t,"/regions/").concat(a,"/topological"),n="".concat(h.default.baseUrl,"/console/teams/").concat(t,"/groups/").concat(r);try{window.iframeGetNodeUrl=function(){return o},window.iframeGetNodeVistitUrl=function(){return i},window.iframeGetMonitor=function(e,a){return l({type:"application/groupMonitorData",payload:{team_name:t,group_id:r},callback:t=>{t&&e&&e(t)},handleError:e=>{a&&a(e)}}),o},window.iframeGetAppName=function(){return n},window.iframeGetTenantName=function(){return t},window.iframeGetRegion=function(){return a},window.iframeGetGroupId=function(){return r},window.handleClickService=function(e,s){l(s?u.routerRedux.push("/team/".concat(t,"/region/").concat(a,"/apps/").concat(e.app_id,"/overview")):u.routerRedux.push("/team/".concat(t,"/region/").concat(a,"/components/").concat(e.service_alias,"/overview")))},window.handleClickRelation=function(e){l(u.routerRedux.push("/team/".concat(t,"/region/").concat(a,"/components/").concat(e.service_alias,"/overview")))},window.handleClickTerminal=function(s){e.setState({teamName:t,regionName:a,appAlias:s.service_alias});document.getElementById("links").click()},window.handleClickBuild=function(t,a){"build"==t&&e.setState({closes:!1,start:!1,updated:!1,build:!0,appAlias:a.service_alias,promptModal:"build"})},window.handleClickUpdate=function(t,a){"update"==t&&e.setState({closes:!1,start:!1,updated:!0,appAlias:a.service_alias,promptModal:"rolling"})},window.handleClickCloses=function(t,a){"closes"==t&&e.setState({closes:!0,start:!1,updated:!1,appAlias:a.service_alias,promptModal:"stop",keyes:!e.state.keyes,srcUrl:e.state.srcUrl})},window.handleClickStart=function(t,a){"start"==t&&e.setState({start:!0,closes:!1,updated:!1,appAlias:a.service_alias,promptModal:"start",keyes:!e.state.keyes,srcUrl:e.state.srcUrl})},window.handleClickDelete=function(t,a){"deleteApp"==t&&e.setState({flag:!0,appAlias:a.service_alias})}}catch(e){}}render(){var e=this.props,t=e.deleteAppLoading,a=(e.reStartLoading,e.stopLoading),s=e.startLoading,r=e.updateRollingLoading,o=(e.flagHeight,e.iframeHeight),i=this.state,n=i.flag,p=i.promptModal,d=i.closes,g=i.start,_=i.updated,y=i.keyes,b=i.srcUrl,w=i.teamName,E=i.regionName,S=i.appAlias,M=i.build,C={start:(0,m.formatMessage)({id:"topology.Topological.start"}),stop:(0,m.formatMessage)({id:"topology.Topological.stop"}),rolling:(0,m.formatMessage)({id:"topology.Topological.rolling"}),build:(0,m.formatMessage)({id:"topology.Topological.build"})};return c.default.createElement("div",{key:y,style:{height:o}},n&&c.default.createElement(f.default,{onOk:this.handleDeleteApp,onCancel:this.cancelDeleteApp,loading:t,title:(0,m.formatMessage)({id:"confirmModal.component.delete.title"}),desc:(0,m.formatMessage)({id:"confirmModal.delete.component.desc"}),subDesc:(0,m.formatMessage)({id:"confirmModal.delete.strategy.subDesc"})}),(d||g||_||M)&&c.default.createElement(l.default,{title:"\u53cb\u60c5\u63d0\u793a",visible:p,className:v.default.TelescopicModal,onOk:this.handleJumpAgain,onCancel:this.handleOffHelpfulHints,confirmLoading:"stop"===p?a:"start"===p?s:"rolling"===p?r:!p},c.default.createElement("p",{style:{textAlign:"center"}},(0,m.formatMessage)({id:"topology.Topological.determine"}),C[p],(0,m.formatMessage)({id:"topology.Topological.now"}))),c.default.createElement(u.Link,{id:"links",to:"/team/".concat(w,"/region/").concat(E,"/components/").concat(S,"/webconsole"),target:"_blank"}),c.default.createElement("iframe",{src:"".concat(h.default.baseUrl).concat(b),style:{width:"100%",height:"100%"},id:"myframe",key:y,sandbox:"allow-same-origin allow-scripts allow-popups allow-forms",scrolling:"auto",frameBorder:"no",border:"0",marginWidth:"0",marginHeight:"0"}))}},i=n))||i),y=_;t.default=y},T0wR:function(e,t,a){"use strict";var s=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(a("q1tI")),o=s(a("8vpL"));class i extends l.PureComponent{render(){var e=this.props,t=e.group_id,a=e.iframeHeight;return l.default.createElement("div",{style:{height:a,background:"#fff"},bordered:!1},l.default.createElement(o.default,{iframeHeight:a,group_id:t}))}}t.default=i},gNmc:function(e,t,a){e.exports={antd_form:"antd_form___2qDMM",description:"description___2KDe5",ulStyle:"ulStyle___jl4kp",over_hr:"over_hr___md_Og"}},ogb6:function(e,t,a){"use strict";var s=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var l=s(a("BMrR"));a("giR+");var o=s(a("fyUT"));a("7Kak");var i=s(a("9yH6"));a("5NDa");var n=s(a("5rEg")),p=s(a("jehZ"));a("jCWc");var d=s(a("kPKH"));a("OaEy");var u,c,m,h=s(a("2fM7")),f=a("MuoO"),g=r(a("q1tI")),v=s(a("gNmc")),_=h.default.Option,y=(u=(0,f.connect)(e=>{var t=e.user,a=e.loading;return{currUser:t.currentUser,addHttpStrategyLoading:a.effects["gateWay/addHttpStrategy"],editHttpStrategyLoading:a.effects["gateWay/editHttpStrategy"]}}),u((m=class extends g.PureComponent{constructor(e){super(e),this.onChangeSwitch=((e,t)=>{var a=this.props,s=a.upDateQuestions,r=a.data;r.map(a=>{a.variable===t.variable&&(a.default=e)}),s&&s(r)}),this.handleOk=(e=>{e.preventDefault();var t=this.props,a=t.onOk,s=t.form;s.validateFields((e,t)=>{!e&&a&&a(t)})}),this.handleIsNext=(e=>{var t=this.props.getFieldValue;if(e&&e.indexOf("=")>-1){var a=e.split("=")[0],s=a.replace(new RegExp("\\.","g"),"#-#"),r=t(s)||!1,l="".concat(a,"=").concat(r);return!(e.indexOf(l)<0)}return!0}),this.handleFormItem=(e=>{var t=[];return e.map((a,s)=>{var r=a.type,l=a.subquestions,o=a.default,i=a.group,n=a.show_subquestion_if,p=a.showSubquestionIf,u=a.show_if,c=a.showIf,m=l&&l.length>0,h=p||n,f=u||c||!1,_=this.handleIsNext(f),y=g.default.createElement(g.Fragment,null,_&&this.FormItemBox(a),m&&("boolean"!==r||"".concat(o)=="".concat(h))&&_&&l.map(e=>{var t=e.show_if||e.showIf||!1;return this.handleIsNext(t)&&this.FormItemBox(e)})),b=s<1?0:s-1;return s>0&&t.push(e[b].group),g.default.createElement(g.Fragment,null,t.includes(i)?y:g.default.createElement(g.Fragment,null,g.default.createElement(d.default,{span:24},g.default.createElement("div",{className:v.default.over_hr},g.default.createElement("span",null,i))),y))})}),this.FormItemBox=(e=>{var t=this.props,a=t.Form,s=t.getFieldDecorator,r=a.Item,l={labelCol:{xs:{span:24},sm:{span:24}},wrapperCol:{xs:{span:23},sm:{span:23}}},o=e.variable,i=e.required,n=void 0!==i&&i,u=e.default,c=e.description,m=e.label,h=e.type,f=e.min,_=void 0===f?"":f,y=this.handleBox(e,h,u),b=o.replace(new RegExp("\\.","g"),"#-#");return y?g.default.createElement(d.default,{span:12},g.default.createElement(r,(0,p.default)({},l,{label:m,className:v.default.antd_form}),s(b,{rules:[{required:n,message:"".concat(m,"\u5fc5\u987b\u8bbe\u7f6e")}],initialValue:u&&"".concat(u)||_})(y),g.default.createElement("div",{className:v.default.description},c))):null}),this.handleBox=((e,t,a)=>{return"string"===t?g.default.createElement(n.default,{placeholder:"\u8bf7\u8f93\u5165"}):"boolean"===t?g.default.createElement(i.default.Group,{defaultChecked:"".concat(a),onChange:t=>{this.onChangeSwitch(t.target.value,e)}},g.default.createElement(i.default,{value:"true"},"\u662f"),g.default.createElement(i.default,{value:"false"},"\u5426")):"int"===t?g.default.createElement(o.default,{style:{width:"100%"},min:e.min||1,max:e.max||255,placeholder:"\u8282\u70b9\u6570\u91cf"}):"enum"===t?g.default.createElement(h.default,{placeholder:"\u8bf7\u9009\u62e9"},e.options&&e.options.map(e=>{return g.default.createElement(_,{key:e,value:e},e)})):"password"===t?g.default.createElement(n.default,{autoComplete:"new-password",type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"}):null}),this.state={}}render(){var e=this.props.data;return g.default.createElement(g.Fragment,null,g.default.createElement(l.default,null,this.handleFormItem(e)))}},c=m))||c),b=y;t.default=b},t3BL:function(e,t,a){"use strict";(function(e){var s=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+BJd");var l=s(a("mr32"));a("5Dmo");var o=s(a("3S7+"));a("cWXX");var i=s(a("/ezw"));a("14J3");var n=s(a("BMrR"));a("fOrg");var p=s(a("+KLJ"));a("jCWc");var d=s(a("kPKH")),u=s(a("jehZ"));a("IzEo");var c=s(a("bx4M"));a("+L6B");var m=s(a("2/Rp")),h=s(a("p0pE"));a("/xke");var f=s(a("TeRw"));a("y8nQ");var g=s(a("Vl3Y"));a("OaEy");var v=s(a("2fM7"));a("FJo9");var _=s(a("L41K"));a("fu2T");var y=s(a("gK9i"));a("Znn+");var b,w,E,S,M=s(a("ZTPi")),C=(s(a("qCJ4")),s(a("4SMx")),s(a("ZNrE"))),I=s(a("YABy")),A=s(a("ogb6")),k=s(a("gNmc")),x=(a("RBnf"),a("MuoO")),O=a("7DNP"),D=(s(a("wd/R")),r(a("q1tI"))),N=a("LLXN"),T=s(a("IujW")),R=(a("ArA+"),a("xpXo")),L=(s(a("q76B")),s(a("ALo4"))),V=(s(a("YCtL")),s(a("18gR")),s(a("QDog"))),B=(s(a("ZgmS")),s(a("mWxT")),s(a("ruXZ")),s(a("Zob5")),s(a("T0wR")),s(a("Mw2C")),s(a("i+gw")),s(a("8+Sn"))),H=(s(a("0fGy")),s(a("VZuE")),s(a("puIC"))),q=(a("mLYH"),M.default.TabPane,y.default.Panel),U=(_.default.Step,v.default.Option),F=g.default.Item,P=(b=(0,x.connect)(e=>{var t=e.user,a=e.application,s=e.teamControl,r=e.enterprise,l=(e.loading,e.global);return{currUser:t.currentUser,collapsed:l.collapsed,apps:a.apps,currentTeam:s.currentTeam,currentRegionName:s.currentRegionName,currentEnterprise:r.currentEnterprise,novices:l.novices}}),w=g.default.create(),b(E=w((S=class extends D.PureComponent{constructor(t){super(t),this.handleGetHelmUploadChartInfo=(e=>{var t=this.props.dispatch;t({type:"createApp/getHelmUploadChartInfo",payload:{team_name:V.default.getCurrTeamName(),event_id:e},callback:t=>{if(t){var a=t.bean,s=a.chart_information;this.throttle=!1,this.checkHelmChartAppInfo(s[0],e),this.setState({versions:s,helminfoLoding:!1})}},handleError:e=>{f.default.error({message:e.data.msg_show})}})}),this.getUpdatedModelId=(e=>{var t=this.props.dispatch,a=this.state,s=(a.updataInfo,a.currApp),r=this.fetchParameter(),l=r.team_name;r.group_id;this.setState({status:3,showConfig:!1}),t({type:"application/addHelmModule",payload:{team_name:l,repo_name:s.app_store_name,chart_name:s.app_template_name,pic:"",describe:"",details:""},callback:t=>{if(t&&t.status_code&&200==t.status_code){var a=JSON.parse(t.bean);this.creatHelmModleUp(a.app_model_id,e)}},handleError:()=>{this.setState({status:4,showConfig:!1})}})}),this.creatHelmModleUp=((e,t)=>{var a=this.props.dispatch,s=this.fetchParameter(),r=s.team_name,l=s.group_id,o=this.state.currApp;a({type:"application/generateHelmModule",payload:{team_name:r,name:o.app_template_name,repo_name:o.app_store_name,chart_name:o.app_template_name,version:o.version,overrides:t.overrides,app_model_id:e,app_id:l},callback:t=>{t&&t.status_code&&200==t.status_code&&this.getUpdatedInfo(e)},handleError:()=>{this.setState({status:4,showConfig:!1})}})}),this.getUpdatedInfo=(e=>{var t=this.props.dispatch,a=this.state,s=a.updataInfo,r=a.currApp,l=this.fetchParameter(),o=l.team_name,i=l.group_id;t({type:"global/CloudAppUpdatedInfo",payload:{app_model_key:e,version:r.version,upgradeGroupID:s.upgrade_group_id,team_name:o,group_id:i},callback:t=>{t&&200===t.status_code&&this.setState({upgrade_Info:t.list||[]},()=>{(0,R.postUpgradeRecord)({team_name:o,appID:i,noModels:!0,upgrade_group_id:s.upgrade_group_id}).then(t=>{this.createUpgradeTasks(this.state.upgrade_Info,t.bean.ID,e)})})},handleError:()=>{this.setState({status:4,showConfig:!1})}})}),this.createUpgradeTasks=((e,t,a)=>{var s=this.props.dispatch,r=this.state,l=(r.upgrade_Info,r.currApp),o=r.updataInfo,i=this.fetchParameter(),n=i.team_name,p=i.group_id,d=l.version;s({type:"global/CloudAppUpdatedTasks",payload:{team_name:n,group_id:p,group_key:a,version:d,services:e,upgrade_record_id:t,upgrade_group_id:o.upgrade_group_id},callback:e=>{s({type:"global/CloudAppUpdateRecordsInfo",payload:{team_name:n,group_id:p,upgrade_group_id:o.upgrade_group_id,record_id:t},callback:e=>{this.getUpgradeRecordsInfo(t)}})},handleError:e=>{f.default.error({message:e.data.msg_show})}})}),this.getUpgradeRecordsInfo=(e=>{var t=this.props.dispatch,a=this.fetchParameter(),s=a.team_name,r=a.group_id,l=this.state,o=(l.upgrade_Info,l.currApp,l.updataInfo);t({type:"global/CloudAppUpdateRecordsInfo",payload:{team_name:s,group_id:r,upgrade_group_id:o.upgrade_group_id,record_id:e},callback:t=>{t&&t.bean&&t.bean.is_finished?setTimeout(()=>{this.jump(),this.setState({showConfig:!0})},2e3):this.getUpgradeRecordsInfo(e)}})}),this.getHelmvs=(e=>{var t=this.props.dispatch,a=this.state.currApp,s=this.fetchParameter(),r=s.team_name,l=s.group_id;t({type:"createApp/getHelmVersion",payload:{repo_name:a.app_store_name,chart_name:a.app_template_name,highest:"",team_name:r,app_id:l},callback:t=>{if(t&&t.bean){var a=t.bean,s=a.chart_information;a.repo_exist?(this.fetchHelmAppInfo(),this.setState({versions:s,helminfoLoding:!1}),!e&&this.setState({overrides:a.overrides})):this.setState({infoType:!0,versions:s,helminfoLoding:!1,status:2})}},handleError:e=>{this.setState({status:2})}})}),this.checkHelmChartAppInfo=((e,t)=>{var a=this.props.dispatch,s=this.fetchParameter(),r=s.team_name,l=(s.group_id,s.region_name);B.default.set("team_name",r),B.default.set("region_name",l),a({type:"createApp/checkHelmChartApp",payload:{name:e.name,version:e.Version,event_id:t,team_name:r},callback:e=>{e&&e.bean&&("true"==e.bean.checkAdopt?this.setState({status:1}):this.setState({status:2,msg:e.bean.yaml}))},handleError:e=>{this.setState({status:2})}})}),this.fetchHelmAppInfo=(()=>{var e=this.state.currApp,t=this.props.dispatch;B.default.set("team_name",e.team_name),B.default.set("region_name",e.region_name);var a=this.fetchParameter(),s=a.team_name;a.group_id;t({type:"createApp/helmAppInstall",payload:{name:e.app_template_name,repo_name:e.app_store_name,chart_name:e.app_template_name,version:e.version,team_name:s},callback:e=>{e&&e.bean&&(B.default.set("team_name",""),B.default.set("region_name",""),"true"==e.bean.checkAdopt?this.setState({status:1}):this.setState({status:2,msg:e.bean.yaml}))},handleError:e=>{this.setState({status:2})}})}),this.compareVersion=((e,t)=>{e=e.split("."),t=t.split(".");var a=Math.max(e.length,t.length);while(e.length<a)e.push("0");while(t.length<a)t.push("0");for(var s=0;s<a;s++){var r=parseInt(e[s]),l=parseInt(t[s]);if(r>l)return void this.setState({buttonType:1});if(r<l)return void this.setState({buttonType:-1})}this.setState({buttonType:0})}),this.closeTimer=(()=>{this.timer&&clearInterval(this.timer)}),this.fetchHelmAppStoresVersions=(e=>{var t=this.props,a=t.dispatch,s=t.currentEnterprise,r=this.state.currApp;a({type:"application/fetchHelmAppStoresVersions",payload:{enterprise_id:s.enterprise_id,version:e,appStoreName:r.app_store_name,templateName:r.app_template_name},callback:e=>{e&&200===e.status_code&&this.setState({versionInfo:e,versionInfoLoading:!1,formData:e&&e.questions&&e.questions.length>0&&e.questions||[]},()=>{e&&e.values&&this.handleTemplateFile(Object.keys(e.values).reverse()[0])})},handleError:e=>{this.setState({status:2})}})}),this.fetchHelmChartAppYaml=(()=>{var e=this.props,t=e.dispatch,a=(e.currentEnterprise,this.fetchParameter()),s=a.team_name,r=(a.group_id,this.props.location.query&&this.props.location.query.event_id);t({type:"createApp/getHelmChartYaml",payload:{event_id:r,team_name:s},callback:e=>{e&&200===e.status_code&&this.setState({versionInfo:e.bean,versionInfoLoading:!1,formData:e&&e.questions&&e.questions.length>0&&e.questions||[]},()=>{e&&e.bean.values&&this.handleTemplateFile(Object.keys(e.bean.values).reverse()[0])})},handleError:e=>{this.setState({status:2})}})}),this.beforeUpload=((e,t)=>{var a=e.name.split("."),s=a.length,r="yaml"===a[s-1]||"yml"===a[s-1];return!!r||(t&&f.default.warning({message:(0,N.formatMessage)({id:"notification.warn.yaml_file"})}),!1)}),this.encodeBase64Content=(t=>{var a=t&&e.from(t).toString("base64")||"";return a}),this.decodeBase64Content=(t=>{var a=t&&t.replace(/\s/g,"+")||"";return a&&(a=e.from(a,"base64").toString()),a}),this.handleSubmit=(e=>{var t=this.props.form,a=t.validateFields,s=t.setFields,r=this.state.versions;a((t,a)=>{if(!t){this.setState({submitLoading:!0});var l=this.encodeBase64Content(a.yamls),o=!1,i={};if(a.overrides&&a.overrides.length>0?a.overrides.map(e=>{var t=e.item_key,a=e.item_value;t&&a&&""!==t&&""!==a?i[t]=a:o=!0}):i=void 0,o)return s({overrides:{errors:[new Error((0,N.formatMessage)({id:"helmAppInstall.index.input_config"}))]}}),this.setState({submitLoading:!1}),null;Object.keys(a).forEach(e=>{if("templateFile"!==e&&"version"!==e&&"yamls"!==e&&"overrides"!==e){"[Object Object]"!==!Object.prototype.toString.call(i)&&void 0!==i||(i={});var t=e.replace(new RegExp("\\#-#","g"),"."),s=a[e];i[t]="".concat(s)}});var n=Object.assign({},a,{yamls:l,overrides:i});if("Create"===e)this.handleInstallHelmApp(n);else if("upload"===e){var p=Object.assign({},{info:r[0],overrides:i});window.sessionStorage.setItem("helmInfo",JSON.stringify(p)),this.jumpToResource()}else this.getUpdatedModelId(n)}})}),this.handleInstallHelmApp=(e=>{var t=this.props.dispatch,a=this.state.currApp,s=this.fetchParameter(),r=s.team_name;s.group_id;this.setState({showConfig:!1,status:3}),t({type:"application/addHelmModule",payload:{team_name:r,repo_name:a.app_store_name,chart_name:a.app_template_name,pic:"",describe:"",details:""},callback:t=>{if(t&&t.status_code&&200==t.status_code){var a=JSON.parse(t.bean);this.creatHelmModle(a.app_model_id,e)}},handleError:()=>{this.setState({status:4,showConfig:!1})}})}),this.creatHelmModle=((e,t)=>{var a=this.props.dispatch,s=this.fetchParameter(),r=s.team_name,l=s.group_id,o=this.state.currApp;a({type:"application/generateHelmModule",payload:{team_name:r,name:o.app_template_name,repo_name:o.app_store_name,chart_name:o.app_template_name,version:o.version,overrides:t.overrides,app_model_id:e,app_id:l},callback:a=>{a&&a.status_code&&200==a.status_code&&this.installHelmApp(e,t)},handleError:()=>{this.setState({status:4,showConfig:!0})}})}),this.installHelmApp=((e,t)=>{var a=this.props.dispatch,s=this.fetchParameter(),r=s.team_name,l=s.group_id,o=this.state.currApp;a({type:"createApp/installApp",payload:(0,h.default)({},o,{team_name:r,app_id:e,is_deploy:0!=o.is_deploy,app_version:o.version,install_from_cloud:!1,marketName:"localApplication",group_id:l}),callback:e=>{e&&e.status_code&&200==e.status_code&&this.jump()},handleError:e=>{f.default.error({message:e.data.msg_show}),this.setState({status:4,showConfig:!1})}})}),this.jump=(()=>{var e=this.props.dispatch;window.sessionStorage.setItem("updata",JSON.stringify(!0)),e(O.routerRedux.push("/team/".concat(V.default.getCurrTeamName(),"/region/").concat(V.default.getCurrRegionName(),"/apps/").concat(V.default.getAppID(),"/overview")))}),this.jumpToResource=(()=>{var e=this.props.dispatch,t=this.props.location.query&&this.props.location.query.event_id;e(O.routerRedux.push("/team/".concat(V.default.getCurrTeamName(),"/region/").concat(V.default.getCurrRegionName(),"/ChangeResourceTest?type=helm&group_id=").concat(V.default.getAppID(),"&event_id=").concat(t)))}),this.handleEditHelmApp=(e=>{this.props.dispatch,this.state.currApp;var t=this.fetchParameter();t.team_name,t.group_id}),this.handleOperationBtn=(e=>{var t=this.state,a=t.submitLoading,s=t.errPrompt,r=t.noVersion,l=t.upDataVersion,o=t.buttonType,i=this.props.location.query&&"upload"==this.props.location.query.installPath;return i?D.default.createElement("div",{style:{textAlign:"center"},id:"messagesEndRef"},D.default.createElement(m.default,{onClick:()=>{this.handleSubmit("upload")}},(0,N.formatMessage)({id:"helmAppInstall.index.next"}))):D.default.createElement("div",{style:{textAlign:"center"},id:"messagesEndRef"},D.default.createElement(m.default,{onClick:()=>{this.handleSubmit(e)},disabled:l||s||r,loading:a,type:"primary"},0===o?(0,N.formatMessage)({id:"helmAppInstall.index.reinstall"}):1===o?(0,N.formatMessage)({id:"helmAppInstall.index.up"}):(0,N.formatMessage)({id:"helmAppInstall.index.install"})))}),this.fetchParameter=(()=>{var e=this.props,t=e.currentEnterprise;e.appID;return{enterprise_id:t.enterprise_id,team_name:V.default.getCurrTeamName(),region_name:V.default.getCurrRegionName(),group_id:V.default.getAppID()}}),this.back=(()=>{window.history.back()}),this.next=(()=>{if(this.setState({showConfig:!0}),"upgrade"==this.props.location.query.type){var e=this.state.heightVs;this.fetchHelmAppStoresVersions(e)}else{var t=this.state.currApp.version;"upload"==this.props.location.query.installPath?this.fetchHelmChartAppYaml():this.fetchHelmAppStoresVersions(t)}}),this.fetchPrefixUrl=(()=>{var e=this.fetchParameter(),t=e.team_name,a=e.region_name;return"/team/".concat(t,"/region/").concat(a,"/")}),this.handleErrPrompt=(e=>{if(e&&e.data&&e.data.code){var t=this.state.promptMap,a=t[e.data.code]||!1;8004===e.data.code?this.setState({noVersion:!0}):a&&this.setState({errPrompt:a,noVersion:!1})}this.handleAppInfoLoading(),this.handleUpDataVersionLoading()}),this.handleAppVersion=((e,t,a)=>{var s=this.state,r=(s.versions,s.newVersion,s.resources,s.currApp);r.version=e,this.setState({currApp:r}),t&&(a&&this.setState({upDataVersion:(0,N.formatMessage)({id:"helmAppInstall.index.updata_info"}),noVersion:!1}),this.fetchHelmAppStoresVersions(e)),this.handleAppInfoLoading()}),this.handleTemplateFile=(e=>{var t=this.props.form,a=t.setFieldsValue,s=this.state.versionInfo,r=this.CodeMirrorRef;if(s.values){var l=s.values[e]&&this.decodeBase64Content(s.values[e])||"";if(a({yamls:l}),a({templateFile:e}),r){var o=r.getCodeMirror();o.setValue(l)}}this.handleUpDataVersionLoading()}),this.handleUpDataVersionLoading=(()=>{this.setState({upDataVersion:!1})}),this.handleAppInfoLoading=(()=>{this.setState({appInfoLoading:!1})}),this.operationError=(()=>{var e=this.state,t=e.infoType,a=e.msg;return D.default.createElement(c.default,{style:{marginTop:20}},D.default.createElement(L.default,{type:"error",title:(0,N.formatMessage)({id:"helmAppInstall.index.detection_failure"}),description:D.default.createElement(D.default.Fragment,null,t?(0,N.formatMessage)({id:"helmAppInstall.index.delete"}):(0,N.formatMessage)({id:"helmAppInstall.index.detection_back"}),D.default.createElement("p",{style:{color:"red"}},(0,N.formatMessage)({id:"helmAppInstall.index.error"}),a||"-")),actions:D.default.createElement(D.default.Fragment,null,D.default.createElement(m.default,{onClick:this.back},(0,N.formatMessage)({id:"helmAppInstall.index.back"}))),style:{marginTop:48,marginBottom:16}}),",")}),this.installError=(()=>{return D.default.createElement(c.default,{style:{marginTop:20}},D.default.createElement(L.default,{type:"error",title:(0,N.formatMessage)({id:"helmAppInstall.index.install_failure"}),description:(0,N.formatMessage)({id:"helmAppInstall.index.install_back"}),actions:D.default.createElement(D.default.Fragment,null,D.default.createElement(m.default,{onClick:this.back},(0,N.formatMessage)({id:"helmAppInstall.index.back"}))),style:{marginTop:48,marginBottom:16}}),",")}),this.operationSuccess=(()=>{return D.default.createElement(c.default,{style:{marginTop:20}},D.default.createElement(L.default,{type:"success",title:(0,N.formatMessage)({id:"helmAppInstall.index.detection_success"}),description:(0,N.formatMessage)({id:"helmAppInstall.index.detection_next"}),actions:D.default.createElement(m.default,{onClick:this.next},(0,N.formatMessage)({id:"helmAppInstall.index.next"})),style:{marginTop:48,marginBottom:16}}),",")}),this.operationInstall=(()=>{return D.default.createElement(c.default,{style:{marginTop:20}},D.default.createElement(L.default,{type:"ing",title:(0,N.formatMessage)({id:"helmAppInstall.index.detecting"}),description:(0,N.formatMessage)({id:"helmAppInstall.index.detecting_await"}),style:{marginTop:48,marginBottom:16}}),",")}),this.Install=(()=>{var e=this.state.buttonType;return D.default.createElement(c.default,{style:{marginTop:20}},D.default.createElement(L.default,{type:"ing",title:0===e?(0,N.formatMessage)({id:"helmAppInstall.index.Being_reinstalled"}):1===e?(0,N.formatMessage)({id:"helmAppInstall.index.in_upgrade"}):(0,N.formatMessage)({id:"helmAppInstall.index.in_install"}),description:(0,N.formatMessage)({id:"helmAppInstall.index.need_time"}),style:{marginTop:48,marginBottom:16}}),",")}),this.handleConfing=(()=>{var e=this.props.form,t=this.props.location&&this.props.location.query&&this.props.location.query.type,a=e.getFieldDecorator,s=e.setFieldsValue,r=e.getFieldValue,l=this.state,o=l.versionInfo,c=l.versionInfoLoading,m=(l.resources,l.currentSteps,l.versions),h=l.errPrompt,f=l.noVersion,_=l.upDataVersion,b=l.formData,w=(l.newVersion,l.currApp),E=(l.heightVs,l.lowVs),S=l.overrides,M={labelCol:{xs:{span:24}},wrapperCol:{xs:{span:24}}},x=S||"";if(S&&S.length>0){var O=[];S.map(e=>{Object.keys(e).forEach(t=>{O.push({item_key:t,item_value:e[t]})})}),x=O}var R=o.values?Object.keys(o.values).reverse():[];return D.default.createElement(g.default,{labelAlign:"left"},D.default.createElement(y.default,{bordered:!1,defaultActiveKey:["2"]},D.default.createElement(q,{header:D.default.createElement("div",{className:H.default.customPanelHeader},D.default.createElement("h6",null,(0,N.formatMessage)({id:"appOverview.helm.pages.option"})),D.default.createElement("p",null,(0,N.formatMessage)({id:"appOverview.helm.pages.standard"}))),key:"2",className:H.default.customPanel},D.default.createElement(i.default,{loading:c},D.default.createElement("div",{style:{padding:"15px 30px"}},b&&b.length>0&&D.default.createElement(A.default,{Form:g.default,data:b,upDateQuestions:e=>{this.setState({formData:e})},setFieldsValue:s,formItemLayout:M,getFieldValue:r,getFieldDecorator:a}),D.default.createElement("div",{className:k.default.over_hr},D.default.createElement("span",null,(0,N.formatMessage)({id:"appOverview.helm.pages.over_hr"}))),D.default.createElement(F,(0,u.default)({},M,{label:(0,N.formatMessage)({id:"appOverview.helm.pages.overrides"})}),a("overrides",{initialValue:x||[],rules:[{required:!1,message:(0,N.formatMessage)({id:"placeholder.helm.overrides"})}]})(D.default.createElement(I.default,{disableds:_||h||f,isHalf:!0,editInfo:x||""}))),D.default.createElement(n.default,null,t&&D.default.createElement(d.default,{span:12},D.default.createElement(F,(0,u.default)({},M,{label:(0,N.formatMessage)({id:"appOverview.helm.pages.version"}),extra:"upgrade"==t?(0,N.formatMessage)({id:"helmAppInstall.index.now_version"},{lowVs:E}):""}),a("version",{initialValue:"upgrade"==t?this.props.location.query.upgrade||void 0:w.version||void 0,rules:[{required:!0,message:(0,N.formatMessage)({id:"placeholder.helm.version"})}]})(D.default.createElement(v.default,{placeholder:(0,N.formatMessage)({id:"placeholder.helm.version"}),style:{width:"95%"},disabled:_||h,onChange:e=>{this.handleAppVersion(e,!0,!0)}},m.map(e=>{var t=e.Version;return D.default.createElement(U,{key:t,value:t,onClick:()=>{this.compareVersion(t,w.version)}},t==E?D.default.createElement(D.default.Fragment,null,D.default.createElement("span",null,t),D.default.createElement("span",{style:{background:"#fae2c2",marginLeft:10,padding:3,borderRadius:3}},(0,N.formatMessage)({id:"appOverview.helm.pages.current_version"}))):t===m[0].Version?D.default.createElement(D.default.Fragment,null,D.default.createElement("span",null,t),D.default.createElement("span",{style:{background:"#b7edb1",marginLeft:10,padding:3,borderRadius:3}},(0,N.formatMessage)({id:"helmAppInstall.index.new"}))):t)}))))),D.default.createElement(d.default,{span:12},(_||f)&&D.default.createElement(p.default,{style:{marginTop:"40px"},message:f?(0,N.formatMessage)({id:"appOverview.helm.pages.alert.message"}):_,type:"warning"}))),D.default.createElement(d.default,{span:24,style:{position:"relative",zIndex:1}},D.default.createElement(F,(0,u.default)({},M,{label:(0,N.formatMessage)({id:"appOverview.helm.pages.yaml.templateFile"}),className:H.default.clearStar}),a("templateFile",{initialValue:R.length>0&&R[0],rules:[{required:!0,message:(0,N.formatMessage)({id:"placeholder.templateFile"})}]})(D.default.createElement(v.default,{placeholder:(0,N.formatMessage)({id:"placeholder.templateFile"}),style:{width:"100%"},onChange:this.handleTemplateFile,disabled:_||h||f},R.map(e=>{return D.default.createElement(U,{key:e,value:e},e)}))))),D.default.createElement(C.default,{disabled:!0,data:"",bg:"151718",width:"100%",isUpload:!1,saveRef:e=>{this.CodeMirrorRef=e},marginTop:120,setFieldsValue:s,formItemLayout:M,Form:g.default,getFieldDecorator:a,beforeUpload:this.beforeUpload,mode:"yaml",name:"yamls",message:(0,N.formatMessage)({id:"appOverview.helm.pages.yaml.yamlMsg"})}),t&&this.handleOperationBtn("UpDate")))),D.default.createElement(q,{header:D.default.createElement("div",{className:H.default.customPanelHeader},D.default.createElement("h6",null,(0,N.formatMessage)({id:"appOverview.helm.pages.appIntroduce"})),D.default.createElement("p",null,(0,N.formatMessage)({id:"appOverview.helm.pages.explain"}))),key:"1",className:H.default.customPanel},D.default.createElement("div",{style:{padding:"15px 30px"}},D.default.createElement(i.default,{loading:c},D.default.createElement(T.default,{className:H.default.customMD,source:o.readme&&this.decodeBase64Content(o.readme)||""}))))),!t&&this.handleOperationBtn("Create"))}),this.state={versionInfoLoading:!0,versions:[],noVersion:!1,promptMap:{8000:(0,N.formatMessage)({id:"helmAppInstall.index.delete"}),8003:(0,N.formatMessage)({id:"helmAppInstall.index.no"})},formData:[],appInfoLoading:!0,currentSteps:0,toDelete:!1,errPrompt:!1,serviceIds:[],promptModal:!1,code:"",currApp:{},componentTimer:!0,submitLoading:!1,resources:{},versionInfo:{},appInfo:{},type:"shape",upDataVersion:!1,newVersion:0,buttonType:-1,status:0,showConfig:!1,heightVs:"",lowVs:"",newAppInfo:{},updataInfo:{},upgrade_Info:[],helminfoLoding:!0,infoType:!1,overrides:[]},this.throttle=!1,this.CodeMirrorRef=""}componentDidMount(){if(this.props.location.query&&"market"==this.props.location.query.installPath&&this.setState({currApp:JSON.parse(window.sessionStorage.getItem("appinfo"))},()=>{this.getHelmvs()}),this.props.location.query&&"cmd"==this.props.location.query.installPath){var e=JSON.parse(window.sessionStorage.getItem("appinfo"));this.setState({currApp:e,overrides:e.overrides},()=>{this.getHelmvs(!0)})}if(this.props.location.query&&"upload"==this.props.location.query.installPath&&this.props.location.query.event_id&&this.handleGetHelmUploadChartInfo(this.props.location.query.event_id),this.props.location.query&&this.props.location.query.type)if("upgrade"==this.props.location.query.type){var t=this.props.location.query.upgrade,a=JSON.parse(window.sessionStorage.getItem("appinfo")),s=JSON.parse(window.sessionStorage.getItem("updataInfo"));this.setState({lowVs:a.version}),a.version=t,this.setState({currApp:a,heightVs:t,updataInfo:s},()=>{this.getHelmvs()})}else{var r=JSON.parse(window.sessionStorage.getItem("appinfo")),l=JSON.parse(window.sessionStorage.getItem("updataInfo"));this.setState({lowVs:r.version,currApp:r,updataInfo:l},()=>{this.getHelmvs()})}this.props.location.query?"upgrade"==this.props.location.query.type?this.setState({buttonType:1}):"install"==this.props.location.query.type?this.setState({buttonType:0}):this.setState({buttonType:-1}):this.setState({buttonType:-1})}componentWillUnmount(){this.props.dispatch}render(){var e=this.state,t=e.versions,a=e.currApp,s=(e.resources,e.toDelete,e.currentSteps,e.errPrompt,e.appInfo,e.appInfoLoading,e.buttonType,e.status),r=e.showConfig,p=e.helminfoLoding,u=this.props.location.query&&this.props.location.query.installPath,m=(0,h.default)({},t[0]),f=m.Keywords,g=D.default.createElement(D.default.Fragment,null,D.default.createElement(c.default,null,D.default.createElement(n.default,{style:{display:"flex",alignItems:"center"}},D.default.createElement(i.default,{loading:p},D.default.createElement(d.default,{span:12,style:{display:"flex",width:"50%"}},D.default.createElement("div",null,D.default.createElement("img",{style:{width:"60px",marginRight:"10px"},alt:"",src:m.Pic||"https://gw.alipayobjects.com/zos/rmsportal/MjEImQtenlyueSmVEfUD.svg"})),D.default.createElement("div",{className:H.default.name_div},"upload"==u?D.default.createElement("p",{className:H.default.name_span},m.name||"-"):D.default.createElement("p",{className:H.default.name_span},a.app_template_name||"-"),D.default.createElement(o.default,{placement:"top",title:m.Abstract||" - "},D.default.createElement("p",{style:{color:"rgba(0, 0, 0, 0.85)"}},m.Abstract||" - ")))),D.default.createElement(d.default,{span:3},D.default.createElement("div",{className:H.default.lable_style},D.default.createElement("span",null,(0,N.formatMessage)({id:"appOverview.versions"})),"upload"==u?D.default.createElement("span",null,m.Version||"-"):D.default.createElement("span",null,a.version||"-"))),D.default.createElement(d.default,{span:6},D.default.createElement("div",{className:H.default.lable_style},D.default.createElement("span",null,(0,N.formatMessage)({id:"helmAppInstall.index.key"})),f&&f.length>0&&D.default.createElement("span",{className:H.default.tag_style},f.length>3?D.default.createElement(D.default.Fragment,null,D.default.createElement(o.default,{placement:"top",title:f.map(e=>{return D.default.createElement(l.default,{style:{marginTop:10}},e)})},f.slice(0,3).map(e=>{return D.default.createElement(l.default,null,e)}),D.default.createElement("span",null,"..."))):f.map(e=>{return D.default.createElement(l.default,null,e)})))))))),v=this.fetchParameter();v.team_name,v.region_name,v.group_id;return D.default.createElement("div",{style:{height:"80vh",overflowY:"auto"}},D.default.createElement(n.default,null,g),!r&&0==s&&this.operationInstall(),!r&&1==s&&this.operationSuccess(),!r&&2==s&&this.operationError(),!r&&3==s&&this.Install(),!r&&4==s&&this.installError(),r&&D.default.createElement("div",{className:H.default.customCollapse_helm},this.handleConfing()))}},E=S))||E)||E);t.default=P}).call(this,a("tjlA").Buffer)}}]);