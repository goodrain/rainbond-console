(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[65],{DU6M:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,n,r,o=l(a("p0pE")),p=i(a("q1tI")),d=a("MuoO"),u=a("7DNP"),c=l(a("XZXw")),h=l(a("QDog")),m=l(a("yxQP")),g=(l(a("Gyju")),l(a("GMji"))),f=(s=(0,d.connect)(),s((r=class extends p.PureComponent{constructor(){super(...arguments),this.handleSubmit=(e=>{this.props.dispatch({type:"plugin/createPlugin",payload:(0,o.default)({team_name:h.default.getCurrTeamName()},e),callback:e=>{this.props.dispatch(u.routerRedux.push("/team/".concat(h.default.getCurrTeamName(),"/region/").concat(h.default.getCurrRegionName(),"/myplugns/").concat(e&&e.bean.plugin_id)))}})})}render(){m.default.pageHeaderContent,m.default.extraImg;return p.default.createElement(c.default,{title:"\u5b89\u88c5\u63d2\u4ef6",isFooter:!0},p.default.createElement(g.default,{isAddMarket:!1}))}},n=r))||n);t.default=f},GMji:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("fOrg");var s=l(a("+KLJ"));a("2qtc");var n=l(a("kLXV"));a("7Kak");var r=l(a("9yH6"));a("+L6B");var o=l(a("2/Rp"));a("T2oS");var p=l(a("W9HT"));a("5NDa");var d=l(a("5rEg"));a("Mwp2");var u=l(a("VXEj")),c=l(a("jehZ"));a("IzEo");var h=l(a("bx4M"));a("5Dmo");var m=l(a("3S7+"));a("+BJd");var g=l(a("mr32"));a("/xke");var f=l(a("TeRw")),v=l(a("p0pE"));a("y8nQ");var y=l(a("Vl3Y"));a("Znn+");var _=l(a("ZTPi"));a("OaEy");var C,b,S,E,A=l(a("2fM7")),k=a("MuoO"),x=a("7DNP"),M=i(a("q1tI")),T=l(a("/VoG")),w=l(a("d5pB")),P=l(a("fXYz")),L=l(a("e6Ls")),N=l(a("xNuS")),I=l(a("hH+r")),O=l(a("iPMB")),R=l(a("EGgK")),z=l(a("bwcx")),B=a("34ay"),D=a("vSx2"),H=l(a("QDog")),V=l(a("hMqj")),j=l(a("ZgmS")),G=l(a("yxQP")),q=A.default.Option,K=_.default.TabPane,F=(C=(0,k.connect)(e=>{var t=e.global,a=e.loading,l=e.teamControl,i=e.enterprise;return{loading:a,enterprise:t.enterprise,currentTeam:l.currentTeam,currentRegionName:l.currentRegionName,currentEnterprise:i.currentEnterprise,currentTeamPermissionsInfo:l.currentTeamPermissionsInfo}},null,null,{pure:!1}),b=y.default.create(),C(S=b((E=class extends M.PureComponent{constructor(e){super(e),this.onCancelCreate=(()=>{this.setState({showCreate:null,helmCreate:null,addAppLoading:!1})}),this.getCloudRecommendApps=(e=>{var t=this.state.currentKey,a=this.props.currentEnterprise;this.props.dispatch({type:"market/fetchMarkets",payload:{name:t,enterprise_id:a.enterprise_id,query:e?"":this.state.cloudApp_name||"",pageSize:e?9:this.state.cloudPageSize,page:e?1:this.state.cloudPage,is_plugin:!0},callback:e=>{e?this.setState({cloudList:e.list||[],cloudTotal:e.total},()=>{e._code&&210===e.status_code&&e._condition&&10503===e._condition?this.setState({isSpincloudList:-1,networkText:e.msg_show}):this.setState({isSpincloudList:!1})}):this.setState({isSpincloudList:!1})}})}),this.getApps=(e=>{var t=this.props,a=t.currentEnterprise,l=t.dispatch,i=this.state.scopeMax;if(i&&"localApplication"!==i)return null;l({type:"market/fetchAppModels",payload:{enterprise_id:a.enterprise_id,app_name:e?"":this.state.app_name||"",scope:e?"":this.state.scope,page_size:e?9:this.state.pageSize,page:e?1:this.state.page,need_install:!0,is_complete:1,is_plugin:!0},callback:e=>{e?this.setState({list:e.list||[],total:e.total},()=>{this.setState({isSpinList:!1})}):this.setState({isSpinList:!1})}})}),this.getMarketsTab=(()=>{var e=this.props,t=e.dispatch,a=e.currentEnterprise,l=this.state.scopeMax;t({type:"market/fetchMarketsTab",payload:{enterprise_id:a.enterprise_id},callback:e=>{var t=e&&e.list||[],a=[];t&&t.length>0&&t.map(e=>{var t=e.name,l=e.status,i=e.alias;1===l&&a.push(Object.assign({},e,{tab:i||t,key:t}))}),this.setState({rainStoreTab:a}),l&&"localApplication"!==l&&this.handleTabMaxChange(l)}})}),this.getHelmMarketsTab=(()=>{var e=this.props,t=e.dispatch,a=e.currentEnterprise,l=e.isHelm,i=void 0===l||l;i&&t({type:"market/fetchHelmMarketsTab",payload:{enterprise_id:a.enterprise_id},callback:e=>{if(e&&200===e.status_code){var t=[];Array.isArray(e)&&e.map(e=>{t.push(Object.assign({},e,{tab:e.name,key:"Helm-".concat(e.name)}))}),this.setState({helmStoreTab:t})}}})}),this.getHelmAppStore=(e=>{var t=this.props,a=t.dispatch,l=t.currentEnterprise,i=this.state.helmPag,s=Object.assign({},{name:e,enterprise_id:l.enterprise_id},i);a({type:"market/fetchHelmAppStore",payload:s,callback:e=>{if(e&&200===e.status_code){var t=Object.assign({},i,{total:e&&e.length||0}),a=[];if(Array.isArray(e)){var l=i.query,s=i.page;if(l){var n=[],r=l.length;e.map(e=>{if(r<=e.name.length){var t=e.name.substring(0,r);t.indexOf(l)>-1&&n.push(e)}}),t.total=n.length,a=n.length>9?n.splice(9*(s-1),9):n}else a=e.splice(s>1?9*(s-1):0,9)}this.setState({helmLoading:!1,helmList:a,helmPag:t})}}})}),this.handleSearch=(e=>{var t=this.state.scopeMax;if("localApplication"===t)this.setState({app_name:e,page:1},()=>{this.getApps()});else if(t.indexOf("Helm-")>-1){var a=this.state.helmPag,l=Object.assign({},a,{page:1,query:e});this.setState({helmPag:l},()=>{this.getHelmAppStore(t.slice(5))})}else this.setState({cloudApp_name:e,cloudPage:1},()=>{this.getCloudRecommendApps()})}),this.hanldePageChange=(e=>{this.setState({page:e},()=>{this.getApps()})}),this.hanldeCloudPageChange=(e=>{this.setState({cloudPage:e},()=>{this.getCloudRecommendApps()})}),this.hanldeHelmPageChange=(e=>{var t=this.state,a=t.helmPag,l=t.scopeMax,i=Object.assign({},a,{page:e});this.setState({helmPag:i},()=>{this.getHelmAppStore(l.slice(5))})}),this.handleTabChange=(e=>{this.setState({scope:e,page:1},()=>{this.getApps()})}),this.handleTabMaxChange=(e=>{this.setState({page:1,cloudPage:1,currentKey:e,scopeMax:e,isSpinList:!0,isSpincloudList:!0,app_name:"",cloudApp_name:""},()=>{"localApplication"===e?this.getApps("reset"):e.indexOf("Helm-")>-1?this.getHelmAppStore(e.slice(5)):this.getCloudRecommendApps("reset")})}),this.showCreate=(e=>{var t=this.state.handleType;t?this.setState({installBounced:e}):this.setState({showCreate:e})}),this.handleHelmIntall=(e=>{var t=this.state,a=t.scopeMax,l=t.helmStoreTab,i={};l.map(e=>{e.key===a&&(i=e)}),this.setState({helmCreate:Object.assign({},e,i,{app_store_name:a.slice(5)})})}),this.handleInstallBounced=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.dispatch,i=t.groupId,s=t.refreshCurrent,n=this.state,r=n.installBounced,o=n.is_deploy,p=n.scopeMax,d=n.handleType,u=n.currentKey,c=H.default.getCurrTeamName(),h=H.default.getCurrRegionName();a.validateFields((e,t)=>{e||l({type:"createApp/installAppPlugin",payload:{team_name:c,region_name:h,group_id:i||0,app_id:r.app_id,is_deploy:o,group_key:r.ID,app_version:t.group_version,marketName:u,install_from_cloud:"localApplication"!==p},callback:()=>{l({type:"global/fetchGroups",payload:{team_name:c}}),this.setState({installBounced:!1,is_deploy:!0}),d&&s&&s(),l(x.routerRedux.push("/team/".concat(c,"/region/").concat(H.default.getCurrRegionName(),"/myplugns")))}})})}),this.onChangeSelect=((e,t)=>{var a=this.props.dispatch,l=this.state,i=l.showCreate,s=l.currentKey,n=(l.btnStatus,H.default.getCurrTeamName()),r=H.default.getCurrRegionName();a({type:"createApp/changeAppVersions",payload:(0,v.default)({team_name:n,region_name:r},e,{app_id:i.app_id,is_deploy:t,group_key:i.group_key,app_version:e.group_version,marketName:s}),callback:e=>{this.setState({btnStatus:e.bean.status})}})}),this.onChangeSelectCloud=((e,t)=>{var a=this.props.dispatch,l=this.state,i=l.showCreate,s=l.currentKey,n=(l.btnStatus,l.scopeMax),r=H.default.getCurrTeamName(),o=H.default.getCurrRegionName();a({type:"createApp/changeAppVersions",payload:(0,v.default)({team_name:r,region_name:o},e,{app_id:i.app_id,is_deploy:t,group_key:i.group_key,app_version:e.group_version,marketName:s,install_from_cloud:"localApplication"!==n}),callback:e=>{this.setState({btnStatus:e.bean.status})}})}),this.handleCreate=((e,t)=>{this.setState({addAppLoading:!0});var a=this.props.dispatch,l=this.state,i=l.showCreate,s=l.currentKey,n=H.default.getCurrTeamName(),r=H.default.getCurrRegionName();a({type:"createApp/installAppPlugin",payload:(0,v.default)({team_name:n,region_name:r},e,{app_id:i.app_id,is_deploy:t,group_key:i.group_key,app_version:e.group_version,marketName:s}),callback:()=>{a({type:"global/fetchGroups",payload:{team_name:n},callback:()=>{this.onCancelCreate(),a(x.routerRedux.push("/team/".concat(n,"/region/").concat(H.default.getCurrRegionName(),"/myplugns")))}})}})}),this.handleCreateHelm=((e,t)=>{var a=this.props.dispatch,l=H.default.getCurrTeamName();this.setState({helmInstallLoading:!0}),a({type:"createApp/installHelmApp",payload:(0,v.default)({team_name:l},e,{is_deploy:t}),callback:e=>{a({type:"global/fetchGroups",payload:{team_name:l},callback:()=>{e&&200===e.status_code&&e.bean&&e.bean.ID&&(this.onCancelCreate(),a(x.routerRedux.push("/team/".concat(l,"/region/").concat(H.default.getCurrRegionName(),"/apps/").concat(e.bean.ID)))),this.setState({helmInstallLoading:!1})},renderError:()=>{this.setState({helmInstallLoading:!1})}})}})}),this.handleCloudCreate=((e,t)=>{this.setState({addAppLoading:!0});var a=this.state,l=a.scopeMax,i=a.currentKey,s=(this.props.groupId,this.state.showCreate),n=H.default.getCurrTeamName(),r=H.default.getCurrRegionName();this.props.dispatch({type:"createApp/installAppPlugin",payload:(0,v.default)({app_id:s.app_id,team_name:n,region_name:r},e,{is_deploy:t,app_versions:s.app_versions,group_key:s.app_key_id,app_version:e.group_version,install_from_cloud:"localApplication"!==l,marketName:i}),callback:e=>{this.props.dispatch({type:"global/fetchGroups",payload:{team_name:H.default.getCurrTeamName()},callback:()=>{f.default.success({message:"\u5b89\u88c5\u6210\u529f"}),this.onCancelCreate(),this.setState({is_deploy:!0}),this.props.dispatch(x.routerRedux.push("/team/".concat(n,"/region/").concat(H.default.getCurrRegionName(),"/myplugns")))}})}})}),this.handleVisibleChange=((e,t)=>{var a=this.state.visiblebox,l=e.ID;a[l]=t,this.setState({visiblebox:a}),this.queryExport(e)}),this.showMarketAppDetail=(e=>{e&&e.app_detail_url?window.open(e.app_detail_url,"_blank"):this.setState({showApp:e,showMarketAppDetail:!0})}),this.hideMarketAppDetail=(()=>{this.setState({showApp:{},showMarketAppDetail:!1})}),this.loadMore=(()=>{var e=this.state.scopeMax;this.props.handleServiceComponent(e)}),this.handleTabs=((e,t)=>{var a=this.state.handleType;return M.default.createElement(_.default,{defaultActiveKey:"",onChange:this.handleTabChange,style:{background:"#fff",padding:a?"0 20px 20px":"20px "}},e.map(e=>{var a=e.key,l=e.tab;return M.default.createElement(K,{tab:l,key:a},M.default.createElement("div",{className:G.default.cardList,style:{paddingBottom:"20px"}},t))}))}),this.renderApp=((e,t,l)=>{var i=this.state,s=i.scopeMax,n=i.handleType,r="localApplication"!=s,o=e=>M.default.createElement("div",{title:e.app_name||e.name||"",style:{maxWidth:"200px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},M.default.createElement("a",{onClick:()=>{this.showMarketAppDetail(e)}},e.app_name||e.name)),p=M.default.createElement("div",{title:e.version,className:G.default.cardVersionStyle},M.default.createElement("span",null,"\u7248\u672c:"),M.default.createElement("div",{className:G.default.overScroll},M.default.createElement("div",null,e.versions_info&&e.versions_info.map((e,t)=>{return M.default.createElement(g.default,{title:e.version,className:G.default.cardVersionTagStyle,color:"green",size:"small",key:t},e.version)}),e.versions&&e.versions.map((e,t)=>{return M.default.createElement(g.default,{className:G.default.cardVersionTagStyle,color:"green",size:"small",title:e.app_version||e.version,key:t},e.app_version||e.version)})))),d=[M.default.createElement(m.default,{title:t?"\u70b9\u51fb\u5b89\u88c5":"\u4e0d\u53ef\u5b89\u88c5"},M.default.createElement("div",{onClick:()=>{t&&this.showCreate(e)}},M.default.createElement("div",{className:G.default.cardTitle},M.default.createElement("span",{title:e.app_name},e.app_name)),p))],u=t?[M.default.createElement("span",{onClick:()=>{"helm"===l?this.handleHelmIntall(e):this.showCreate(e)}},"\u5b89\u88c5")]:[],c=a("Vkwn");return M.default.createElement(M.Fragment,null,(1==e.is_official||1==e.is_official)&&M.default.createElement(I.default,{style:{marginLeft:6,marginTop:6}}),M.default.createElement(h.default,{className:n?"".concat(G.default.cards," ").concat(G.default.clearAvatar):G.default.cards,actions:n?d:u},M.default.createElement(h.default.Meta,{className:G.default.cardsMetas,style:n&&{height:80,overflow:"hidden",display:"flex",justifyContent:"center",cursor:"pointer"},avatar:M.default.createElement("img",{style:n?{width:80,height:80,margin:" 0 auto"}:{width:110,height:110,margin:" 0 auto"},alt:e.title,src:r?e.logo||e.icon||c:e.pic||c,height:n?154:80,onClick:()=>{this.showMarketAppDetail(e)}}),title:n?"":o(e),description:n?"":M.default.createElement(M.Fragment,null,M.default.createElement("span",{style:{display:"block",color:"rgb(200, 200, 200)",marginBottom:2,fontSize:12}},p,!r&&M.default.createElement("div",{className:G.default.memoryStyle},M.default.createElement("span",null,"\u5185\u5b58: "),j.default.unit(e.min_memory||128,"MB"))),M.default.createElement(N.default,{className:G.default.item,lines:3},M.default.createElement("span",{title:e.describe||e.description},e.describe||e.description)))})))}),this.renderSuccessOnChange=(()=>{this.setState({is_deploy:!this.state.is_deploy})}),this.renderFormComponent=(()=>{var e={labelCol:{span:5},wrapperCol:{span:19}},t=this.props.form,a=t.getFieldDecorator,l=this.state.installBounced,i=l.versions_info||l.versions;return M.default.createElement(y.default,{onSubmit:this.handleInstallBounced,layout:"horizontal",hideRequiredMark:!0},M.default.createElement(y.default.Item,(0,c.default)({},e,{label:"\u9009\u62e9\u7248\u672c"}),a("group_version",{initialValue:i[0].version||i[0].app_version,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7248\u672c"}]})(M.default.createElement(A.default,{getPopupContainer:e=>e.parentNode,style:{width:"220px"}},i.map(e=>{return M.default.createElement(q,{key:e.version,value:e.version||e.app_version},e.version||e.app_version)})))))}),this.handleCertification=(e=>{this.setState({authorizations:e})});var t=this.props,l=t.handleType,i=void 0===l?"":l,s=t.match,n=t.scope,r=void 0===n?"":n,o=t.moreState,p=t.scopeMax,d=decodeURIComponent("Service"===i?"":s&&s.params&&s.params.keyword||"");this.state={helmInstallLoading:!1,list:[],authorizations:!1,app_name:d,page:1,pageSize:9,total:0,isSpinList:!0,isSpincloudList:!0,networkText:"",cloudList:[],cloudApp_name:"",cloudPage:1,cloudPageSize:9,cloudTotal:0,helmCreate:null,showCreate:null,scope:r,scopeMax:p||"localApplication",showApp:{},showMarketAppDetail:!1,installBounced:!1,handleType:i||null,moreState:o||null,is_deploy:!0,btnStatus:"",localAppTab:[{key:"localApplication",tab:"\u672c\u5730\u7ec4\u4ef6\u5e93"}],rainStoreTab:[],helmStoreTab:[],currentKey:"",helmList:[],helmLoading:!0,helmPag:{pageSize:9,total:0,page:1,query:""},addAppLoading:!1},this.mount=!1}componentWillMount(){var e=this.props,t=e.currentTeamPermissionsInfo,a=e.dispatch;V.default.canCreateComponent(t,a)}componentDidMount(){this.mount=!0,this.getApps(),this.getMarketsTab(),this.getHelmMarketsTab()}componentWillUnmount(){this.mount=!1,this.mountquery=!1}render(){var e=this.props,t=e.loading,a=e.currentEnterprise,l=e.currentTeam,i=e.currentRegionName,c=e.isHelm,h=void 0===c||c,m=e.isAddMarket,g=this.state,f=g.handleType,v=g.moreState,y=g.installBounced,_=g.list,C=g.scopeMax,b=g.cloudList,S=g.cloudPage,E=g.cloudPageSize,A=g.cloudTotal,k=g.isSpinList,x=g.isSpincloudList,N=g.networkText,I=g.page,V=g.pageSize,j=g.total,q=g.helmInstallLoading,K=g.currentKey,F=g.authorizations,X=g.showCreate,Q=g.showMarketAppDetail,Z=g.showApp,J=g.is_deploy,W=g.app_name,U=g.cloudApp_name,Y=g.helmList,$=g.helmPag,ee=g.helmLoading,te=g.helmCreate,ae=g.addAppLoading,le=g.localAppTab,ie=g.rainStoreTab,se=g.helmStoreTab,ne=g.btnStatus,re=(H.default.fetchSvg("dockerSvg"),!!v),oe={current:v?1:I,pageSize:v?3:V,total:v?1:j,hideOnSinglePage:re,onChange:e=>{this.hanldePageChange(e)}},pe={current:v?1:S,pageSize:v?3:E,total:v?1:A,hideOnSinglePage:re,onChange:e=>{this.hanldeCloudPageChange(e)}},de={current:v?1:$.page,pageSize:v?3:$.pageSize,total:v?1:$.total,hideOnSinglePage:re,onChange:e=>{this.hanldeHelmPageChange(e)}},ue=!0,ce=[...le,...ie,...se];if(ce&&ce.length>0){var he=ce.filter(e=>{return e.name===K});he&&he.length>0&&(ue=(0,B.fetchMarketAuthority)(he[0],"ReadInstall"))}var me=f&&v&&("localApplication"===C&&_&&_.length>0||"localApplication"!=C&&b&&b.length>0)&&M.default.createElement("div",{style:{textAlign:"right",height:"70px",marginTop:"-40px",position:"relative",zIndex:99}},M.default.createElement("a",{onClick:this.loadMore},"\u67e5\u770b\u66f4\u591a...")),ge=M.default.createElement(u.default,{bordered:!1,grid:{gutter:24,lg:3,md:2,sm:1,xs:1},locale:{emptyText:!k&&_&&_.length<=0&&M.default.createElement("p",{style:{paddingTop:80,lineHeight:1.3}},"\u6682\u65e0\u5e94\u7528\u6a21\u578b\uff0c \u4f60\u53ef\u4ee5",M.default.createElement("br",null),M.default.createElement("br",null),"\u53d1\u5e03\u5e94\u7528\u6a21\u578b")},pagination:oe,dataSource:_,renderItem:e=>M.default.createElement(u.default.Item,{style:{border:"none"}},this.renderApp(e,!0))}),fe=M.default.createElement(u.default,{bordered:!1,grid:{gutter:24,lg:3,md:2,sm:1,xs:1},pagination:pe,dataSource:b,renderItem:e=>M.default.createElement(u.default.Item,{style:{border:"none"}},this.renderApp(e,ue))}),ve=M.default.createElement(u.default,{bordered:!1,grid:{gutter:24,lg:3,md:2,sm:1,xs:1},pagination:de,dataSource:Y,renderItem:e=>{var t=e;return e.versions&&e.versions.length>0&&(t=Object.assign({},e,e.versions[0])),M.default.createElement(u.default.Item,{style:{border:"none"}},this.renderApp(t,!0,"helm"))}}),ye="localApplication"==C?W:U,_e=M.default.createElement("div",{style:{textAlign:"center"}},M.default.createElement("span",{id:"searchWrap",style:{display:"inline-block"}},M.default.createElement(d.default.Search,{ref:"searchs",placeholder:"\u8bf7\u8f93\u5165\u5e94\u7528\u540d\u79f0",enterButton:"\u641c\u7d22",size:"large",value:ye,onChange:e=>{this.setState({app_name:e.target.value,cloudApp_name:e.target.value})},defaultValue:ye,onSearch:this.handleSearch,style:{width:500}}))),Ce=[{key:"",tab:"\u5168\u90e8"}],be=[{key:"enterprise",tab:"\u516c\u53f8\u53d1\u5e03"},{key:"team",tab:"\u56e2\u961f\u53d1\u5e03"}],Se=Ce.concat(be),Ee=[];Ee=(0,D.createTeam)((0,D.createEnterprise)(Ee,a),l,i),Ee.push({title:"\u521b\u5efa\u7ec4\u4ef6"});var Ae=M.default.createElement("div",{style:{height:"255px",lineHeight:"255px",textAlign:"center"}},M.default.createElement(p.default,{size:"large"}));return M.default.createElement("div",null,F&&M.default.createElement(T.default,{eid:a.enterprise_id,marketName:F,title:"\u83b7\u53d6\u4e91\u5e94\u7528\u5546\u5e97\u6388\u6743",onCancel:()=>{this.setState({authorizations:!1})},currStep:2}),te&&M.default.createElement(w.default,{installLoading:q,data:te,onSubmit:this.handleCreateHelm,onCancel:this.onCancelCreate}),X&&M.default.createElement(P.default,{disabled:t.effects["createApp/installAppPlugin"],onChangeSelect:f?this.onChangeSelect:"localApplication"==C?this.onChangeSelect:this.onChangeSelectCloud,btnStatus:ne,onSubmit:f?this.handleCreate:"localApplication"==C?this.handleCreate:this.handleCloudCreate,onCancel:this.onCancelCreate,showCreate:X,addAppLoading:ae}),Q&&M.default.createElement(O.default,{onOk:this.hideMarketAppDetail,onCancel:this.hideMarketAppDetail,app:Z}),f&&y&&M.default.createElement(n.default,{title:"\u786e\u8ba4\u8981\u5b89\u88c5\u6b64\u5e94\u7528\u4f5c\u4e3a\u4f60\u7684\u7ec4\u4ef6\u4e48\uff1f",className:L.default.TelescopicModal,visible:y,onOk:this.handleInstallBounced,onCancel:()=>{this.setState({installBounced:!1})},footer:M.default.createElement("div",null,M.default.createElement(o.default,{onClick:()=>{this.setState({installBounced:!1,is_deploy:!0})}},"\u53d6\u6d88"),M.default.createElement(o.default,{onClick:this.handleInstallBounced,type:"primary",style:{marginRight:"5px"},loading:t.effects["createApp/installAppPlugin"]},"\u5b89\u88c5"),M.default.createElement(r.default,{size:"small",onClick:this.renderSuccessOnChange,checked:J},"\u5e76\u6784\u5efa\u542f\u52a8"))},y.describe&&M.default.createElement("p",{style:{background:"rgba(22, 184, 248, 0.1)",padding:"8px"}},y.describe),this.renderFormComponent()),ce&&ce.length>0&&m?M.default.createElement("div",null,M.default.createElement(R.default,{isAddMarket:this.props.isAddMarket,isSvg:!0,breadcrumbList:Ee,content:f&&v?"":_e,tabList:ce,tabActiveKey:C,onTabChange:this.handleTabMaxChange,isFooter:!!f},"localApplication"!==C&&!ue&&M.default.createElement(s.default,{message:M.default.createElement("div",null,"\u5f53\u524d\u5e02\u573a\u6ca1\u6709\u5b89\u88c5\u6743\u9650\uff0c",M.default.createElement("a",{onClick:()=>{this.handleCertification(C)}},"\u53bb\u6388\u6743")),type:"success",style:{margin:"-10px 0 15px 0"}}),C.indexOf("Helm-")>-1&&h?M.default.createElement("div",null,ee?Ae:ve):"localApplication"===C?M.default.createElement("div",{style:{marginBottom:!v&&f&&"Service"===f&&"40px"}},k?Ae:this.handleTabs(Se,ge)):M.default.createElement("div",null,x&&-1!==x?Ae:M.default.createElement("div",null,M.default.createElement("div",{className:G.default.cardList,style:{paddingBottom:"20px",marginBottom:v?"0px":"40px"}},-1!==x&&fe,N&&M.default.createElement(s.default,{style:{textAlign:"center",marginBottom:16},message:N,type:"warning"})))),me)):M.default.createElement("div",null,M.default.createElement(z.default,{isAddMarket:this.props.isAddMarket,isSvg:!0,breadcrumbList:Ee,content:f&&v?"":_e,tabList:ce,tabActiveKey:C,onTabChange:this.handleTabMaxChange,isFooter:!!f},"localApplication"!==C&&!ue&&M.default.createElement(s.default,{message:M.default.createElement("div",null,"\u5f53\u524d\u5e02\u573a\u6ca1\u6709\u5b89\u88c5\u6743\u9650\uff0c",M.default.createElement("a",{onClick:()=>{this.handleCertification(C)}},"\u53bb\u6388\u6743")),type:"success",style:{margin:"-10px 0 15px 0"}}),C.indexOf("Helm-")>-1&&h?M.default.createElement("div",null,ee?Ae:ve):"localApplication"===C?M.default.createElement("div",{style:{marginBottom:!v&&f&&"Service"===f&&"40px"}},k?Ae:this.handleTabs(Se,ge)):M.default.createElement("div",null,x&&-1!==x?Ae:M.default.createElement("div",null,M.default.createElement("div",{className:G.default.cardList,style:{paddingBottom:"20px",marginBottom:v?"0px":"40px"}},-1!==x&&fe,N&&M.default.createElement(s.default,{style:{textAlign:"center",marginBottom:16},message:N,type:"warning"})))),me)))}},S=E))||S)||S);t.default=F},fXYz:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV")),n=l(a("jehZ"));a("+L6B");var r=l(a("2/Rp"));a("y8nQ");var o=l(a("Vl3Y"));a("OaEy");var p,d,u,c,h=l(a("2fM7")),m=a("MuoO"),g=i(a("q1tI")),f=(l(a("qCJ4")),l(a("QDog"))),v=l(a("e6Ls")),y=h.default.Option,_={labelCol:{span:5},wrapperCol:{span:19}},C=(p=(0,m.connect)(e=>{var t=e.global;return{groups:t.groups}},null,null,{withRef:!0}),d=o.default.create(),p(u=d((c=class extends g.PureComponent{constructor(e){super(e),this.onAddGroup=(()=>{this.setState({addGroup:!0})}),this.cancelAddGroup=(()=>{this.setState({addGroup:!1})}),this.handleAddGroup=(e=>{var t=this.props.form.setFieldsValue;t({group_id:e}),this.cancelAddGroup()}),this.handleChangeVersion=(e=>{var t=this.state.is_deploy,a=this.props,l=a.onChangeSelect,i=a.showCreate;if(e){var s={group_version:e};l(s,t)}else{var n={group_version:i.versions_info?i.versions_info[0].version:i.versions[0].app_version};l(n,t)}}),this.fetchGroup=(()=>{this.props.dispatch({type:"global/fetchGroups",payload:{team_name:f.default.getCurrTeamName()}})}),this.handleSubmit=(e=>{e.preventDefault();var t=this.state.is_deploy,a=this.props,l=a.form,i=a.onSubmit;l.validateFields((e,a)=>{!e&&i&&(i(a,t),this.setState({is_deploy:!0}))})}),this.renderSuccessOnChange=(()=>{this.setState({is_deploy:!this.state.is_deploy})}),this.state={addGroup:!1,is_deploy:!0}}componentDidMount(){this.handleChangeVersion()}render(){var e=this.props.form.getFieldDecorator,t=this.props,a=(t.groups,t.onCancel),l=t.showCreate,i=t.addAppLoading,p=t.disabled,d=t.btnStatus,u=(this.props.data,l&&l.versions_info&&l.versions_info.length>0&&l.versions_info),c=l&&l.versions&&l.versions.length>0&&l.versions;return g.default.createElement(s.default,{className:v.default.TelescopicModal,visible:l,onCancel:a,onOk:this.handleSubmit,title:"\u8981\u5b89\u88c5\u5230\u54ea\u4e2a\u5e94\u7528?",footer:[g.default.createElement("div",{style:{display:"flex",marginLeft:"120px"}},g.default.createElement(r.default,{onClick:a},"\u53d6\u6d88"),g.default.createElement("div",null,d&&"Installable"==d?g.default.createElement(r.default,{onClick:this.handleSubmit,type:"primary",style:{marginRight:"5px"},loading:i||p},"\u5b89\u88c5"):"AlreadyInstalled"==d?g.default.createElement(r.default,{type:"primary",style:{marginRight:"5px"},disabled:!0},"\u5df2\u5b89\u88c5"):"Upgradeable"==d?g.default.createElement(r.default,{onClick:this.handleSubmit,type:"primary",style:{marginRight:"5px"},loading:i||p},"\u5347\u7ea7"):g.default.createElement(r.default,{onClick:this.handleSubmit,type:"primary",style:{marginRight:"5px"},loading:i||p},"\u5b89\u88c5")))]},g.default.createElement(o.default,{onSubmit:this.handleOk,layout:"horizontal",hideRequiredMark:!0},g.default.createElement(o.default.Item,(0,n.default)({},_,{label:"\u5b89\u88c5\u7248\u672c"}),e("group_version",{initialValue:u?u[0].version:c?c[0].app_version:"",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7248\u672c"}]})(g.default.createElement(h.default,{getPopupContainer:e=>e.parentNode,onChange:this.handleChangeVersion,style:{width:"220px"}},u?u.map((e,t)=>{return g.default.createElement(y,{key:t,value:e.version},e.version)}):c&&c.map((e,t)=>{return g.default.createElement(y,{key:t,value:e.app_version},e.app_version)}))))))}},u=c))||u)||u);t.default=C}}]);