(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[51],{"1nZ5":function(e,t,a){"use strict";var i=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var r=i(a("bx4M"));a("g9YV");var l=i(a("wCAj"));a("+L6B");var n=i(a("2/Rp"));a("P2fV");var d=i(a("NJEC"));a("14J3");var o=i(a("BMrR"));a("/xke");var c=i(a("TeRw"));a("tU7J");var u,p,m,f=i(a("wFql")),h=a("MuoO"),g=s(a("q1tI")),y=i(a("SKd/")),v=i(a("XZXw")),b=a("vSx2"),_=i(a("QDog")),k=i(a("hMqj")),E=f.default.Paragraph,w=(u=(0,h.connect)(e=>{var t=e.user,a=e.teamControl,i=e.enterprise;return{currUser:t.currentUser,currentTeam:a.currentTeam,currentRegionName:a.currentRegionName,currentEnterprise:i.currentEnterprise,currentTeamPermissionsInfo:a.currentTeamPermissionsInfo}}),u((m=class extends g.Component{constructor(e){super(e),this.onPageChange=(e=>{this.setState({licenseLoading:!0}),this.setState({page:e},()=>{this.load()})}),this.rowKey=((e,t)=>t),this.load=(()=>{var e=this.state,t=e.page,a=e.pageSize;this.props.dispatch({type:"gateWay/fetchAllLicense",payload:{team_name:_.default.getCurrTeamName(),page_num:t,page_size:a},callback:e=>{e&&200===e.status_code&&this.setState({licenseList:e.list,total:e.bean.nums,editData:"",licenseLoading:!1})}})}),this.handleCick=(()=>{this.setState({visibleDrawer:!0})}),this.handleClose=(()=>{this.setState({visibleDrawer:!1,editData:""})}),this.handleOk=(e=>{var t=this.state.editData;t?this.props.dispatch({type:"gateWay/editLicense",payload:{alias:e.alias,private_key:e.private_key,certificate:e.certificate,certificate_type:e.certificate_type,team_name:_.default.getCurrTeamName(),certifiate_id:this.state.id},callback:e=>{e&&200===e.status_code&&(c.default.success({message:e?"\u4fee\u6539\u6210\u529f":"\u4fee\u6539\u5931\u8d25"}),this.setState({visibleDrawer:!1},()=>{this.load()}))}}):this.props.dispatch({type:"gateWay/addLicense",payload:{alias:e.alias,private_key:e.private_key,certificate:e.certificate,certificate_type:e.certificate_type,team_name:_.default.getCurrTeamName()},callback:e=>{e&&200===e.status_code&&(c.default.success({message:"\u6dfb\u52a0\u6210\u529f"}),this.setState({visibleDrawer:!1},()=>{this.load()}))}})}),this.handleDelete=(e=>{this.props.dispatch({type:"gateWay/deleteLicense",payload:{team_name:_.default.getCurrTeamName(),certifiate_id:e.id},callback:e=>{e&&200===e.status_code&&(c.default.success({message:e&&e.msg_show||"\u5220\u9664\u6210\u529f"}),this.load())}})}),this.handleEdit=(e=>{this.props.dispatch({type:"gateWay/queryDetail",payload:{certifiate_id:e.id,team_name:_.default.getCurrTeamName()},callback:e=>{e&&200===e.status_code&&this.setState({visibleDrawer:!0,editData:e.bean,id:e.bean.id})}})}),this.saveForm=(e=>{this.form=e,this.state.editData&&this.form&&this.form.setFieldsValue(this.state.editData)}),this.handleUpdate=(e=>{console.log(e)}),this.handlePermissions=(e=>{var t=this.props.currentTeamPermissionsInfo;return k.default.querySpecifiedPermissionsInfo(t,e)}),this.state={visibleDrawer:!1,licenseList:[],licenseLoading:!0,page:1,pageSize:10,total:"",editData:"",id:"",operationPermissions:this.handlePermissions("queryCertificateInfo")}}componentWillMount(){var e=this.props.dispatch,t=this.state.operationPermissions.isAccess;t?this.load():_.default.withoutPermission(e)}render(){var e=this.props,t=e.currentEnterprise,a=e.currentTeam,i=e.currentRegionName,s=this.state,c=s.page,u=s.pageSize,p=s.total,m=s.licenseList,f=s.operationPermissions,h=f.isCreate,_=f.isEdit,k=f.isDelete,w=[{title:"\u8bc1\u4e66\u540d\u79f0",dataIndex:"alias",key:"alias",align:"center",width:"12%"},{title:"\u8bc1\u4e66\u5730\u5740",dataIndex:"issued_to",key:"issued_to",align:"center",width:"25%",render:e=>{return g.default.createElement(E,{ellipsis:{rows:2,expandable:!0},style:{margin:0}},e&&e.map(e=>{return g.default.createElement(o.default,{key:e},g.default.createElement(E,{style:{margin:0},copyable:!0},e))}))}},{title:"\u8fc7\u671f\u65f6\u95f4",dataIndex:"end_data",key:"end_data",align:"center",width:"20%",render:(e,t)=>{return g.default.createElement("div",{style:{color:t.has_expired?"red":" rgba(0, 0, 0, 0.65)"}},e)}},{title:"\u8bc1\u4e66\u7c7b\u578b",dataIndex:"certificate_type",key:"certificate_type",align:"center",width:"13%"},{title:"\u8bc1\u4e66\u6765\u6e90",dataIndex:"issued_by",key:"issued_by",align:"center",width:"15%"},{title:"\u64cd\u4f5c",dataIndex:"action",key:"action",align:"center",width:"15%",render:(e,t)=>{return g.default.createElement("span",null,_&&g.default.createElement("a",{style:{marginRight:"10px"},onClick:()=>{this.handleEdit(t)}},"\u7f16\u8f91"),!t.issued_by.includes("\u7b2c\u4e09\u65b9\u7b7e\u53d1")&&_&&g.default.createElement("a",{style:{marginRight:"10px"},onClick:()=>{this.handleUpdate(t)}},"\u66f4\u65b0"),k&&g.default.createElement(d.default,{title:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",onConfirm:()=>{this.handleDelete(t)}},g.default.createElement("a",null,"\u5220\u9664")))}}],C=[];return C=(0,b.createTeam)((0,b.createEnterprise)(C,t),a,i),C.push({title:"\u7f51\u5173\u7ba1\u7406"}),g.default.createElement(v.default,{title:"\u8bc1\u4e66\u7ba1\u7406",breadcrumbList:C,content:"TLS\u8bc1\u4e66\u7ba1\u7406\uff0c\u652f\u6301\u670d\u52a1\u7aef\u8bc1\u4e66\uff0c\u652f\u6301\u5c55\u793a\u8bc1\u4e66\u8fc7\u671f\u65f6\u95f4"},g.default.createElement(o.default,null,h&&g.default.createElement(n.default,{type:"primary",icon:"plus",style:{float:"right",marginBottom:"10px"},onClick:this.handleCick},"\u6dfb\u52a0\u8bc1\u4e66")),g.default.createElement(r.default,{bodyStyle:{padding:"0"}},g.default.createElement(l.default,{pagination:{total:p,page_num:c,pageSize:u,onChange:this.onPageChange,current:c},rowKey:this.rowKey,dataSource:m,columns:w,loading:this.state.licenseLoading})),this.state.visibleDrawer&&g.default.createElement(y.default,{ref:this.saveForm,visible:this.state.visibleDrawer,onClose:this.handleClose,onOk:e=>{this.handleOk(e)},editData:this.state.editData}))}},p=m))||p),C=w;t.default=C},"SKd/":function(e,t,a){"use strict";var i=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bbsP");var r=i(a("/wGt"));a("+L6B");var l=i(a("2/Rp")),n=i(a("jehZ"));a("5NDa");var d=i(a("5rEg"));a("miYZ");var o=i(a("tsqr"));a("7Kak");var c=i(a("9yH6"));a("y8nQ");var u,p,m,f=i(a("Vl3Y")),h=a("MuoO"),g=s(a("q1tI")),y=i(a("ZNrE")),v=f.default.Item,b=c.default.Group,_=(u=(0,h.connect)(e=>{var t=e.loading;return{editLicenseLoading:t.effects["gateWay/editLicense"],addLicenseLoading:t.effects["gateWay/addLicense"]}}),u((m=class extends g.PureComponent{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault();var t=this.props.onOk;this.props.form.validateFields((e,a)=>{!e&&t&&t(a)})}),this.beforeUpload=((e,t)=>{var a=e.name.split("."),i=a.length,s="pem"===a[i-1]||"crt"===a[i-1]||"cer"===a[i-1]||"key"===a[i-1];return!!s||(t&&o.default.warning("\u8bf7\u4e0a\u4f20\u4ee5.pem, .crt, .cer, .key\u7ed3\u5c3e\u7684\u6587\u4ef6",5),!1)}),this.state={}}render(){var e=this.props,t=e.onClose,a=e.editData,i=void 0===a?{}:a,s=e.addLicenseLoading,o=e.editLicenseLoading,u=e.form,p=u.getFieldDecorator,m=u.setFieldsValue,h={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:19}}},_={setFieldsValue:m,formItemLayout:h,Form:f.default,getFieldDecorator:p},k=[{value:i.certificate,name:"certificate",label:"\u516c\u94a5\u8bc1\u4e66",messages:"\u8bf7\u8f93\u5165\u8bc1\u4e66\u540d\u79f0",uploadName:"public_key_btn",mode:"javascript"},{value:i.private_key,name:"private_key",label:"\u79c1\u94a5",messages:"\u8bf7\u8f93\u5165\u79c1\u94a5",uploadName:"private_key_btn",mode:"javascript"}];return g.default.createElement("div",null,g.default.createElement(r.default,{title:i?"\u7f16\u8f91\u8bc1\u4e66":"\u6dfb\u52a0\u8bc1\u4e66",placement:"right",width:500,closable:!1,onClose:t,visible:this.props.visible,maskClosable:!1,style:{overflow:"auto"}},g.default.createElement(f.default,{onSubmit:this.handleSubmit},g.default.createElement(v,(0,n.default)({},h,{label:"\u8bc1\u4e66\u540d\u79f0"}),p("alias",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8bc1\u4e66\u540d\u79f0!"},{max:64,message:"\u6700\u5927\u957f\u5ea664\u4f4d"}]})(g.default.createElement(d.default,{placeholder:"\u8bf7\u8f93\u5165\u8bc1\u4e66\u540d\u79f0"}))),g.default.createElement(v,(0,n.default)({},h,{label:"\u8bc1\u4e66\u7c7b\u578b"}),p("certificate_type",{initialValue:"\u670d\u52a1\u7aef\u8bc1\u4e66",rules:[{required:!0}]})(g.default.createElement(b,null,g.default.createElement(c.default,{value:"\u670d\u52a1\u7aef\u8bc1\u4e66"},"\u670d\u52a1\u7aef\u8bc1\u4e66")))),k.map(e=>{var t=e.value,a=e.name,i=e.label,s=e.messages,r=e.mode;return g.default.createElement(g.Fragment,{key:a},g.default.createElement(y.default,(0,n.default)({},_,{data:t,name:a,label:i,message:s,mode:r,beforeUpload:this.beforeUpload})))}),g.default.createElement("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px",zIndex:4}},g.default.createElement(l.default,{style:{marginRight:8},onClick:t},"\u53d6\u6d88"),g.default.createElement(l.default,{htmlType:"submit",type:"primary",loading:o||s},"\u786e\u8ba4")))))}},p=m))||p),k=f.default.create()(_),E=k;t.default=E}}]);