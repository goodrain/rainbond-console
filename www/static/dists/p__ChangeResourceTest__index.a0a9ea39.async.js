(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[29],{ecsQ:function(e,t,a){e.exports={all_style:"all_style___1QqKG",tabs_value:"tabs_value___qcpKn",loading:"loading___1G-wy",empty_style:"empty_style___2W5d7"}},vGbb:function(e,t,a){"use strict";var s=a("g09b"),l=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var n=s(a("2/Rp"));a("T2oS");var r=s(a("W9HT"));a("R9oj");var o=s(a("ECub"));a("Znn+");var i,c,u,d=s(a("ZTPi")),p=(a("17x9"),a("MuoO")),m=a("7DNP"),h=l(a("q1tI")),g=s(a("7h8G")),f=s(a("kYhC")),v=s(a("Y6FW")),_=s(a("cr+7")),y=s(a("Im2e")),b=s(a("1ZQj")),I=s(a("xhfu")),E=s(a("YvgB")),k=s(a("QDog")),C=s(a("ecsQ")),R=d.default.TabPane,S=(i=(0,p.connect)(null,null,null,{withRef:!0}),i((u=class extends h.PureComponent{constructor(e){super(e),this.handleGetImageRepositories=(()=>{var e=this.props.dispatch;e({type:"createApp/getImageRepositories",payload:{team_name:k.default.getCurrTeamName()},callback:e=>{e&&this.setState({localImageList:e.list})}})}),this.callback=(e=>{this.setState({tabKey:e})}),this.resourcesRequest=(()=>{var e=this.props.dispatch,t=this.state,a=t.eventId,s=t.groupId,l=k.default.getCurrTeamName();e({type:"teamControl/getAdvancedInformation",payload:{team_name:l,event_id:a,group_id:s},callback:e=>{this.setState({switch:!this.state.switch,resourcesVal:e.bean},()=>{var e=this.state.resourcesVal;e&&e.convert_resource&&e.convert_resource.length>0?this.setState({tabKey:"0"}):this.setState({tabKey:"k8s"})})}})}),this.handleHelmResourcesRequest=(()=>{var e=this.props.dispatch,t=this.state,a=t.helmInfo,s=t.eventId,l=t.groupId;e({type:"teamControl/getHelmAdvancedInfo",payload:{team_name:k.default.getCurrTeamName(),event_id:s,group_id:l,name:a.info.name,version:a.info.Version,overrides:a.overrides},callback:e=>{this.setState({switch:!this.state.switch,resourcesVal:e.bean},()=>{var e=this.state.resourcesVal;e&&e.convert_resource&&e.convert_resource.length>0?this.setState({tabKey:"0"}):this.setState({tabKey:"k8s"})})}})}),this.handerClick=(()=>{var e=this.props.dispatch,t=this.state,a=t.eventId,s=t.groupId,l=t.type,n=k.default.getCurrTeamName(),r=k.default.getCurrRegionName();e("helm"==l?m.routerRedux.push("/team/".concat(n,"/region/").concat(r,"/apps/").concat(s,"/helminstall?installPath=upload&event_id=").concat(a)):m.routerRedux.push("/team/".concat(n,"/region/").concat(r,"/importMessageYaml?event_id=").concat(a,"&group_id=").concat(s)))}),this.saveChildData=((e,t)=>{var a=this.state.resourcesVal;a.convert_resource.length>0&&a.convert_resource.map((a,s)=>{s==e&&(a.basic_management.image=t)}),this.setState({resourcesVal:a})}),this.nextStep=(()=>{var e=this.props.dispatch,t=this.state,a=t.eventId,s=t.groupId,l=t.type,n=t.resourcesVal;this.setState({deploymentLoading:!0});var r=k.default.getCurrTeamName(),o=k.default.getCurrRegionName();e("helm"==l?{type:"createApp/installHelmUploadApp",payload:{team_name:r,group_id:s,resource:n},callback:t=>{this.setState({deploymentLoading:!1}),e(m.routerRedux.push("/team/".concat(r,"/region/").concat(o,"/apps/").concat(s,"/overview")))}}:{type:"teamControl/confirmTheImport",payload:{team_name:r,event_id:a,group_id:s},callback:t=>{t&&t.response_data&&200==t.response_data.code&&(this.setState({deploymentLoading:!1}),e(m.routerRedux.push("/team/".concat(r,"/region/").concat(o,"/apps/").concat(s,"/overview"))))}})}),this.state={switch:!1,resourcesVal:{},tabKey:"0",eventId:"",groupId:"",deploymentLoading:!1,helmInfo:{},type:"",localImageList:[]}}componentDidMount(){var e=this.props.location&&this.props.location.query&&this.props.location.query.event_id||"",t=this.props.location&&this.props.location.query&&this.props.location.query.group_id||"",a=this.props.location&&this.props.location.query&&this.props.location.query.type||"",s=JSON.parse(window.sessionStorage.getItem("helmInfo"));this.setState({eventId:e,groupId:t,helmInfo:s,type:a},()=>{"helm"==a?(this.handleHelmResourcesRequest(),this.handleGetImageRepositories()):this.resourcesRequest()})}render(){var e=this.state,t=e.resourcesVal,a=(e.tabKey,e.deploymentLoading,e.type),s=e.localImageList,l=t.convert_resource,i=t.kubernetes_resources,c=!l&&!i;return h.default.createElement(h.Fragment,null,h.default.createElement(r.default,{tip:"Loading...",size:"large",spinning:this.state.deploymentLoading,style:{marginTop:"500px"}},h.default.createElement("div",{className:C.default.all_style},h.default.createElement("h3",null,"\u9ad8\u7ea7\u8d44\u6e90"),h.default.createElement("div",{className:C.default.tabs_value},this.state.switch?h.default.createElement(h.default.Fragment,null,c?h.default.createElement(o.default,{image:o.default.PRESENTED_IMAGE_SIMPLE,style:{marginTop:"300px"}}):h.default.createElement(d.default,{activeKey:this.state.tabKey,ref:e=>{this._Tabs=e},onChange:this.callback},l&&l.length>0&&l.map((e,t)=>{return h.default.createElement(R,{tab:e.components_name,key:t},h.default.createElement(g.default,{typeHelm:a,indexKey:t,localImageList:s,value:e.basic_management,saveChildData:this.saveChildData}),h.default.createElement(f.default,{value:e.port_management}),h.default.createElement(v.default,{value:e.env_management}),h.default.createElement(_.default,{value:e.config_management}),h.default.createElement(y.default,{value:e.telescopic_management}),h.default.createElement(b.default,{value:e.health_check_management}),h.default.createElement(I.default,{value:e.component_k8s_attributes_management}))}),h.default.createElement(R,{tab:"k8s\u8d44\u6e90",key:"k8s"},h.default.createElement(E.default,{value:i})))):h.default.createElement("div",{className:C.default.loading},h.default.createElement(r.default,{size:"large"})))),h.default.createElement("div",{style:{background:"#fff",padding:"20px",textAlign:"right",position:"fixed",bottom:0,left:0,right:0,zIndex:2,borderTop:"1px solid #e8e8e8"}},h.default.createElement(n.default,{style:{marginRight:8},onClick:this.handerClick,type:"default"},"\u4e0a\u4e00\u6b65"),h.default.createElement(n.default,{style:{marginRight:8},onClick:this.nextStep,type:"primary"},"\u90e8\u7f72"))))}},c=u))||c),w=S;t.default=w}}]);