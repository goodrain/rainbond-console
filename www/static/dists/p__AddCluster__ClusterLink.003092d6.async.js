(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{Zw3B:function(e,t,a){"use strict";var r=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var l=r(a("bx4M"));a("+L6B");var n=r(a("2/Rp"));a("jCWc");var s=r(a("kPKH"));a("5NDa");var i=r(a("5rEg"));a("14J3");var d=r(a("BMrR"));a("bP8k");var o=r(a("gFTJ"));a("fOrg");var u=r(a("+KLJ")),c=r(a("jehZ"));a("/xke");var p=r(a("TeRw")),f=r(a("p0pE"));a("y8nQ");var g,m,h,v=r(a("Vl3Y")),b=r(a("18gR")),y=a("MuoO"),k=a("7DNP"),E=w(a("q1tI")),I=r(a("AklW"));function P(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(P=function(e){return e?a:t})(e)}function w(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=P(t);if(a&&a.has(e))return a.get(e);var r={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var s=l?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(r,n,s):r[n]=e[n]}return r.default=e,a&&a.set(e,r),r}var x=(g=(0,y.connect)(),m=v.default.create(),g(h=m(h=class extends E.PureComponent{constructor(e){super(e),this.createClusters=(()=>{var e,t=this.props,a=t.dispatch,r=t.eid,l=t.form,n=t.selectClusterID,s=t.selectProvider,i=this.state,d=i.configsYaml,o=i.task;switch(s){case"ack":e="\u4ece\u963f\u91cc\u4e91\u6258\u7ba1\u96c6\u7fa4\u5b89\u88c5\u5bf9\u63a5";break;case"tke":e="\u4ece\u817e\u8baf\u4e91\u6258\u7ba1\u96c6\u7fa4\u5b89\u88c5\u5bf9\u63a5";break;case"custom":e="\u4ece\u81ea\u5b9a\u4e49 Kubernetes \u96c6\u7fa4\u5bf9\u63a5";break;case"rke":e="\u63d0\u4f9b\u4e3b\u673a\u5b89\u88c5 Kubernetes \u96c6\u7fa4\u5e76\u5bf9\u63a5";break;default:e="\u81ea\u5efa\u96c6\u7fa4"}l.validateFields((t,l)=>{t||(this.setState({commitloading:!0}),a({type:"region/createEnterpriseCluster",payload:(0,f.default)({},l,{enterprise_id:r,desc:e,token:d,region_type:["custom"],provider:s,providerClusterID:n}),callback:e=>{e&&200===e._condition&&(p.default.success({message:"\u6dfb\u52a0\u6210\u529f"}),a(o?{type:"cloud/updateInitTaskStatus",payload:{enterprise_id:r,taskID:o.taskID,status:"complete"},callback:()=>{a(k.routerRedux.push("/enterprise/".concat(r,"/clusters")))},handleError:e=>{404==e.data.code?a(k.routerRedux.push("/enterprise/".concat(r,"/clusters"))):I.default.handleCloudAPIError(e),this.setState({commitloading:!1})}}:k.routerRedux.push("/enterprise/".concat(r,"/clusters"))))},handleError:e=>{I.default.handleCloudAPIError(e),this.setState({commitloading:!1})}}))})}),this.loadRegionConfig=(()=>{var e=this.props,t=e.dispatch,a=e.eid,r=e.selectClusterID,l=e.selectProvider;t({type:"cloud/loadRegionConfig",payload:{enterprise_id:a,clusterID:r,providerName:l},callback:e=>{e&&this.setState({configs:e.configs,configsYaml:e.configs_yaml,loading:!1})},handleError:e=>{I.default.handleCloudAPIError(e),this.setState({loading:!1})}})}),this.loadTask=(()=>{var e=this.props,t=e.dispatch,a=e.eid,r=e.selectClusterID,l=e.selectProvider;t({type:"cloud/loadInitRainbondTask",payload:{enterprise_id:a,clusterID:r,providerName:l},callback:e=>{e&&(this.setState({task:e}),this.loadRegionConfig())},handleError:e=>{e.data&&404===e.data.code?this.loadRegionConfig():(I.default.handleCloudAPIError(e),this.setState({loading:!1}))}})}),this.handleNewbieGuiding=(e=>{var t=e.prevStep,a=e.nextStep,r=e.handleClick,l=void 0===r?()=>{}:r;return E.default.createElement(b.default,(0,c.default)({},e,{totals:14,handlePrev:()=>{t&&this.handleGuideStep(t)},handleClose:()=>{this.handleGuideStep("close")},handleNext:()=>{a&&(l(),this.handleGuideStep(a))}}))}),this.handleGuideStep=(e=>{this.setState({guideStep:e})}),this.state={loading:!0,configs:{},guideStep:13,task:null}}componentDidMount(){this.loadTask()}render(){var e,t=this.props,a=t.selectProvider,r=t.form,c=this.state,p=c.configs,f=c.loading,g=c.commitloading,m=c.guideStep,h=r.getFieldDecorator;switch(a){case"ack":e="\u963f\u91cc\u4e91\u6258\u7ba1\u96c6\u7fa4";break;case"tke":e="\u817e\u8baf\u4e91\u6258\u7ba1\u96c6\u7fa4";break;case"custom":e="\u81ea\u5b9a\u4e49\u5bf9\u63a5\u96c6\u7fa4";break;case"rke":e="\u81ea\u5efa\u96c6\u7fa4";break;default:e="\u81ea\u5efa\u96c6\u7fa4"}var b={position:"relative",zIndex:1e3,padding:"0 16px",margin:"0 -16px",background:"#fff"};return E.default.createElement(v.default,null,E.default.createElement(l.default,{loading:f,bordered:!1,style:{padding:"0 16px"}},E.default.createElement(d.default,null,!p.apiAddress&&E.default.createElement(u.default,{message:"\u672a\u6b63\u5e38\u83b7\u53d6\u5230\u96c6\u7fa4\u7684\u521d\u59cb\u5316\u72b6\u6001\uff0c\u4e0d\u80fd\u8fdb\u884c\u5bf9\u63a5",type:"error"}),p.apiAddress&&E.default.createElement(o.default,null,E.default.createElement(o.default.Item,{label:"API\u901a\u4fe1\u5730\u5740"},E.default.createElement("div",{style:{display:"flex",alignItems:"center"}},p.apiAddress,E.default.createElement(u.default,{style:{marginLeft:"20px"},message:"\u8bf7\u786e\u4fdd\u8be5IP\u5730\u5740\u76848443\u7aef\u53e3\uff0c6060\u7aef\u53e3\u5bf9\u5916\u5f00\u653e",type:"warning"}))))),E.default.createElement(d.default,{style:{marginTop:"32px"}},E.default.createElement("h4",null,"\u96c6\u7fa4\u8bbe\u7f6e")),E.default.createElement(d.default,{style:13===m?b:{}},E.default.createElement(s.default,{span:6,style:{paddingRight:"16px"}},E.default.createElement(v.default.Item,{label:"\u96c6\u7fa4ID"},h("region_name",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8fa8\u8bc6\u5ea6\u9ad8\u7684\u96c6\u7fa4ID\uff0c\u4e0d\u53ef\u4fee\u6539"},{pattern:/^[a-z0-9A-Z-_]+$/,message:"\u53ea\u652f\u6301\u5b57\u6bcd\u3001\u6570\u5b57\u548c-_\u7ec4\u5408"}]})(E.default.createElement(i.default,{placeholder:"\u8bf7\u586b\u5199\u8fa8\u8bc6\u5ea6\u9ad8\u7684\u96c6\u7fa4ID\uff0c\u4e0d\u53ef\u4fee\u6539"})))),E.default.createElement(s.default,{span:6},E.default.createElement(v.default.Item,{label:"\u96c6\u7fa4\u540d\u79f0"},h("region_alias",{initialValue:e,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u96c6\u7fa4\u540d\u79f0!"},{max:24,message:"\u6700\u5927\u957f\u5ea624\u4f4d"}]})(E.default.createElement(i.default,{placeholder:"\u8bf7\u586b\u5199\u96c6\u7fa4\u540d\u79f0"}))))),13===m&&this.handleNewbieGuiding({tit:"\u96c6\u7fa4\u670d\u52a1\u5df2\u7ecf\u5b89\u88c5\u6210\u529f\u4e86",desc:"\u8bf7\u8f93\u5165\u96c6\u7fa4\u8bbe\u7f6e\u4fe1\u606f",send:!1,configName:"clusterDocking",showSvg:!1,showArrow:!0,nextStep:14}),E.default.createElement(d.default,null,E.default.createElement(s.default,{style:{textAlign:"center",marginTop:"32px"},span:24},E.default.createElement(n.default,{loading:g,onClick:this.createClusters,disabled:!p.apiAddress,type:"primary"},"\u5bf9\u63a5"),14===m&&this.handleNewbieGuiding({tit:"\u96c6\u7fa4\u8bbe\u7f6e\u914d\u7f6e\u5b8c\u6210\u540e\u8bf7\u5f00\u59cb\u5bf9\u63a5",btnText:"\u5bf9\u63a5",send:!0,configName:"clusterDocking",nextStep:15,handleClick:()=>{p.apiAddress&&this.createClusters()},conPosition:{left:"50%",bottom:"-138px"},svgPosition:{left:"50%",marginTop:"-11px"}})))))}})||h)||h);t.default=x},sExd:function(e,t,a){"use strict";var r=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var l=r(a("bx4M"));a("14J3");var n=r(a("BMrR"));a("y8nQ");var s=r(a("Vl3Y"));a("FJo9");var i,d,o,u=r(a("L41K")),c=a("MuoO"),p=a("7DNP"),f=b(a("q1tI")),g=r(a("Zw3B")),m=r(a("XZXw")),h=r(a("+iC2"));function v(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(v=function(e){return e?a:t})(e)}function b(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=v(t);if(a&&a.has(e))return a.get(e);var r={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var s=l?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(r,n,s):r[n]=e[n]}return r.default=e,a&&a.set(e,r),r}var y=u.default.Step,k=(i=s.default.create(),d=(0,c.connect)(e=>{var t=e.user,a=e.list,r=e.loading,l=e.global,n=e.index;return{user:t.currentUser,list:a,loading:r.models.list,rainbondInfo:l.rainbondInfo,enterprise:l.enterprise,isRegist:l.isRegist,oauthLongin:r.effects["global/creatOauth"],overviewInfo:n.overviewInfo}}),i(o=d(o=class extends f.PureComponent{constructor(e){super(e),this.loadSteps=(()=>{var e=[{title:"\u9009\u62e9\u4f9b\u5e94\u5546"},{title:"\u9009\u62e9(\u521b\u5efa)\u5e73\u53f0\u96c6\u7fa4"},{title:"\u521d\u59cb\u5316\u5e73\u53f0\u96c6\u7fa4"},{title:"\u5b8c\u6210\u5bf9\u63a5"}];return e});var t=this.props.user,a=h.default.isCompanyAdmin(t);this.state={adminer:a}}componentWillMount(){var e=this.state.adminer,t=this.props.dispatch;e||t(p.routerRedux.push("/"))}componentDidMount(){}render(){var e=this.props.match.params,t=e.eid,a=e.provider,r=e.clusterID;return f.default.createElement(m.default,{title:"\u6dfb\u52a0\u96c6\u7fa4",content:"\u96c6\u7fa4\u662f\u8d44\u6e90\u7684\u96c6\u5408\uff0c\u4ee5Kubernetes\u96c6\u7fa4\u4e3a\u57fa\u7840\uff0c\u90e8\u7f72\u5e73\u53f0Region\u670d\u52a1\u5373\u53ef\u6210\u4e3a\u5e73\u53f0\u96c6\u7fa4\u8d44\u6e90\u3002"},f.default.createElement(n.default,{style:{marginBottom:"16px"}},f.default.createElement(u.default,{current:3},this.loadSteps().map(e=>f.default.createElement(y,{key:e.title,title:e.title})))),f.default.createElement(l.default,null,f.default.createElement(n.default,{style:{marginBottom:"16px"}},f.default.createElement(g.default,{eid:t,selectProvider:a,selectClusterID:r}))))}})||o)||o);t.default=k}}]);