(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[24],{Jq4M:function(e,t,a){"use strict";var r=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var l=r(a("bx4M"));a("+L6B");var n=r(a("2/Rp"));a("jCWc");var i=r(a("kPKH"));a("5NDa");var d=r(a("5rEg"));a("7Kak");var o=r(a("9yH6"));a("14J3");var u=r(a("BMrR"));a("O3gP");var p=r(a("lrIw"));a("5Dmo");var m=r(a("3S7+")),c=r(a("jehZ"));a("/xke");var f=r(a("TeRw"));a("y8nQ");var h=r(a("Vl3Y"));a("tU7J");var g=r(a("wFql"));a("fu2T");var v,C,y,_,b=r(a("gK9i")),E=r(a("18gR")),w=a("MuoO"),I=s(a("q1tI")),M=a("LLXN"),S=(r(a("AklW")),r(a("QDog"))),x=r(a("4sH1")),k=r(a("cU6B")),A=r(a("ALo4")),R=r(a("q76B")),N=r(a("NXxf")),F=b.default.Panel,P=(g.default.Paragraph,v=(0,w.connect)(e=>{var t=e.global;return{rainbondInfo:t.rainbondInfo,enterprise:t.enterprise}}),C=h.default.create(),v(y=C((_=class extends I.PureComponent{constructor(e){super(e),this.closeTimer=(()=>{this.timer&&clearInterval(this.timer)}),this.handleTimers=((e,t,a)=>{this[e]=setTimeout(()=>{t()},a)}),this.toClusterList=(()=>{var e=this.props,t=e.dispatch,a=e.completeInit;t({type:"region/fetchClusterInfo",callback:e=>{if(e&&200===e.status_code){var t=e.bean.create_status;"installing"==t?this.setState({installLoading:!0},()=>{this.handleTimers("timer",()=>{this.toClusterList()},2e3)}):(this.timer&&clearInterval(this.timer),a&&a())}}})}),this.handelClusterInfo=(()=>{var e=this.props,t=e.dispatch;e.clusterID,e.selectProvider,e.eid,e.rainbondInfo,e.enterprise,e.nextStep;t({type:"region/fetchClusterNodeInfo",callback:e=>{if(e&&200===e.status_code){var t=e.response_data.data.list.map(e=>{return{node_name:e,host:e}});this.setState({ipArray:t})}}})}),this.handleSubmit=(()=>{var e=this.props,t=e.form,a=(e.eid,e.clusterID,e.nextStep,e.dispatch),r=e.completeInit,s=this.state.ipArray;t.validateFields((e,t)=>{var l={operator:{env:[{name:"DISABLE_LOG",value:"true"}]},Component:{rbd_app_ui:{enable:!1}},Cluster:{rainbondImageRepository:"registry.cn-hangzhou.aliyuncs.com/goodrain",containerdRuntimePath:"/var/run/k3s/containerd"}};if(!e){if(this.setState({installLoading:!0,showhandleSubmitModal:!1}),t.gatewayIngressIPs&&(l.Cluster.gatewayIngressIPs=t.gatewayIngressIPs),t.nodesForGateway){for(var n=[],i=0;i<t.nodesForGateway.length;i++)for(var d=0;d<s.length;d++)if(t.nodesForGateway[i].name===s[d].node_name){var o={name:t.nodesForGateway[i].name,externalIP:s[d].host,internalIP:s[d].host};n.push(o)}l.Cluster.nodesForGateway=n}if(t.nodesForChaos){for(var u=[],p=0;p<t.nodesForChaos.length;p++){var m={name:t.nodesForChaos[p].name};u.push(m)}l.Cluster.nodesForChaos=u}"custom"==t.image&&(l.Cluster.imageHub={enable:!0,domain:t.domain,namespace:t.namespace,username:t.username,password:t.password}),"custom"==t.database&&(l.Cluster.regionDatabase={enable:!0,host:t.regionDatabase_host,port:Number(t.regionDatabase_port),username:t.regionDatabase_username,password:t.regionDatabase_password,name:t.regionDatabase_dbname}),"custom"==t.mirror&&(l.Cluster.rainbondImageRepository=t.mirror_address),l.Cluster.enableEnvCheck=!1;var c=x.default.dump(l);a({type:"region/installCluster",payload:{value_yaml:c,third_db:"custom"==t.database,third_hub:"custom"==t.image},callback:e=>{e&&200===e.status_code?(f.default.success({message:(0,M.formatMessage)({id:"enterpriseColony.newHostInstall.node.initializeSuccess"})}),r&&r()):(this.setState({installLoading:!1}),f.default.error({message:(0,M.formatMessage)({id:"enterpriseColony.newHostInstall.node.initializeLose"})}))},handleError:e=>{this.setState({installLoading:!1}),f.default.error({message:(0,M.formatMessage)({id:"enterpriseColony.newHostInstall.node.initializeLose"})})}})}})}),this.handleNewbieGuiding=(e=>{var t=e.prevStep,a=e.nextStep,r=e.handleClick,s=void 0===r?()=>{}:r;return I.default.createElement(E.default,(0,c.default)({},e,{totals:14,handleClose:()=>{this.handleGuideStep("close")},handlePrev:()=>{t&&this.handleGuideStep(t)},handleNext:()=>{a&&(s(),this.handleGuideStep(a))}}))}),this.handleGuideStep=(e=>{this.setState({guideStep:e})}),this.handleValidatorsNodes=((e,t,a)=>{if(t&&t.length>0){var r=!1;t.some(e=>{if(!e.ip&&!e.name)return r=!1,!0;r=!0}),r?a():a("\u8bf7\u586b\u5199\u5b8c\u6574\u7684\u8282\u70b9\u540d\u79f0")}else a()}),this.hanldeStorageChange=(e=>{this.setState({isStorage:e.target.value})}),this.hanldeImageChange=(e=>{this.setState({isImage:e.target.value})}),this.hanldeDatabaseChange=(e=>{this.setState({isDatabase:e.target.value})}),this.hanldeMirrorChange=(e=>{this.setState({isMirror:e.target.value})}),this.hanldeEctypeChange=(e=>{this.setState({isEctype:e.target.value})}),this.onCancelSubmit=(()=>{this.setState({showhandleSubmitModal:!1})}),this.timer=null,this.state={checked:!1,loading:!1,task:null,isComponents:!1,guideStep:10,ipArray:[],isStorage:"default",isImage:"default",isDatabase:"default",isMirror:"default",isEctype:"default",installLoading:!1,showhandleSubmitModal:!1}}componentDidMount(){this.handelClusterInfo();var e=this.props.type;"installing"==e&&(this.setState({installLoading:!0}),this.toClusterList())}componentWillUnmount(){this.closeTimer()}render(){var e=this.props,t=e.preStep,a=(e.eid,e.selectProvider,e.form),r=(e.clusterID,this.state),s=(r.task,r.initconfig,r.isComponents,r.guideStep),f=(r.checked,r.ipArray),g=(r.isStorage,r.isImage),v=r.isDatabase,C=r.isMirror,y=(r.isEctype,r.installLoading),_=r.showhandleSubmitModal,E={labelCol:{xs:{span:24}},wrapperCol:{xs:{span:24}}},w={labelCol:{xs:{span:2},sm:{span:2}},wrapperCol:{xs:{span:8},sm:{span:8}}},x=a.getFieldDecorator;a.setFieldsValue;return I.default.createElement("div",null,y?I.default.createElement(l.default,null,I.default.createElement(A.default,{type:"ing",title:(0,M.formatMessage)({id:"enterpriseColony.newHostInstall.node.initialize"}),description:(0,M.formatMessage)({id:"enterpriseColony.newHostInstall.node.await"}),style:{padding:"48px"}})):I.default.createElement(h.default,null,I.default.createElement(i.default,{span:24},I.default.createElement(h.default,{onSubmit:this.handleSubmit},I.default.createElement(b.default,{className:N.default.basics,expandIconPosition:"right",defaultActiveKey:["basics"]},I.default.createElement(F,{header:I.default.createElement("span",{className:N.default.spanBox},I.default.createElement("span",{className:N.default.panelTitle,style:{color:"#000"}},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.collapse.basics"}))),key:"basics"},I.default.createElement(u.default,{className:N.default.row},I.default.createElement("div",{className:N.default.title_name},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.title.gatewayIngressIPs"}),I.default.createElement(m.default,{placement:"right",title:I.default.createElement("div",null,(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.tip.gatewayIngressIPs"}))},I.default.createElement("div",null,S.default.fetchSvg("tip")))),I.default.createElement(h.default.Item,(0,c.default)({},w,{label:(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.form.label.gatewayIngressIPs"})}),x("gatewayIngressIPs",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.ACksterList.input_ip"})},{pattern:/((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}/g,message:(0,M.formatMessage)({id:"enterpriseColony.ACksterList.input_correct_ip"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(p.default,null,f&&f.length>0?f.map(e=>{var t=I.default.createElement(p.default.Option,{value:e.host},e.host);return t}):null)))),I.default.createElement(u.default,{className:N.default.row},I.default.createElement("div",{className:N.default.title_name},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.title.nodesForGateway"}),I.default.createElement(m.default,{placement:"right",title:I.default.createElement("div",null,(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.tip.nodesForGateway"}))},I.default.createElement("div",null,S.default.fetchSvg("tip")))),I.default.createElement(h.default.Item,(0,c.default)({},w,{label:(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.form.label.nodesForGateway"})}),x("nodesForGateway",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.ACksterList.input_ip"})},{validator:this.handleValidatorsNodes}]})(I.default.createElement(k.default,{type:"1",keys:"gateway",ipArr:f})))),I.default.createElement(u.default,{className:N.default.row},I.default.createElement("div",{className:N.default.title_name},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.title.nodesForChaos"}),I.default.createElement(m.default,{placement:"right",title:I.default.createElement("div",null,(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.tip.nodesForChaos"}))},I.default.createElement("div",null,S.default.fetchSvg("tip")))),I.default.createElement(h.default.Item,(0,c.default)({},w,{label:(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.form.label.nodesForChaos"})}),x("nodesForChaos",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.ACksterList.input_ip"})},{validator:this.handleValidatorsNodes}]})(I.default.createElement(k.default,{type:"1",keys:"chaos",ipArr:f})))))),I.default.createElement(b.default,{className:N.default.basics,style:{marginTop:"24px"},expandIconPosition:"right"},I.default.createElement(F,{header:I.default.createElement("span",{className:N.default.spanBox},I.default.createElement("span",{className:N.default.panelTitle,style:{color:"#000"}},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.collapse.advanced"}))),key:"advanced"},I.default.createElement(u.default,{className:N.default.row},I.default.createElement("div",{className:N.default.row_flex},I.default.createElement("div",{className:N.default.title_name},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.title.image"}),I.default.createElement(m.default,{placement:"right",title:I.default.createElement("div",null,(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.tip.image"}))},I.default.createElement("div",null,S.default.fetchSvg("tip")))),I.default.createElement(h.default.Item,E,x("image",{initialValue:g})(I.default.createElement(o.default.Group,{onChange:this.hanldeImageChange},I.default.createElement(o.default,{value:"default"},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.radio.default"})),I.default.createElement(o.default,{value:"custom"},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.radio.custom"})))))),"custom"==g&&I.default.createElement(I.default.Fragment,null,I.default.createElement(h.default.Item,(0,c.default)({},w,{label:I.default.createElement(M.FormattedMessage,{id:"enterpriseColony.Advanced.mirror_name"})}),x("domain",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.Advanced.add_mirror"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(d.default,{placeholder:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_mirror"}),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}))),I.default.createElement(h.default.Item,(0,c.default)({},w,{label:I.default.createElement(M.FormattedMessage,{id:"enterpriseColony.Advanced.namespace"})}),x("namespace",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_namespace"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(d.default,{placeholder:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_namespace"}),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}))),I.default.createElement(h.default.Item,(0,c.default)({},w,{label:I.default.createElement(M.FormattedMessage,{id:"enterpriseColony.Advanced.user_name"})}),x("username",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_user_name"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(d.default,{placeholder:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_user_name"}),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}))),I.default.createElement(h.default.Item,(0,c.default)({},w,{label:I.default.createElement(M.FormattedMessage,{id:"enterpriseColony.Advanced.password"})}),x("password",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_password"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(d.default.Password,{type:"password",placeholder:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_password"}),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}))))),I.default.createElement(u.default,{className:N.default.row},I.default.createElement("div",{className:N.default.row_flex},I.default.createElement("div",{className:N.default.title_name},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.title.database"}),I.default.createElement(m.default,{placement:"right",title:I.default.createElement("div",null,(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.tip.database"}))},I.default.createElement("div",null,S.default.fetchSvg("tip")))),I.default.createElement(h.default.Item,E,x("database",{initialValue:v})(I.default.createElement(o.default.Group,{onChange:this.hanldeDatabaseChange},I.default.createElement(o.default,{value:"default"},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.radio.default"})),I.default.createElement(o.default,{value:"custom"},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.radio.custom"})))))),"custom"==v&&I.default.createElement(I.default.Fragment,null,I.default.createElement(h.default.Item,(0,c.default)({},w,{label:I.default.createElement(M.FormattedMessage,{id:"enterpriseColony.Advanced.address"})}),x("regionDatabase_host",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_address"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(d.default,{placeholder:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_address"}),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}))),I.default.createElement(h.default.Item,(0,c.default)({},w,{label:I.default.createElement(M.FormattedMessage,{id:"enterpriseColony.Advanced.port"})}),x("regionDatabase_port",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_port"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(d.default,{placeholder:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_Port"}),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}))),I.default.createElement(h.default.Item,(0,c.default)({},w,{label:I.default.createElement(M.FormattedMessage,{id:"enterpriseColony.Advanced.user_name"})}),x("regionDatabase_username",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_user_name"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(d.default,{placeholder:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_user_Name"}),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}))),I.default.createElement(h.default.Item,(0,c.default)({},w,{label:I.default.createElement(M.FormattedMessage,{id:"enterpriseColony.Advanced.password"})}),x("regionDatabase_password",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_password"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(d.default.Password,{type:"password",placeholder:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_password"}),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}))),I.default.createElement(h.default.Item,(0,c.default)({},w,{label:I.default.createElement(M.FormattedMessage,{id:"enterpriseColony.Advanced.access_name"})}),x("regionDatabase_dbname",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_access_name"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(d.default,{placeholder:(0,M.formatMessage)({id:"enterpriseColony.Advanced.input_access_Name"}),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}))))),I.default.createElement(u.default,{className:N.default.row},I.default.createElement("div",{className:N.default.row_flex},I.default.createElement("div",{className:N.default.title_name},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.title.mirror"}),I.default.createElement(m.default,{placement:"right",title:I.default.createElement("div",null,(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.row.tip.mirror"}))},I.default.createElement("div",null,S.default.fetchSvg("tip")))),I.default.createElement(h.default.Item,E,x("mirror",{initialValue:C})(I.default.createElement(o.default.Group,{onChange:this.hanldeMirrorChange},I.default.createElement(o.default,{value:"default"},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.radio.default"})),I.default.createElement(o.default,{value:"custom"},(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.radio.custom"})))))),"custom"==C&&I.default.createElement(h.default.Item,(0,c.default)({},w,{label:(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.form.label.mirror_address"})}),x("mirror_address",{rules:[{required:!0,message:(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.input.mirror_address.desc"})},{pattern:/^[^\s]*$/,message:(0,M.formatMessage)({id:"placeholder.no_spaces"})}]})(I.default.createElement(d.default,{placeholder:(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.input.mirror_address.desc"}),style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}})))))))),I.default.createElement(i.default,{style:{textAlign:"center",marginTop:"32px"},span:24},I.default.createElement(I.Fragment,null,I.default.createElement(n.default,{onClick:t,style:{marginRight:"16px"}},I.default.createElement(M.FormattedMessage,{id:"button.previous"})),I.default.createElement(n.default,{onClick:()=>{this.setState({showhandleSubmitModal:!0})},type:"primary"},I.default.createElement(M.FormattedMessage,{id:"enterpriseColony.RainbondClusterInit.start"}))),11===s&&this.handleNewbieGuiding({tit:(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.start"}),desc:(0,M.formatMessage)({id:"enterpriseColony.RainbondClusterInit.configuration"}),send:!0,configName:"kclustersAttentionAttention",nextStep:12,conPosition:{left:"63%",bottom:"-39px"},svgPosition:{left:"58%",marginTop:"-13px"},handleClick:()=>{this.handleSubmit()}}))),_&&I.default.createElement(R.default,{onOk:this.handleSubmit,title:(0,M.formatMessage)({id:"enterpriseColony.newHostInstall.node.initializeCluster"}),desc:(0,M.formatMessage)({id:"enterpriseColony.newHostInstall.node.verifyCluster"}),onCancel:this.onCancelSubmit}))}},y=_))||y)||y);t.default=P},NXxf:function(e,t,a){e.exports={typeBtnWrap:"typeBtnWrap___OC3nv",typeBtn:"typeBtn___2Lmdq",active:"active___1_5Q9",en_typeBtnWrap:"en_typeBtnWrap___3Q1cP",en_typeBtn:"en_typeBtn___1kKTI",content:"content___3mgK8",ant_radio_disabled:"ant_radio_disabled___uBN1S",selectRow:"selectRow___1NtoN",panelTitle:"panelTitle___31gpt",panelSpan:"panelSpan___2e2WZ",spanList:"spanList___24Aci",basics:"basics___1Q839",row:"row___1AaJ0",title_name:"title_name___3CBId",row_flex:"row_flex___17rTO"}},XdbD:function(e,t,a){"use strict";var r=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var l=r(a("BMrR"));a("y8nQ");var n=r(a("Vl3Y"));a("FJo9");var i,d,o,u,p=r(a("L41K")),m=a("MuoO"),c=a("7DNP"),f=a("LLXN"),h=s(a("q1tI")),g=r(a("Jq4M")),v=r(a("XZXw")),C=r(a("2lxJ")),y=r(a("QDog")),_=r(a("+iC2")),b=p.default.Step,E=(i=n.default.create(),d=(0,m.connect)(e=>{var t=e.user,a=e.list,r=e.loading,s=e.global,l=e.index;return{user:t.currentUser,list:a,loading:r.models.list,rainbondInfo:s.rainbondInfo,enterprise:s.enterprise,isRegist:s.isRegist,oauthLongin:r.effects["global/creatOauth"],overviewInfo:l.overviewInfo}}),i(o=d((u=class extends h.PureComponent{constructor(e){var t;super(e),t=this,this.toClusterList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rke",a=t.props.dispatch,r=t.props.match.params.eid,s={initializing:"/enterprise/{eid}/provider/{provider}/kclusters/append?event_id={eventId}",initialized:"/enterprise/{eid}/provider/{provider}/kclusters?event_id={eventId}",installing:"/enterprise/{eid}/provider/{provider}/kclusters?type=installing&event_id={eventId}",installed:"/enterprise/{eid}/provider/{provider}/kclusters?event_id={eventId}",integrating:"/enterprise/{eid}/provider/{provider}/kclusters/init?event_id={eventId}",integrated:"/enterprise/{eid}/provider/{provider}/kclusters/check?event_id={eventId}"};a({type:"region/fetchClusterInfo",payload:{cluster_id:""},callback:t=>{if(t&&200===t.status_code){window.localStorage.setItem("event_id",t.bean.event_id);var l=t.bean.create_status,n=s[l]||s.initializing;n=n.replace("{eid}",r).replace("{provider}",e),n.includes("{eventId}")&&(n=n.replace("{eventId}",t.bean.event_id)),a(c.routerRedux.push(n))}}})},this.addClusterOK=(()=>{var e=this.props.dispatch,t=this.props.match.params.eid,a=t||y.default.getCurrEnterpriseId();e(c.routerRedux.push("/enterprise/".concat(a,"/clusters")))}),this.preStep=(()=>{var e=this.props.dispatch,t=this.props.match.params,a=t.eid,r=t.provider,s=a||y.default.getCurrEnterpriseId();e(c.routerRedux.push("/enterprise/".concat(s,"/provider/").concat(r,"/kclusters")))}),this.nextStep=(()=>{var e=this.props.dispatch,t=this.props.match.params,a=t.eid,r=t.provider,s=(t.clusterID,a||y.default.getCurrEnterpriseId());e(c.routerRedux.push("/enterprise/".concat(s,"/provider/").concat(r,"/kclusters/check")))}),this.loadSteps=(()=>{var e=[{title:(0,f.formatMessage)({id:"enterpriseColony.addCluster.supplier"})},{title:(0,f.formatMessage)({id:"enterpriseColony.addCluster.cluster"})},{title:(0,f.formatMessage)({id:"enterpriseColony.addCluster.Initialize"})},{title:(0,f.formatMessage)({id:"enterpriseColony.addCluster.clusterInit"})},{title:(0,f.formatMessage)({id:"enterpriseColony.addCluster.docking"})}];return e}),this.completeInit=(()=>{var e=this.props.dispatch,t=this.props.match.params,a=t.eid,r=t.provider,s=a||y.default.getCurrEnterpriseId();e(c.routerRedux.push("/enterprise/".concat(s,"/provider/").concat(r,"/kclusters/check")))});var a=this.props.user,r=_.default.isCompanyAdmin(a);this.state={adminer:r}}componentWillMount(){var e=this.state.adminer,t=this.props.dispatch;e||t(c.routerRedux.push("/"))}componentDidMount(){}render(){var e=this.props.match.params,t=e.eid,a=e.provider,r=e.clusterID,s=e.taskID,n=e.type;return h.default.createElement(v.default,{title:h.default.createElement(f.FormattedMessage,{id:"enterpriseColony.button.text"}),content:h.default.createElement(f.FormattedMessage,{id:"enterpriseColony.PageHeaderLayout.content"}),titleSvg:C.default.getPageHeaderSvg("clusters",18)},h.default.createElement(l.default,{style:{marginBottom:"16px"}},h.default.createElement(p.default,{current:2},this.loadSteps().map(e=>h.default.createElement(b,{key:e.title,title:e.title})))),h.default.createElement(l.default,null,h.default.createElement(g.default,{eid:t,completeInit:this.completeInit,selectProvider:a,taskID:s,clusterID:r,type:n,preStep:this.preStep})))}},o=u))||o)||o);t.default=E},cU6B:function(e,t,a){"use strict";var r=a("tAuX"),s=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var l=s(a("BMrR"));a("Pwec");var n=s(a("CtXQ"));a("jCWc");var i=s(a("kPKH"));a("OaEy");var d=s(a("2fM7")),o=r(a("q1tI")),u=a("LLXN"),p=d.default.Option;class m extends o.Component{constructor(e){super(e),this.handleNodes=((e,t)=>{var a=this.state.values;a[t].name=e,this.triggerChange(a),this.setValues(a)}),this.add=(()=>{var e=this.state.values;if(e.length>99)return null;this.setState({values:e.concat({name:""})})}),this.remove=(e=>{var t=this.state.values;t.splice(e,1),this.setValues(t),this.triggerChange(t)}),this.state={values:[{name:""}]}}setValues(e){var t=e||[];t.length||t.push({name:""}),this.setState({values:t})}initFromProps(e){var t=e;t&&this.setValues(t)}triggerChange(e){for(var t=[],a=0;a<e.length;a++)t.push({name:e[a].name});var r=this.props.onChange;r&&r(t)}render(){var e="".concat((0,u.formatMessage)({id:"enterpriseColony.Advanced.master"})),t=this.state.values,a=this.props,r=a.keys,s=a.type,m=a.ipArr;return o.default.createElement("div",{key:r},t.map((t,a)=>{var r=0===a;return o.default.createElement(l.default,{key:a,style:{width:"100%",display:"flex"}},o.default.createElement(i.default,{span:24,style:{marginRight:"10px"}},o.default.createElement(d.default,{name:"name",onChange:e=>{this.handleNodes(e,a)},value:t.name,placeholder:e},m&&m.length>0&&m.map((e,t)=>{return o.default.createElement(p,{value:"1"===s?e.node_name:e.host,key:t},"1"===s?e.node_name:e.host)}))),o.default.createElement(i.default,{span:4,style:{textAlign:"center"}},o.default.createElement(n.default,{type:r?"plus-circle":"minus-circle",style:{fontSize:"20px"},onClick:()=>{r?this.add():this.remove(a)}})))}))}}var c=m;t.default=c}}]);