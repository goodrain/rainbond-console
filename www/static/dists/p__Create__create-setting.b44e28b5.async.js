(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[39],{EK8P:function(e,a,t){"use strict";var n=t("g09b"),i=t("tAuX");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,t("+L6B");var s=n(t("2/Rp"));t("/xke");var l,o,r,d=n(t("TeRw")),p=t("MuoO"),c=t("7DNP"),m=i(t("q1tI")),h=t("LLXN"),u=t("4/zt"),g=n(t("2lxJ")),f=n(t("XZXw")),w=n(t("vGHg")),v=n(t("q76B")),_=n(t("QDog")),D=n(t("n9hB")),b=n(t("hMqj")),y=(l=(0,p.connect)(e=>{var a=e.loading,t=e.teamControl;return{buildAppsLoading:a.effects["createApp/buildApps"],deleteAppLoading:a.effects["appControl/deleteApp"],currentTeamPermissionsInfo:t.currentTeamPermissionsInfo,soundCodeLanguage:t.codeLanguage,packageNpmOrYarn:t.packageNpmOrYarn}},null,null,{withRef:!0}),l((r=class extends m.PureComponent{constructor(e){super(e),this.handlePermissions=(e=>{var a=this.props.currentTeamPermissionsInfo;return b.default.querySpecifiedPermissionsInfo(a,e)}),this.loadDetail=(()=>{var e=this.props.dispatch,a=this.fetchParameter(),t=a.team_name,n=a.app_alias;e({type:"appControl/fetchDetail",payload:{team_name:t,app_alias:n},callback:e=>{this.setState({appDetail:e})},handleError:e=>{var a=D.default.getCode(e);a&&404===a&&this.handleJump("exception/404")}})}),this.handleBuild=(e=>{var a=this.props,t=a.dispatch,n=a.soundCodeLanguage,i=a.packageNpmOrYarn,s=(this.state.appDetail,this.fetchParameter()),l=s.team_name,o=s.app_alias;0==e?(0,u.setNodeLanguage)({team_name:l,app_alias:o,lang:n,package_tool:i}).then(e=>{t({type:"createApp/buildApps",payload:{team_name:l,app_alias:o},callback:e=>{e&&(t({type:"global/fetchGroups",payload:{team_name:l}}),window.sessionStorage.removeItem("codeLanguage"),window.sessionStorage.removeItem("packageNpmOrYarn"),window.sessionStorage.removeItem("advanced_setup"),this.handleJump("components/".concat(o,"/overview")))},handleError:e=>{d.default.error({message:e.data.msg_show})}})}):d.default.warning({message:(0,h.formatMessage)({id:"notification.warn.save"})})}),this.handleDelete=(()=>{var e=this.props.dispatch,a=this.fetchParameter(),t=a.team_name,n=a.app_alias;e({type:"appControl/deleteApp",payload:{team_name:t,app_alias:n,is_force:!0},callback:()=>{e({type:"global/fetchGroups",payload:{team_name:t}}),window.sessionStorage.removeItem("codeLanguage"),window.sessionStorage.removeItem("packageNpmOrYarn"),window.sessionStorage.removeItem("advanced_setup"),this.handleJump("index")}})}),this.handleJump=(e=>{var a=this.props.dispatch,t=this.fetchParameter(),n=t.team_name,i=t.region_name;a(c.routerRedux.replace("/team/".concat(n,"/region/").concat(i,"/").concat(e)))}),this.showDelete=(()=>{this.setState({showDelete:!0})}),this.fetchParameter=(()=>{return{team_name:_.default.getCurrTeamName(),region_name:_.default.getCurrRegionName(),app_alias:this.getAppAlias()}}),this.handleBuildSwitch=(e=>{this.setState({handleBuildSwitch:e})}),this.state={appDetail:null,handleBuildSwitch:!1}}componentDidMount(){this.loadDetail()}componentWillUnmount(){this.props.dispatch({type:"appControl/clearDetail"})}getAppAlias(){return this.props.match.params.appAlias}handleDebounce(e,a){var t=null;return n=>{null!==t&&clearTimeout(t),t=setTimeout(()=>{e.call(n),t=null},a)}}render(){var e=this.props,a=e.buildAppsLoading,t=e.deleteAppLoading,n=e.match.params.appAlias,i=this.state,l=i.showDelete,o=i.handleBuildSwitch,r=!0,d=this.state.appDetail||{};return d.service?m.default.createElement(m.default.Fragment,null,m.default.createElement(f.default,{titleSvg:g.default.getPageHeaderSvg("advanced",18),title:(0,h.formatMessage)({id:"componentCheck.advanced.setup"}),content:(0,h.formatMessage)({id:"versionUpdata_6_1.content2"})},m.default.createElement("div",{style:{overflow:"hidden"}},m.default.createElement(w.default,{updateDetail:this.loadDetail,appDetail:d,handleBuildSwitch:this.handleBuildSwitch}),m.default.createElement("div",{style:{background:"#fff",padding:"20px",textAlign:"right",position:"fixed",bottom:0,left:0,right:0,zIndex:2,borderTop:"1px solid #e8e8e8"}},r&&m.default.createElement(s.default,{onClick:this.showDelete,type:"default",style:{marginRight:8}},(0,h.formatMessage)({id:"button.abandon_create"})),m.default.createElement(s.default,{loading:a,onClick:()=>this.handleJump("create/create-configPort/".concat(n)),style:{marginRight:8}},"\u4e0a\u4e00\u6b65"),m.default.createElement(s.default,{loading:a,onClick:()=>this.handleDebounce(this.handleBuild(o),1e3),type:"primary"},(0,h.formatMessage)({id:"button.confirm_create"}))),l&&m.default.createElement(v.default,{loading:t,onOk:this.handleDelete,title:(0,h.formatMessage)({id:"confirmModal.abandon_create.create_check.title"}),subDesc:(0,h.formatMessage)({id:"confirmModal.delete.strategy.subDesc"}),desc:(0,h.formatMessage)({id:"confirmModal.delete.create_check.desc"}),onCancel:()=>{this.setState({showDelete:!1})}})))):null}},o=r))||o);a.default=y}}]);