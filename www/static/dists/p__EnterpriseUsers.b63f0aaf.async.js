(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[36],{"EAv/":function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("OaEy");var n,r,i,d=l(a("2fM7")),o=a("MuoO"),u=s(a("q1tI")),c=l(a("8+Sn")),h=d.default.Option,m=(n=(0,o.connect)(),n((i=class extends u.Component{constructor(e){super(e),this.handleSearch=(e=>{var t=this.props,a=t.eid,l=t.dispatch;l({type:"global/searchTenant",payload:{eid:a,tenant:e},callback:e=>{e&&200===e.status_code&&e.bean&&this.setState({data:e.bean.list||[]})}})}),this.handleChange=(e=>{var t=this.props.onChange;this.setState({tenant:e},()=>{t&&t(e)})}),this.handleSelect=(e=>{var t=this.props.onSelect,a=this.state.data;if(t){var l=a.filter(t=>t.team_name===e);l&&l.length>0&&(c.default.set("region_name",l[0].region),c.default.set("team_name",e)),t(e)}}),this.state={data:[],tenant:void 0}}componentDidMount(){this.handleSearch()}componentWillUnmount(){this.setState({data:[],tenant:""})}render(){var e=this.props,t=e.placeholder,a=e.style,l=this.state,s=l.data,n=l.tenant;return u.default.createElement(d.default,{allowClear:!0,getPopupContainer:e=>e.parentNode,showSearch:!0,placeholder:t,value:n,defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onChange:this.handleChange,notFoundContent:null,onSearch:this.handleSearch,style:a,onSelect:this.handleSelect},s.map(e=>u.default.createElement(h,{value:e.team_name,key:e.team_alias},e.team_alias)))}},r=i))||r),p=m;t.default=p},L24g:function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var n=l(a("kLXV")),r=l(a("jehZ"));a("5NDa");var i=l(a("5rEg"));a("OaEy");var d=l(a("2fM7"));a("y8nQ");var o,u,c,h=l(a("Vl3Y")),m=a("MuoO"),p=s(a("q1tI")),f=l(a("EAv/")),g=l(a("e6Ls")),E=h.default.Item,v=d.default.Option,y=(o=(0,m.connect)(),o((c=class extends p.PureComponent{constructor(e){super(e),this.handleSelect=(e=>{var t=this.props,a=t.dispatch,l=t.form,s=l.setFieldsValue;a({type:"teamControl/fetchTeamRoles",payload:{team_name:e},callback:e=>{e&&this.setState({authorityList:e.list},()=>{s({role_ids:[]})})}})}),this.handleSubmit=(()=>{var e=this.props,t=e.form,a=e.onOk;t.validateFields((e,t)=>{!e&&a&&a(t)})}),this.checkAccountPass=((e,t,a)=>{if(!t)return a();if(t&&t.length<8)a("\u5bc6\u7801\u957f\u5ea6\u81f3\u5c11\u4e3a8\u4f4d");else if(t&&t.length>16)a("\u6700\u5927\u957f\u5ea616\u4f4d");else{var l=new RegExp(/^(?![a-zA-Z]+$)(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/);l.test(t)||a("\u5bc6\u7801\u5fc5\u987b\u5305\u542b\u6570\u5b57,\u5b57\u6bcd,\u7279\u6b8a\u5b57\u7b26")}a()}),this.state={authorityList:[],passwordTimeInfo:[{id:36500,timer:"\u65e0\u9650\u5236"},{id:30,timer:"30\u5929"},{id:90,timer:"90\u5929"}]}}render(){var e=this.props,t=e.eid,a=e.onCancel,l=e.title,s=e.userInfo,o=e.form,u=e.loading,c=void 0!==u&&u,m=o.getFieldDecorator,y=this.state,_=y.authorityList,b=y.passwordTimeInfo,C={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}}};return p.default.createElement(n.default,{visible:!0,maskClosable:!1,title:l||"\u6dfb\u52a0\u7528\u6237",className:g.default.TelescopicModal,onOk:this.handleSubmit,onCancel:a,confirmLoading:c},p.default.createElement(h.default,{onSubmit:this.handleSubmit},!s&&p.default.createElement(E,(0,r.default)({},C,{label:"\u7528\u6237\u540d"}),m("user_name",{initialValue:s?s.nick_name:"",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7528\u6237\u540d!"},{min:3,message:"\u6700\u5c0f\u957f\u5ea63\u4f4d"},{max:24,message:"\u6700\u5927\u957f\u5ea624\u4f4d"},{pattern:/^[a-zA-Z0-9_\-]+$/,message:"\u53ea\u652f\u6301\u5b57\u6bcd\u3001\u6570\u5b57\u3001_\u548c-\u7ec4\u5408"}]})(p.default.createElement(i.default,{autoComplete:"off",placeholder:"\u8bf7\u586b\u5199\u7528\u6237\u540d!"}))),p.default.createElement(E,(0,r.default)({},C,{label:"\u59d3\u540d"}),m("real_name",{initialValue:s&&s.real_name||"",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u59d3\u540d!"},{max:24,message:"\u6700\u5927\u957f\u5ea624\u4f4d"},{pattern:/^[a-zA-Z0-9_\-\u4e00-\u9fa5]+$/,message:"\u53ea\u652f\u6301\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u4e2d\u6587\u3001_\u548c-\u7ec4\u5408"}]})(p.default.createElement(i.default,{autoComplete:"off",type:"text",placeholder:"\u8bf7\u586b\u5199\u59d3\u540d!"}))),!s&&p.default.createElement(E,(0,r.default)({},C,{label:"\u5bc6\u7801"}),m("password",{initialValue:s&&s.password||"",rules:[{required:!0,validator:this.checkAccountPass}]})(p.default.createElement(i.default.Password,{autoComplete:"new-password",placeholder:"\u8bf7\u586b\u5199\u5bc6\u7801"}))),!s&&p.default.createElement(E,(0,r.default)({},C,{label:"\u5bc6\u7801\u8fc7\u671f\u65f6\u95f4"}),m("password_expiration_time",{initialValue:90,rules:[{required:!0,message:"\u8bf7\u8bbe\u7f6e\u5bc6\u7801\u8fc7\u671f\u65f6\u95f4"}]})(p.default.createElement(d.default,{placeholder:"\u8bf7\u9009\u62e9\u5bc6\u7801\u8fc7\u671f\u65f6\u95f4"},b&&b.map(e=>p.default.createElement(v,{key:e.id,value:e.id},e.timer))))),!s&&p.default.createElement(E,(0,r.default)({},C,{label:"\u90ae\u7bb1"}),m("email",{initialValue:s&&s.email||"",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u90ae\u7bb1!"},{type:"email",message:"\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e!"}]})(p.default.createElement(i.default,{type:"text",placeholder:"\u8bf7\u586b\u5199\u90ae\u7bb1!",autoComplete:"off"}))),p.default.createElement(E,(0,r.default)({},C,{label:"\u7535\u8bdd"}),m("phone",{initialValue:s&&s.phone||"",rules:[{pattern:/^[0-9]{11}$/,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7"}]})(p.default.createElement(i.default,{type:"text",placeholder:"\u8bf7\u586b\u5199\u624b\u673a\u53f7",autoComplete:"off"}))),s&&p.default.createElement(E,(0,r.default)({},C,{label:"\u8bbe\u7f6e\u65b0\u5bc6\u7801"}),m("password",{initialValue:s&&s.password||"",rules:[{validator:this.checkAccountPass}]})(p.default.createElement(i.default.Password,{autoComplete:"new-password",placeholder:"\u7559\u7a7a\u5219\u4e0d\u4fee\u6539\u5bc6\u7801"}))),s&&p.default.createElement(E,(0,r.default)({},C,{label:"\u5bc6\u7801\u8fc7\u671f\u65f6\u95f4"}),m("password_expiration_time",{initialValue:90,rules:[{required:!0,message:"\u8bf7\u8bbe\u7f6e\u5bc6\u7801\u8fc7\u671f\u65f6\u95f4"}]})(p.default.createElement(d.default,{placeholder:"\u8bf7\u9009\u62e9\u5bc6\u7801\u8fc7\u671f\u65f6\u95f4"},b&&b.map(e=>p.default.createElement(v,{key:e.id,value:e.id},e.timer))))),!s&&p.default.createElement("div",null,p.default.createElement(E,(0,r.default)({},C,{label:"\u6240\u5c5e\u56e2\u961f"}),m("tenant_name",{rules:[{required:!1,message:"\u8bf7\u9009\u62e9\u56e2\u961f!"}]})(p.default.createElement(f.default,{placeholder:"\u8bf7\u8f93\u5165\u56e2\u961f\u540d\u79f0\u8fdb\u884c\u67e5\u8be2",eid:t,onSelect:this.handleSelect}))),p.default.createElement(E,(0,r.default)({},C,{label:"\u89d2\u8272\u6743\u9650"}),m("role_ids",{initialValue:[],rules:[{required:!1,message:"\u8bf7\u9009\u62e9\u7528\u6237\u89d2\u8272!"}]})(p.default.createElement(d.default,{getPopupContainer:e=>e.parentNode,mode:"multiple",style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u7528\u6237\u89d2\u8272"},_.map(e=>{var t=e.ID,a=e.name;return p.default.createElement(v,{key:t,value:t},a)})))))))}},u=c))||u),_=h.default.create()(y),b=_;t.default=b},TWBS:function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var n=l(a("kLXV"));a("g9YV");var r=l(a("wCAj"));a("+L6B");var i=l(a("2/Rp"));a("/xke");var d,o,u,c=l(a("TeRw")),h=a("MuoO"),m=s(a("q1tI")),p=l(a("hMqj")),f=l(a("GFvx")),g=l(a("e6Ls")),E=(d=(0,h.connect)(e=>{var t=e.user;return{user:t.currentUser}}),d((u=class extends m.PureComponent{constructor(e){super(e),this.getEnterpriseTeams=(()=>{var e=this.props,t=e.dispatch,a=e.eid,l=e.userInfo;t({type:"global/fetchUserTeams",payload:{user_id:l&&l.user_id,enterprise_id:a},callback:e=>{e&&200===e.status_code&&this.setState({list:e&&e.list||[],Loading:!1})}})}),this.handleRole=(e=>{this.setState({toEditAction:e,editRoleLoading:!1})}),this.handleEditRole=(e=>{this.setState({editRoleLoading:!0});var t=this.props,a=t.dispatch,l=t.eid,s=t.userInfo,n=this.state.toEditAction,r="user/editUserRoles";n.roles&&n.roles.length>0&&(r="teamControl/editMember"),a({type:r,payload:{enterprise_id:l,team_name:n.team_name,user_id:s&&s.user_id,role_ids:e.role_ids},callback:()=>{this.getEnterpriseTeams(),c.default.success({message:"\u8bbe\u7f6e\u6210\u529f"}),this.handleRole(!1)}})}),this.handleSubmit=(()=>{var e=this.props,t=e.form,a=e.onOk;t.validateFields((e,t)=>{!e&&a&&a(t)})}),this.state={list:[],toEditAction:!1,editRoleLoading:!0,Loading:!0}}componentDidMount(){this.getEnterpriseTeams()}render(){var e=this.props,t=e.onCancel,a=e.title,l=e.userInfo,s=e.eid,d=this.state,o=d.list,u=d.Loading,c=d.toEditAction,h=d.editRoleLoading,E=this,v=[{title:"\u56e2\u961f\u540d\u79f0",dataIndex:"team_alias",rowKey:"team_alias"},{title:"\u89d2\u8272",dataIndex:"roles",render(e){return m.default.createElement("span",null,e&&e.length>0?e.map(e=>{return m.default.createElement("span",{style:{marginRight:"8px"},key:"role".concat(e)},p.default.actionMap(e))}):m.default.createElement("span",{style:{color:"rgba(0,0,0,.45)"}},"\u5c1a\u672a\u52a0\u5165"))}},{title:"\u64cd\u4f5c",dataIndex:"action",align:"center",width:100,render(e,t){return m.default.createElement("a",{onClick:()=>{E.handleRole(t)}},"\u8bbe\u7f6e\u89d2\u8272")}}];return m.default.createElement(m.Fragment,null,m.default.createElement(n.default,{visible:!0,width:800,title:a||"\u56e2\u961f\u5217\u8868",className:g.default.TelescopicModal,maskClosable:!1,footer:[m.default.createElement(i.default,{style:{marginTop:"20px"},onClick:t},"\u5173\u95ed")],onCancel:t},m.default.createElement(r.default,{loading:u,scroll:{y:300},pagination:!1,dataSource:o,columns:v})),c&&m.default.createElement(f.default,{viewName:"enterprise",title:"\u8bbe\u7f6e\u89d2\u8272",eid:s,loading:h,data:c,userId:l&&l.user_id,teamName:c&&c.team_name,nickName:l&&l.nick_name,onOk:this.handleEditRole,onCancel:()=>{this.handleRole(!1)}}))}},o=u))||o),v=E;t.default=v},iOcZ:function(e,t,a){"use strict";var l=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var n=l(a("bx4M"));a("g9YV");var r=l(a("wCAj"));a("fOrg");var i=l(a("+KLJ"));a("14J3");var d=l(a("BMrR"));a("Pwec");var o=l(a("CtXQ"));a("jCWc");var u=l(a("kPKH"));a("5NDa");var c=l(a("5rEg"));a("+L6B");var h=l(a("2/Rp"));a("/xke");var m=l(a("TeRw")),p=l(a("p0pE"));a("y8nQ");var f,g,E,v=l(a("Vl3Y")),y=a("MuoO"),_=a("7DNP"),b=l(a("wd/R")),C=s(a("q1tI")),w=l(a("q76B")),S=l(a("L24g")),k=l(a("TWBS")),I=l(a("XZXw")),x=a("k9Yu"),L=l(a("AklW")),U=l(a("+iC2")),V=v.default.Item,A=(f=(0,y.connect)(e=>{var t=e.user,a=e.list,l=e.loading,s=e.global,n=e.index;return{user:t.currentUser,list:a,loading:l.models.list,rainbondInfo:s.rainbondInfo,enterprise:s.enterprise,isRegist:s.isRegist,oauthLongin:l.effects["global/creatOauth"],overviewInfo:n.overviewInfo}}),f((E=class extends C.PureComponent{constructor(e){super(e),this.onPageChange=((e,t)=>{this.setState({page:e,pageSize:t},()=>{this.loadUser()})}),this.handleUser=(e=>{this.setState({Loading:!0});var t=this.props,a=t.dispatch,l=t.match.params.eid,s=this.state.userInfo,n=e,r="global/creatUser",i="\u65b0\u589e\u6210\u529f";s&&(n=Object.assign({},s,n),r="global/upEnterpriseUsers",i="\u7f16\u8f91\u6210\u529f"),a({type:r,payload:(0,p.default)({enterprise_id:l},n),callback:e=>{e&&200===e._condition&&(this.canceUser(),this.loadUser(),m.default.success({message:i})),this.handleCloseLoading()},handleError:e=>{e&&e.data&&e.data.code&&e.data.code<600&&e.data.msg_show?m.default.warning({message:e.data.msg_show}):L.default.handleCloudAPIError(e),this.handleCloseLoading()}})}),this.handleCloseLoading=(()=>{this.setState({Loading:!1})}),this.handleDelete=(()=>{var e=this.state.userInfo,t=this.props,a=t.dispatch,l=t.match.params.eid;a({type:"global/deleteEnterpriseUsers",payload:{user_id:e.user_id,enterprise_id:l},callback:e=>{e&&200===e._condition&&(this.loadUser(),this.cancelDelUser(),m.default.success({message:"\u5220\u9664\u6210\u529f"}))}})}),this.loadUser=(()=>{var e=this.props,t=e.dispatch,a=e.match.params.eid,l=this.state,s=l.page,n=l.pageSize,r=l.name;t({type:"global/fetchEnterpriseUsers",payload:{enterprise_id:a,page:s,page_size:n,name:r},callback:e=>{e&&this.setState({adminList:e.list,total:e.total})}})}),this.addUser=(()=>{this.setState({userVisible:!0,text:"\u65b0\u589e\u7528\u6237"})}),this.canceUser=(()=>{this.setState({userVisible:!1,text:"",userInfo:!1,Loading:!1})}),this.handleEdit=(e=>{this.setState({userInfo:e,userVisible:!0,text:"\u7f16\u8f91\u7528\u6237"})}),this.delUser=(e=>{this.setState({delVisible:!0,userInfo:e})}),this.cancelDelUser=(()=>{this.setState({delVisible:!1,userInfo:!1})}),this.handleSearch=(()=>{this.setState({page:1},()=>{this.loadUser()})}),this.handelChange=(e=>{this.setState({name:e&&e.trim()})}),this.handleCurrentUserId=(e=>{this.setState({currentUserInfo:e})}),this.syncUserList=(()=>{this.setState({syncLoading:!0});var e=this.props.match.params.eid;(0,x.syncUserList)({enterprise_id:e}).then(()=>{this.loadUser()}).finally(()=>{this.setState({syncLoading:!1})})});var t=this.props.user,a=U.default.isCompanyAdmin(t);this.state={page:1,pageSize:10,adminer:a,adminList:[],total:0,currentUserInfo:!1,userVisible:!1,userInfo:!1,text:"",delVisible:!1,name:"",Loading:!1,syncLoading:!1}}componentWillMount(){var e=this.state.adminer,t=this.props.dispatch;e||t(_.routerRedux.push("/"))}componentDidMount(){this.loadUser()}render(){var e=this.state,t=e.adminList,a=e.adminer,l=e.text,s=e.userInfo,m=e.delVisible,p=e.userVisible,f=e.page,g=e.pageSize,E=e.total,y=e.Loading,_=e.currentUserInfo,x=e.syncLoading,L=this.props.enterprise,U=this.props.match.params.eid,A=[{title:"\u7528\u6237\u540d\u79f0",dataIndex:"nick_name",rowKey:"nick_name",align:"center",render:(e,t)=>C.default.createElement(h.default,{type:"link",onClick:()=>{this.handleCurrentUserId(t)}},e)},{title:"\u59d3\u540d",dataIndex:"real_name",rowKey:"real_name",align:"center"},{title:"\u7535\u8bdd",dataIndex:"phone",rowKey:"phone",align:"center"},{title:"\u90ae\u7bb1",dataIndex:"email",rowKey:"email",align:"center"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",rowKey:"create_time",align:"center",render:e=>{return C.default.createElement("span",null,(0,b.default)(e).locale("zh-cn").format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u64cd\u4f5c",dataIndex:"user_id",align:"center",rowKey:"user_id",render:(e,t)=>{return[C.default.createElement("a",{onClick:()=>{this.delUser(t)}},"\u5220\u9664"),C.default.createElement("a",{onClick:()=>{this.handleEdit(t)}},"\u7f16\u8f91")]}}];return C.default.createElement(I.default,{title:"\u7528\u6237\u7ba1\u7406 ",content:"\u4f01\u4e1a\u7528\u6237\u67e5\u8be2\u3001\u6dfb\u52a0\u548c\u4fee\u6539\u76f8\u5173\u529f\u80fd\uff0c\u7528\u6237\u9700\u8981\u64cd\u4f5c\u5e94\u7528\u6216\u7ec4\u4ef6\u76f8\u5173\u8d44\u6e90\u65f6\u9700\u8981\u5c06\u5176\u5206\u914d\u5230\u76f8\u5e94\u7684\u56e2\u961f"},C.default.createElement(d.default,{style:{marginBottom:"20px",display:"flex",alignItems:"center"}},C.default.createElement(u.default,{span:12},C.default.createElement(v.default,{layout:"inline",style:{display:"inline-block"}},C.default.createElement(V,null,C.default.createElement(c.default,{placeholder:"\u641c\u7d22\u7528\u6237",onChange:e=>this.handelChange(e.target.value),onPressEnter:this.handleSearch,style:{width:250}})),C.default.createElement(V,null,C.default.createElement(h.default,{type:"primary",onClick:this.handleSearch,icon:"search"},"\u641c\u7d22")))),C.default.createElement(u.default,{span:12,style:{textAlign:"right"}},C.default.createElement(h.default,{style:{float:"right",marginLeft:"32px"},onClick:this.loadUser},C.default.createElement(o.default,{type:"reload"})),a&&L&&"true"===L.sso_enable&&C.default.createElement(h.default,{type:"primary",loading:x,style:{float:"right",marginLeft:"32px"},onClick:this.syncUserList},"\u540c\u6b65\u7528\u6237\u5217\u8868"),a&&L&&(!L.sso_enable||"false"===L.sso_enable)&&C.default.createElement(h.default,{type:"primary",icon:"plus",style:{float:"right"},onClick:this.addUser},"\u65b0\u589e\u7528\u6237"))),C.default.createElement(d.default,null,C.default.createElement(u.default,{span:8,style:{marginBottom:16}},a&&L&&"true"===L.sso_enable&&C.default.createElement(i.default,{showIcon:!0,message:"\u7528\u6237\u4fe1\u606f\u4e0e\u5355\u70b9\u767b\u5f55\u670d\u52a1\u540c\u6b65\uff0c\u6dfb\u52a0\u7528\u6237\u8bf7\u524d\u5f80\u5355\u70b9\u767b\u5f55\u670d\u52a1\u3002",type:"warning"}))),C.default.createElement(n.default,null,m&&C.default.createElement(w.default,{onOk:this.handleDelete,title:"\u5220\u9664\u7528\u6237",subDesc:"\u6b64\u64cd\u4f5c\u4e0d\u53ef\u6062\u590d",desc:"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u7528\u6237\u5417\uff1f",onCancel:this.cancelDelUser}),p&&C.default.createElement(S.default,{eid:U,loading:y,userInfo:s,title:l,onOk:this.handleUser,onCancel:this.canceUser}),_&&C.default.createElement(k.default,{eid:U,userInfo:_,onCancel:()=>{this.handleCurrentUserId(!1)}}),C.default.createElement(r.default,{loading:y,pagination:{current:f,pageSize:g,total:E,onChange:this.onPageChange},dataSource:t,columns:A})))}},g=E))||g);t.default=A}}]);