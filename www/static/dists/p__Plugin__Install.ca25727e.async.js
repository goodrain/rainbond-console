(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[75],{DU6M:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,n,r,o=l(a("p0pE")),p=i(a("q1tI")),d=(a("LLXN"),a("MuoO")),u=a("7DNP"),c=(l(a("XZXw")),l(a("QDog"))),h=l(a("yxQP")),m=(l(a("Gyju")),l(a("2lxJ")),l(a("GMji"))),g=(s=(0,d.connect)(),s((r=class extends p.PureComponent{constructor(){super(...arguments),this.handleSubmit=(e=>{this.props.dispatch({type:"plugin/createPlugin",payload:(0,o.default)({team_name:c.default.getCurrTeamName()},e),callback:e=>{this.props.dispatch(u.routerRedux.push("/team/".concat(c.default.getCurrTeamName(),"/region/").concat(c.default.getCurrRegionName(),"/myplugns/").concat(e&&e.bean.plugin_id)))}})})}render(){h.default.pageHeaderContent,h.default.extraImg;return p.default.createElement(m.default,{isAddMarket:!1})}},n=r))||n);t.default=g},GMji:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("fOrg");var s=l(a("+KLJ"));a("Pwec");var n=l(a("CtXQ"));a("2qtc");var r=l(a("kLXV"));a("7Kak");var o=l(a("9yH6"));a("+L6B");var p=l(a("2/Rp"));a("T2oS");var d=l(a("W9HT"));a("5NDa");var u=l(a("5rEg"));a("Mwp2");var c=l(a("VXEj")),h=l(a("jehZ"));a("IzEo");var m=l(a("bx4M"));a("5Dmo");var g=l(a("3S7+"));a("+BJd");var f=l(a("mr32")),v=l(a("p0pE"));a("/xke");var y=l(a("TeRw"));a("y8nQ");var _=l(a("Vl3Y"));a("Znn+");var C=l(a("ZTPi"));a("OaEy");var S,b,k,E,A=l(a("2fM7")),M=a("MuoO"),x=a("7DNP"),w=i(a("q1tI")),T=a("LLXN"),P=l(a("/VoG")),N=l(a("d5pB")),L=l(a("fXYz")),I=l(a("e6Ls")),O=l(a("xNuS")),z=l(a("hH+r")),R=l(a("iPMB")),H=l(a("EGgK")),B=l(a("bwcx")),D=a("34ay"),V=a("vSx2"),j=l(a("QDog")),F=l(a("2lxJ")),G=(l(a("9Qkj")),l(a("ZgmS"))),q=l(a("yxQP")),K=A.default.Option,X=C.default.TabPane,Q=(S=(0,M.connect)(e=>{var t=e.global,a=e.loading,l=e.teamControl,i=e.enterprise;return{loading:a,enterprise:t.enterprise,currentTeam:l.currentTeam,currentRegionName:l.currentRegionName,currentEnterprise:i.currentEnterprise,currentTeamPermissionsInfo:l.currentTeamPermissionsInfo}},null,null,{pure:!1}),b=_.default.create(),S(k=b((E=class extends w.PureComponent{constructor(e){super(e),this.handleArchCpuInfo=(()=>{var e=this.props.dispatch;e({type:"index/fetchArchOverview",payload:{region_name:j.default.getCurrRegionName(),team_name:j.default.getCurrTeamName()},callback:e=>{e&&e.bean&&this.setState({archInfo:2==e.list.length?"":e.list[0]},()=>{this.getApps()})}})}),this.onCancelCreate=(()=>{this.setState({showCreate:null,helmCreate:null,addAppLoading:!1})}),this.getCloudRecommendApps=(e=>{var t=this.state,a=t.currentKey,l=t.archInfo,i=this.props.currentEnterprise;this.props.dispatch({type:"market/fetchMarkets",payload:{name:a,enterprise_id:i.enterprise_id,query:e?"":this.state.cloudApp_name||"",pageSize:e?9:this.state.cloudPageSize,page:e?1:this.state.cloudPage,is_plugin:!0,arch:l},callback:e=>{e?this.setState({cloudList:e.list||[],cloudTotal:e.total},()=>{e._code&&210===e.status_code&&e._condition&&10503===e._condition?this.setState({isSpincloudList:-1,networkText:e.msg_show}):this.setState({isSpincloudList:!1})}):this.setState({isSpincloudList:!1})}})}),this.getApps=(e=>{var t=this.props,a=t.currentEnterprise,l=t.dispatch,i=this.state,s=i.scopeMax,n=i.archInfo;if(s&&"localApplication"!==s)return null;l({type:"market/fetchAppModels",payload:{enterprise_id:a.enterprise_id,app_name:e?"":this.state.app_name||"",scope:e?"":this.state.scope,page_size:e?9:this.state.pageSize,page:e?1:this.state.page,need_install:!0,is_complete:1,is_plugin:!0,arch:n},callback:e=>{e?this.setState({list:e.list||[],total:e.total},()=>{this.setState({isSpinList:!1})}):this.setState({isSpinList:!1})}})}),this.getMarketsTab=(()=>{var e=this.props,t=e.dispatch,a=e.currentEnterprise,l=this.state.scopeMax;t({type:"market/fetchMarketsTab",payload:{enterprise_id:a.enterprise_id},callback:e=>{var t=e&&e.list||[],a=[];t&&t.length>0&&t.map(e=>{var t=e.name,l=e.status,i=e.alias;1===l&&a.push(Object.assign({},e,{tab:i||t,key:t}))}),this.setState({rainStoreTab:a,marketInfoSwitch:!0}),l&&"localApplication"!==l&&this.handleTabMaxChange(l)}})}),this.getHelmMarketsTab=(()=>{var e=this.props,t=e.dispatch,a=e.currentEnterprise,l=e.isHelm,i=void 0===l||l;i&&t({type:"market/fetchHelmMarketsTab",payload:{enterprise_id:a.enterprise_id},callback:e=>{if(e&&200===e.status_code){var t=[];Array.isArray(e)&&e.map(e=>{t.push(Object.assign({},e,{tab:e.name,key:"Helm-".concat(e.name)}))}),this.setState({helmStoreTab:t,helmInfoSwitch:!0})}}})}),this.getHelmAppStore=(e=>{var t=this.props,a=t.dispatch,l=t.currentEnterprise,i=this.state.helmPag,s=Object.assign({},{name:e,enterprise_id:l.enterprise_id},i);a({type:"market/fetchHelmAppStore",payload:s,callback:e=>{if(e&&200===e.status_code){var t=Object.assign({},i,{total:e&&e.length||0}),a=[];if(Array.isArray(e)){var l=i.query,s=i.page,n=i.pageSize;if(l){var r=[],o=l.length;e.map(e=>{if(o<=e.name.length){var t=e.name.substring(0,o);t.indexOf(l)>-1&&r.push(e)}}),t.total=r.length,a=r.length>n?r.splice((s-1)*n,n):r}else a=e.splice(s>1?(s-1)*n:0,n)}this.setState({helmLoading:!1,helmList:a,helmPag:t})}}})}),this.handleSearch=(e=>{var t=this.state.scopeMax;if("localApplication"===t)this.setState({app_name:e,page:1},()=>{this.getApps()});else if(t.indexOf("Helm-")>-1){var a=this.state.helmPag,l=Object.assign({},a,{page:1,query:e});this.setState({helmPag:l},()=>{this.getHelmAppStore(t.slice(5))})}else this.setState({cloudApp_name:e,cloudPage:1},()=>{this.getCloudRecommendApps()})}),this.hanldePageChange=((e,t)=>{this.setState({page:e,pageSize:t},()=>{this.getApps()})}),this.hanldeCloudPageChange=((e,t)=>{this.setState({cloudPage:e,cloudPageSize:t},()=>{this.getCloudRecommendApps()})}),this.hanldeHelmPageChange=((e,t)=>{var a=this.state,l=a.helmPag,i=a.scopeMax,s=Object.assign({},l,{page:e,pageSize:t});this.setState({helmPag:s},()=>{this.getHelmAppStore(i.slice(5))})}),this.handleTabChange=(e=>{this.setState({scope:e,page:1},()=>{this.getApps()})}),this.handleTabMaxChange=(e=>{this.setState({page:1,cloudPage:1,currentKey:e,scopeMax:e,isSpinList:!0,isSpincloudList:!0,app_name:"",cloudApp_name:""},()=>{"localApplication"===e?this.getApps("reset"):e.indexOf("Helm-")>-1?this.getHelmAppStore(e.slice(5)):this.getCloudRecommendApps("reset")})}),this.showCreate=(e=>{var t=this.state.handleType;t?this.setState({installBounced:e}):this.setState({showCreate:e})}),this.handleHelmIntall=(e=>{var t=this.state,a=t.scopeMax,l=t.helmStoreTab,i={};l.map(e=>{e.key===a&&(i=e)}),this.setState({helmCreate:Object.assign({},e,i,{app_store_name:a.slice(5)})})}),this.handleInstallBounced=(e=>{e.preventDefault();var t=this.props,a=t.form,l=t.dispatch,i=t.groupId,s=t.refreshCurrent,n=this.state,r=n.installBounced,o=n.is_deploy,p=n.scopeMax,d=n.handleType,u=n.currentKey,c=j.default.getCurrTeamName(),h=j.default.getCurrRegionName();a.validateFields((e,t)=>{e||l({type:"createApp/installAppPlugin",payload:{team_name:c,region_name:h,group_id:i||0,app_id:r.app_id,is_deploy:o,group_key:r.ID,app_version:t.group_version,marketName:u,install_from_cloud:"localApplication"!==p},callback:()=>{l({type:"global/fetchGroups",payload:{team_name:c}}),this.setState({installBounced:!1,is_deploy:!0}),d&&s&&s(),l(x.routerRedux.push("/team/".concat(c,"/region/").concat(j.default.getCurrRegionName(),"/myplugns")))},handleError:e=>{e&&y.default.error({message:e.data.msg_show})}})})}),this.onChangeSelect=((e,t)=>{var a=this.props.dispatch,l=this.state,i=l.showCreate,s=l.currentKey,n=(l.btnStatus,j.default.getCurrTeamName()),r=j.default.getCurrRegionName();a({type:"createApp/changeAppVersions",payload:(0,v.default)({team_name:n,region_name:r},e,{app_id:i.app_id,is_deploy:t,group_key:i.group_key,app_version:e.group_version,marketName:s}),callback:e=>{this.setState({btnStatus:e.bean.status})}})}),this.onChangeSelectCloud=((e,t)=>{var a=this.props.dispatch,l=this.state,i=l.showCreate,s=l.currentKey,n=(l.btnStatus,l.scopeMax),r=j.default.getCurrTeamName(),o=j.default.getCurrRegionName();a({type:"createApp/changeAppVersions",payload:(0,v.default)({team_name:r,region_name:o},e,{app_id:i.app_id,is_deploy:t,group_key:i.group_key,app_version:e.group_version,marketName:s,install_from_cloud:"localApplication"!==n}),callback:e=>{this.setState({btnStatus:e.bean.status})}})}),this.handleCreate=((e,t)=>{this.setState({addAppLoading:!0});var a=this.props.dispatch,l=this.state,i=l.showCreate,s=l.currentKey,n=j.default.getCurrTeamName(),r=j.default.getCurrRegionName();a({type:"createApp/installAppPlugin",payload:(0,v.default)({team_name:n,region_name:r},e,{app_id:i.app_id,is_deploy:t,group_key:i.group_key,app_version:e.group_version,marketName:s}),callback:()=>{a({type:"global/fetchGroups",payload:{team_name:n},callback:()=>{this.onCancelCreate(),a(x.routerRedux.push("/team/".concat(n,"/region/").concat(j.default.getCurrRegionName(),"/myplugns")))}})},handleError:e=>{e&&y.default.error({message:e.data.msg_show})}})}),this.handleCreateHelm=((e,t)=>{var a=this.props.dispatch,l=j.default.getCurrTeamName();this.setState({helmInstallLoading:!0}),a({type:"createApp/installHelmApp",payload:(0,v.default)({team_name:l},e,{is_deploy:t}),callback:e=>{a({type:"global/fetchGroups",payload:{team_name:l},callback:()=>{e&&200===e.status_code&&e.bean&&e.bean.ID&&(this.onCancelCreate(),a(x.routerRedux.push("/team/".concat(l,"/region/").concat(j.default.getCurrRegionName(),"/apps/").concat(e.bean.ID,"/overview")))),this.setState({helmInstallLoading:!1})},renderError:()=>{this.setState({helmInstallLoading:!1})}})}})}),this.handleCloudCreate=((e,t)=>{this.setState({addAppLoading:!0});var a=this.state,l=a.scopeMax,i=a.currentKey,s=(this.props.groupId,this.state.showCreate),n=j.default.getCurrTeamName(),r=j.default.getCurrRegionName();this.props.dispatch({type:"createApp/installAppPlugin",payload:(0,v.default)({app_id:s.app_id,team_name:n,region_name:r},e,{is_deploy:t,app_versions:s.app_versions,group_key:s.app_key_id,app_version:e.group_version,install_from_cloud:"localApplication"!==l,marketName:i}),callback:e=>{this.props.dispatch({type:"global/fetchGroups",payload:{team_name:j.default.getCurrTeamName()},callback:()=>{y.default.success({message:(0,T.formatMessage)({id:"notification.success.install_success"})}),this.onCancelCreate(),this.setState({is_deploy:!0}),this.props.dispatch(x.routerRedux.push("/team/".concat(n,"/region/").concat(j.default.getCurrRegionName(),"/myplugns")))}})},handleError:e=>{e&&y.default.error({message:e.data.msg_show})}})}),this.handleVisibleChange=((e,t)=>{var a=this.state.visiblebox,l=e.ID;a[l]=t,this.setState({visiblebox:a}),this.queryExport(e)}),this.showMarketAppDetail=(e=>{e&&e.app_detail_url?window.open(e.app_detail_url,"_blank"):this.setState({showApp:e,showMarketAppDetail:!0})}),this.hideMarketAppDetail=(()=>{this.setState({showApp:{},showMarketAppDetail:!1})}),this.loadMore=(()=>{var e=this.state.scopeMax;this.props.handleServiceComponent(e)}),this.handleTabs=((e,t)=>{var a=this.state.handleType;return w.default.createElement(C.default,{defaultActiveKey:"",onChange:this.handleTabChange,style:{background:"#fff",padding:a?"0 20px 20px":"20px "}},e.map(e=>{var a=e.key,l=e.tab;return w.default.createElement(X,{tab:l,key:a},w.default.createElement("div",{className:q.default.cardList,style:{paddingBottom:"20px"}},t))}))}),this.renderApp=((e,t,l)=>{var i=this.state,s=i.scopeMax,n=i.handleType,r="localApplication"!=s,o=e=>w.default.createElement("div",{title:e.app_name||e.name||"",style:{display:"flex",alignItems:"center"}},w.default.createElement("div",{style:{maxWidth:"170px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},w.default.createElement("a",{onClick:()=>{this.showMarketAppDetail(e)},style:{marginRight:"12px"}},e.app_name||e.name)),w.default.createElement("div",null,e.arch&&e.arch.length>0&&e.arch.map(e=>{return w.default.createElement(f.default,null,e)}))),p=w.default.createElement("div",{title:e.version,className:q.default.cardVersionStyle},w.default.createElement("span",null,"\u7248\u672c:"),w.default.createElement("div",{className:q.default.overScroll},w.default.createElement("div",null,e.versions_info&&e.versions_info.map((e,t)=>{return w.default.createElement(f.default,{title:e.version,className:q.default.cardVersionTagStyle,color:"blue",size:"small",key:t},e.version)}),e.versions&&e.versions.map((e,t)=>{return w.default.createElement(f.default,{className:q.default.cardVersionTagStyle,color:"blue",size:"small",title:e.app_version||e.version,key:t},e.app_version||e.version)})))),d=[w.default.createElement(g.default,{title:t?"\u70b9\u51fb\u5b89\u88c5":"\u4e0d\u53ef\u5b89\u88c5"},w.default.createElement("div",{onClick:()=>{t&&this.showCreate(e)}},w.default.createElement("div",{className:q.default.cardTitle},w.default.createElement("span",{title:e.app_name},e.app_name)),p))],u=t?[w.default.createElement("span",{onClick:()=>{"helm"===l?this.handleHelmIntall(e):this.showCreate(e)}},(0,T.formatMessage)({id:"button.install"}))]:[],c=a("Vkwn");return w.default.createElement(w.Fragment,null,(1==e.is_official||1==e.is_official)&&w.default.createElement(z.default,{style:{marginLeft:6,marginTop:6}}),w.default.createElement(m.default,{className:n?"".concat(q.default.cards," ").concat(q.default.clearAvatar):q.default.cards,actions:n?d:u},w.default.createElement(m.default.Meta,{className:q.default.cardsMetas,style:n&&{height:80,overflow:"hidden",display:"flex",justifyContent:"center",cursor:"pointer"},avatar:w.default.createElement("img",{style:n?{width:80,height:80,margin:" 0 auto"}:{width:110,height:110,margin:" 0 auto"},alt:e.title,src:r?e.logo||e.icon||c:e.pic||c,height:n?154:80,onClick:()=>{this.showMarketAppDetail(e)}}),title:n?"":o(e),description:n?"":w.default.createElement(w.Fragment,null,w.default.createElement("span",{style:{display:"block",color:"rgb(200, 200, 200)",marginBottom:2,fontSize:12}},p,!r&&w.default.createElement("div",{className:q.default.memoryStyle},w.default.createElement("span",null,"\u5185\u5b58: "),G.default.unit(e.min_memory||128,"MB"))),w.default.createElement(O.default,{className:q.default.item,lines:3},w.default.createElement("span",{title:e.describe||e.description},e.describe||e.description)))})))}),this.renderSuccessOnChange=(()=>{this.setState({is_deploy:!this.state.is_deploy})}),this.renderFormComponent=(()=>{var e={labelCol:{span:5},wrapperCol:{span:19}},t=this.props.form,a=t.getFieldDecorator,l=this.state.installBounced,i=l.versions_info||l.versions;return w.default.createElement(_.default,{onSubmit:this.handleInstallBounced,layout:"horizontal",hideRequiredMark:!0},w.default.createElement(_.default.Item,(0,h.default)({},e,{label:"\u9009\u62e9\u7248\u672c"}),a("group_version",{initialValue:i[0].version||i[0].app_version,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7248\u672c"}]})(w.default.createElement(A.default,{getPopupContainer:e=>e.parentNode,style:{width:"220px"}},i.map(e=>{return w.default.createElement(K,{key:e.version,value:e.version||e.app_version},e.version||e.app_version)})))))}),this.handleCertification=(e=>{this.setState({authorizations:e})});var t=this.props,l=t.handleType,i=void 0===l?"":l,s=t.match,n=t.scope,r=void 0===n?"":n,o=t.moreState,p=t.scopeMax,d=decodeURIComponent("Service"===i?"":s&&s.params&&s.params.keyword||"");this.state={helmInstallLoading:!1,list:[],authorizations:!1,app_name:d,page:1,pageSize:9,total:0,isSpinList:!0,isSpincloudList:!0,networkText:"",cloudList:[],cloudApp_name:"",cloudPage:1,cloudPageSize:9,cloudTotal:0,helmCreate:null,showCreate:null,scope:r,scopeMax:p||"localApplication",showApp:{},showMarketAppDetail:!1,installBounced:!1,handleType:i||null,moreState:o||null,is_deploy:!0,btnStatus:"",archInfo:[],localAppTab:[{key:"localApplication",tab:(0,T.formatMessage)({id:"popover.applicationMarket.local"})}],rainStoreTab:[],helmStoreTab:[],marketInfoSwitch:!1,helmInfoSwitch:!1,currentKey:"",helmList:[],helmLoading:!0,helmPag:{pageSize:9,total:0,page:1,query:""},addAppLoading:!1},this.mount=!1}componentWillMount(){var e=this.props;e.currentTeamPermissionsInfo,e.dispatch}componentDidMount(){this.mount=!0,this.handleArchCpuInfo(),this.getMarketsTab(),this.getHelmMarketsTab()}componentWillUnmount(){this.mount=!1,this.mountquery=!1}render(){var e=this.props,t=e.loading,a=e.currentEnterprise,l=e.currentTeam,i=e.currentRegionName,h=e.isHelm,m=void 0===h||h,g=e.isAddMarket,f=this.state,v=f.handleType,y=f.moreState,_=f.installBounced,C=f.list,S=f.scopeMax,b=f.cloudList,k=f.cloudPage,E=f.cloudPageSize,A=f.cloudTotal,M=f.isSpinList,O=f.isSpincloudList,z=f.networkText,G=f.page,K=f.pageSize,X=f.total,Q=f.helmInstallLoading,J=f.currentKey,Z=f.authorizations,W=f.showCreate,U=f.showMarketAppDetail,Y=f.showApp,$=f.is_deploy,ee=f.app_name,te=f.cloudApp_name,ae=f.helmList,le=f.helmPag,ie=f.helmLoading,se=f.helmCreate,ne=f.addAppLoading,re=f.localAppTab,oe=f.rainStoreTab,pe=f.helmStoreTab,de=f.btnStatus,ue=f.marketInfoSwitch,ce=f.helmInfoSwitch,he=(j.default.fetchSvg("dockerSvg"),{current:y?1:G,pageSize:y?3:K,total:y?1:X,onChange:this.hanldePageChange,showQuickJumper:!0,showSizeChanger:!0,onShowSizeChange:this.hanldePageChange,pageSizeOptions:["9","18","27","36"],hideOnSinglePage:X<=9}),me={current:y?1:k,pageSize:y?3:E,total:y?1:A,onChange:this.hanldeCloudPageChange,showQuickJumper:!0,showSizeChanger:!0,showTotal:e=>"\u5171 ".concat(e," \u6761"),onShowSizeChange:this.hanldeCloudPageChange,pageSizeOptions:["9","18","27","36"],hideOnSinglePage:A<=9},ge={current:y?1:le.page,pageSize:y?3:le.pageSize,total:y?1:le.total,onChange:this.hanldeHelmPageChange,showQuickJumper:!0,showSizeChanger:!0,showTotal:e=>"\u5171 ".concat(e," \u6761"),onShowSizeChange:this.hanldeHelmPageChange,pageSizeOptions:["9","18","27","36"],hideOnSinglePage:le.total<=9},fe=!0,ve=[...re,...oe,...pe];if(ve&&ve.length>0){var ye=ve.filter(e=>{return e.name===J});ye&&ye.length>0&&(fe=(0,D.fetchMarketAuthority)(ye[0],"ReadInstall"))}var _e=v&&y&&("localApplication"===S&&C&&C.length>0||"localApplication"!=S&&b&&b.length>0)&&w.default.createElement("div",{style:{textAlign:"right",height:"70px",marginTop:"-40px",position:"relative",zIndex:99}},w.default.createElement("a",{onClick:this.loadMore},"\u67e5\u770b\u66f4\u591a...")),Ce=w.default.createElement(c.default,{bordered:!1,grid:{gutter:24,lg:3,md:2,sm:1,xs:1},locale:{emptyText:!M&&C&&C.length<=0&&w.default.createElement("p",{style:{paddingTop:80,lineHeight:1.3}},(0,T.formatMessage)({id:"notification.market.hint.null_app1"}),w.default.createElement("br",null),w.default.createElement("br",null),(0,T.formatMessage)({id:"notification.market.hint.null_app2"}))},pagination:he,dataSource:C,renderItem:e=>w.default.createElement(c.default.Item,{style:{border:"none"}},this.renderApp(e,!0))}),Se=w.default.createElement(c.default,{bordered:!1,grid:{gutter:24,lg:3,md:2,sm:1,xs:1},pagination:me,dataSource:b,renderItem:e=>w.default.createElement(c.default.Item,{style:{border:"none"}},this.renderApp(e,fe))}),be=w.default.createElement(c.default,{bordered:!1,grid:{gutter:24,lg:3,md:2,sm:1,xs:1},pagination:ge,dataSource:ae,renderItem:e=>{var t=e;return e.versions&&e.versions.length>0&&(t=Object.assign({},e,e.versions[0])),w.default.createElement(c.default.Item,{style:{border:"none"}},this.renderApp(t,!0,"helm"))}}),ke="localApplication"==S?ee:te,Ee=w.default.createElement("div",null,w.default.createElement("span",{id:"searchWrap",style:{display:"inline-block"}},w.default.createElement(u.default.Search,{ref:"searchs",placeholder:(0,T.formatMessage)({id:"placeholder.group_name"}),enterButton:(0,T.formatMessage)({id:"button.search"}),size:"large",value:ke,onChange:e=>{this.setState({app_name:e.target.value,cloudApp_name:e.target.value})},defaultValue:ke,onSearch:this.handleSearch,style:{width:500}}))),Ae=[{key:"",tab:(0,T.formatMessage)({id:"popover.applicationMarket.all"})}],Me=[{key:"enterprise",tab:(0,T.formatMessage)({id:"popover.applicationMarket.company"})},{key:"team",tab:(0,T.formatMessage)({id:"popover.applicationMarket.team"})}],xe=Ae.concat(Me),we=[];we=(0,V.createTeam)((0,V.createEnterprise)(we,a),l,i),we.push({title:"\u521b\u5efa\u7ec4\u4ef6"});var Te=w.default.createElement("div",{style:{height:"255px",lineHeight:"255px",textAlign:"center"}},w.default.createElement(d.default,{size:"large"}));return w.default.createElement("div",null,Z&&w.default.createElement(P.default,{eid:a.enterprise_id,marketName:Z,title:"\u83b7\u53d6\u4e91\u5e94\u7528\u5546\u5e97\u6388\u6743",onCancel:()=>{this.setState({authorizations:!1})},currStep:2}),se&&w.default.createElement(N.default,{installLoading:Q,data:se,onSubmit:this.handleCreateHelm,onCancel:this.onCancelCreate}),W&&w.default.createElement(L.default,{disabled:t.effects["createApp/installAppPlugin"],onChangeSelect:v?this.onChangeSelect:"localApplication"==S?this.onChangeSelect:this.onChangeSelectCloud,btnStatus:de,onSubmit:v?this.handleCreate:"localApplication"==S?this.handleCreate:this.handleCloudCreate,onCancel:this.onCancelCreate,showCreate:W,addAppLoading:ne}),U&&w.default.createElement(R.default,{onOk:this.hideMarketAppDetail,onCancel:this.hideMarketAppDetail,app:Y}),v&&_&&w.default.createElement(r.default,{title:(0,T.formatMessage)({id:"confirmModal.install.app.desc"}),className:I.default.TelescopicModal,visible:_,onOk:this.handleInstallBounced,onCancel:()=>{this.setState({installBounced:!1})},footer:w.default.createElement("div",null,w.default.createElement(p.default,{onClick:()=>{this.setState({installBounced:!1,is_deploy:!0})}},(0,T.formatMessage)({id:"button.cancel"})),w.default.createElement(p.default,{onClick:this.handleInstallBounced,type:"primary",style:{marginRight:"5px"},loading:t.effects["createApp/installAppPlugin"]},(0,T.formatMessage)({id:"button.install"})),w.default.createElement(o.default,{size:"small",onClick:this.renderSuccessOnChange,checked:$},(0,T.formatMessage)({id:"button.build_start"})))},_.describe&&w.default.createElement("p",{style:{background:"rgba(22, 184, 248, 0.1)",padding:"8px"}},_.describe),this.renderFormComponent()),ve&&ve.length>0&&g?w.default.createElement("div",null,w.default.createElement(H.default,{isAddMarket:this.props.isAddMarket,isSvg:!0,breadcrumbList:we,content:v&&y?"":Ee,tabList:ve,tabActiveKey:S,onTabChange:this.handleTabMaxChange,isFooter:!!v,action:w.default.createElement(p.default,{onClick:()=>{var e=this.props.dispatch;e(x.routerRedux.push("/team/".concat(j.default.getCurrTeamName(),"/region/").concat(j.default.getCurrRegionName(),"/myplugns")))},type:"default"},w.default.createElement(n.default,{type:"home"})," ",(0,T.formatMessage)({id:"global.fetchAccessText.plugin"}))},"localApplication"!==S&&!fe&&w.default.createElement(s.default,{message:w.default.createElement("div",null,(0,T.formatMessage)({id:"notification.market.hint.null_app5"}),w.default.createElement("a",{onClick:()=>{this.handleCertification(S)}},(0,T.formatMessage)({id:"notification.market.hint.null_app6"}))),type:"success",style:{margin:"-10px 0 15px 0"}}),S.indexOf("Helm-")>-1&&m?w.default.createElement("div",null,ie?Te:be):"localApplication"===S?w.default.createElement("div",{style:{marginBottom:!y&&v&&"Service"===v&&"40px"}},M?Te:this.handleTabs(xe,Ce)):w.default.createElement("div",null,O&&-1!==O?Te:w.default.createElement("div",null,w.default.createElement("div",{className:q.default.cardList,style:{paddingBottom:"20px",marginBottom:y?"0px":"40px"}},-1!==O&&Se,z&&w.default.createElement(s.default,{style:{textAlign:"center",marginBottom:16},message:z,type:"warning"})))),_e)):w.default.createElement("div",null,w.default.createElement(B.default,{title:(0,T.formatMessage)({id:"teamPlugin.install.title"}),titleSvg:F.default.getPageHeaderSvg("market",18),content:"\u5e94\u7528\u5e02\u573a\u5b89\u88c5\u662f\u90e8\u7f72\u63d2\u4ef6\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u652f\u6301\u901a\u8fc7\u672c\u5730\u7ec4\u4ef6\u5e93\u3001\u5f00\u6e90\u5e94\u7528\u5546\u5e97\u548cHelm\u5e94\u7528\u5546\u5e97\u7b49\u65b9\u5f0f\u4e00\u952e\u5b89\u88c5\u63d2\u4ef6\u3002",isAddMarket:this.props.isAddMarket,isSvg:!0,breadcrumbList:we,extraContent:v&&y?"":Ee,tabList:ve,keyword:!1,helmInfoSwitch:ce,marketInfoSwitch:ue,tabActiveKey:S,onTabChange:this.handleTabMaxChange,isFooter:!!v,action:w.default.createElement(p.default,{onClick:()=>{var e=this.props.dispatch;e(x.routerRedux.push("/team/".concat(j.default.getCurrTeamName(),"/region/").concat(j.default.getCurrRegionName(),"/myplugns")))},type:"default"},w.default.createElement(n.default,{type:"home"}),(0,T.formatMessage)({id:"global.fetchAccessText.plugin"}))},"localApplication"!==S&&!fe&&w.default.createElement(s.default,{message:w.default.createElement("div",null,(0,T.formatMessage)({id:"notification.market.hint.null_app5"}),w.default.createElement("a",{onClick:()=>{this.handleCertification(S)}},(0,T.formatMessage)({id:"notification.market.hint.null_app6"}))),type:"success",style:{margin:"-10px 0 15px 0"}}),S.indexOf("Helm-")>-1&&m&&ce&&ue?w.default.createElement("div",null,ie?Te:be):"localApplication"===S&&ce&&ue?w.default.createElement("div",{style:{marginBottom:!y&&v&&"Service"===v&&"40px"}},M?Te:this.handleTabs(xe,Ce)):ce&&ue?w.default.createElement("div",null,O&&-1!==O?Te:w.default.createElement("div",null,w.default.createElement("div",{className:q.default.cardList,style:{paddingBottom:"20px",marginBottom:y?"0px":"40px"}},-1!==O&&Se,z&&w.default.createElement(s.default,{style:{textAlign:"center",marginBottom:16},message:z,type:"warning"})))):w.default.createElement("div",null,Te),_e)))}},k=E))||k)||k);t.default=Q},fXYz:function(e,t,a){"use strict";var l=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV")),n=l(a("jehZ"));a("+BJd");var r=l(a("mr32"));a("+L6B");var o=l(a("2/Rp"));a("y8nQ");var p=l(a("Vl3Y"));a("OaEy");var d,u,c,h,m=l(a("2fM7")),g=a("MuoO"),f=i(a("q1tI")),v=a("LLXN"),y=(l(a("qCJ4")),l(a("QDog"))),_=l(a("e6Ls")),C=m.default.Option,S={labelCol:{span:7},wrapperCol:{span:17}},b=(d=(0,g.connect)(e=>{var t=e.global;return{groups:t.groups}},null,null,{withRef:!0}),u=p.default.create(),d(c=u((h=class extends f.PureComponent{constructor(e){super(e),this.onAddGroup=(()=>{this.setState({addGroup:!0})}),this.cancelAddGroup=(()=>{this.setState({addGroup:!1})}),this.handleAddGroup=(e=>{var t=this.props.form.setFieldsValue;t({group_id:e}),this.cancelAddGroup()}),this.handleChangeVersion=(e=>{var t=this.state.is_deploy,a=this.props,l=a.onChangeSelect,i=a.showCreate;if(e){var s={group_version:e};l(s,t)}else{var n={group_version:i.versions_info?i.versions_info[0].version:i.versions[0].app_version};l(n,t)}}),this.fetchGroup=(()=>{this.props.dispatch({type:"global/fetchGroups",payload:{team_name:y.default.getCurrTeamName()}})}),this.handleSubmit=(e=>{e.preventDefault();var t=this.state.is_deploy,a=this.props,l=a.form,i=a.onSubmit;l.validateFields((e,a)=>{!e&&i&&(i(a,t),this.setState({is_deploy:!0}))})}),this.renderSuccessOnChange=(()=>{this.setState({is_deploy:!this.state.is_deploy})}),this.state={addGroup:!1,is_deploy:!0}}componentDidMount(){this.handleChangeVersion()}render(){var e=this.props.form.getFieldDecorator,t=this.props,a=(t.groups,t.onCancel),l=t.showCreate,i=t.addAppLoading,d=t.disabled,u=t.btnStatus,c=(this.props.data,l&&l.versions_info&&l.versions_info.length>0&&l.versions_info),h=l&&l.versions&&l.versions.length>0&&l.versions;return f.default.createElement(s.default,{className:_.default.TelescopicModal,visible:l,onCancel:a,onOk:this.handleSubmit,title:(0,v.formatMessage)({id:"teamOther.CreateAppFromMarketForm.title"}),footer:[f.default.createElement("div",{style:{display:"flex",marginLeft:"120px"}},f.default.createElement(o.default,{onClick:a},(0,v.formatMessage)({id:"button.cancel"})),f.default.createElement("div",null,u&&"Installable"==u?f.default.createElement(o.default,{onClick:this.handleSubmit,type:"primary",style:{marginRight:"5px"},loading:i||d},(0,v.formatMessage)({id:"button.install"})):"AlreadyInstalled"==u?f.default.createElement(o.default,{type:"primary",style:{marginRight:"5px"},disabled:!0},(0,v.formatMessage)({id:"teamOther.CreateAppFromPlugin.been_installed"})):"Upgradeable"==u?f.default.createElement(o.default,{onClick:this.handleSubmit,type:"primary",style:{marginRight:"5px"},loading:i||d},(0,v.formatMessage)({id:"teamOther.CreateAppFromPlugin.upgrade"})):f.default.createElement(o.default,{onClick:this.handleSubmit,type:"primary",style:{marginRight:"5px"},loading:i||d},(0,v.formatMessage)({id:"button.install"}))))]},f.default.createElement(p.default,{onSubmit:this.handleOk,layout:"horizontal",hideRequiredMark:!0},f.default.createElement(p.default.Item,(0,n.default)({},S,{label:(0,v.formatMessage)({id:"teamOther.CreateAppFromMarketForm.install"})}),e("group_version",{initialValue:c?c[0].version:h?h[0].app_version:"",rules:[{required:!0,message:(0,v.formatMessage)({id:"teamOther.CreateAppFromMarketForm.setect"})}]})(f.default.createElement(m.default,{getPopupContainer:e=>e.parentNode,onChange:this.handleChangeVersion,style:{width:"220px"}},c?c.map((e,t)=>{return f.default.createElement(C,{key:t,value:e.version},e.version,f.default.createElement(r.default,{color:"blue",style:{marginLeft:"8px",lineHeight:"18px"}},e.arch))}):h&&h.map((e,t)=>{return f.default.createElement(C,{key:t,value:e.app_version},e.app_version,f.default.createElement(r.default,{color:"blue",style:{marginLeft:"8px",lineHeight:"18px"}},e.arch))}))))))}},c=h))||c)||c);t.default=b}}]);