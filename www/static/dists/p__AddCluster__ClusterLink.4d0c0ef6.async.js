(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{Zw3B:function(e,t,a){"use strict";var l=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("+L6B");var d=l(a("2/Rp"));a("jCWc");var i=l(a("kPKH"));a("5NDa");var n=l(a("5rEg"));a("14J3");var o=l(a("BMrR"));a("bP8k");var u=l(a("gFTJ"));a("fOrg");var c=l(a("+KLJ")),p=l(a("jehZ"));a("/xke");var f=l(a("TeRw")),m=l(a("p0pE"));a("y8nQ");var g,h,v,E,k=l(a("Vl3Y")),b=l(a("18gR")),I=a("MuoO"),x=a("7DNP"),y=r(a("q1tI")),C=l(a("AklW")),S=(g=(0,I.connect)(),h=k.default.create(),g(v=h((E=class extends y.PureComponent{constructor(e){super(e),this.createClusters=(()=>{var e,t=this.props,a=t.dispatch,l=t.eid,r=t.form,s=t.selectClusterID,d=t.selectProvider,i=this.state,n=i.configsYaml,o=i.task;switch(d){case"ack":e="\u4ece\u963f\u91cc\u4e91\u6258\u7ba1\u96c6\u7fa4\u5b89\u88c5\u5bf9\u63a5";break;case"tke":e="\u4ece\u817e\u8baf\u4e91\u6258\u7ba1\u96c6\u7fa4\u5b89\u88c5\u5bf9\u63a5";break;case"custom":e="\u4ece\u81ea\u5b9a\u4e49 Kubernetes \u96c6\u7fa4\u5bf9\u63a5";break;case"rke":e="\u63d0\u4f9b\u4e3b\u673a\u5b89\u88c5 Kubernetes \u96c6\u7fa4\u5e76\u5bf9\u63a5";break;default:e="\u81ea\u5efa\u96c6\u7fa4"}r.validateFields((t,r)=>{t||(this.setState({commitloading:!0}),a({type:"region/createEnterpriseCluster",payload:(0,m.default)({},r,{enterprise_id:l,desc:e,token:n,region_type:["custom"],provider:d,providerClusterID:s}),callback:e=>{e&&200===e._condition&&(f.default.success({message:"\u6dfb\u52a0\u6210\u529f"}),a(o?{type:"cloud/updateInitTaskStatus",payload:{enterprise_id:l,taskID:o.taskID,status:"complete"},callback:()=>{a(x.routerRedux.push("/enterprise/".concat(l,"/clusters")))},handleError:e=>{404==e.data.code?a(x.routerRedux.push("/enterprise/".concat(l,"/clusters"))):C.default.handleCloudAPIError(e),this.setState({commitloading:!1})}}:x.routerRedux.push("/enterprise/".concat(l,"/clusters"))))},handleError:e=>{C.default.handleCloudAPIError(e),this.setState({commitloading:!1})}}))})}),this.loadRegionConfig=(()=>{var e=this.props,t=e.dispatch,a=e.eid,l=e.selectClusterID,r=e.selectProvider;t({type:"cloud/loadRegionConfig",payload:{enterprise_id:a,clusterID:l,providerName:r},callback:e=>{e&&this.setState({configs:e.configs,configsYaml:e.configs_yaml,loading:!1})},handleError:e=>{C.default.handleCloudAPIError(e),this.setState({loading:!1})}})}),this.loadTask=(()=>{var e=this.props,t=e.dispatch,a=e.eid,l=e.selectClusterID,r=e.selectProvider;t({type:"cloud/loadInitRainbondTask",payload:{enterprise_id:a,clusterID:l,providerName:r},callback:e=>{e&&(this.setState({task:e}),this.loadRegionConfig())},handleError:e=>{e.data&&404===e.data.code?this.loadRegionConfig():(C.default.handleCloudAPIError(e),this.setState({loading:!1}))}})}),this.handleNewbieGuiding=(e=>{var t=e.prevStep,a=e.nextStep,l=e.handleClick,r=void 0===l?()=>{}:l;return y.default.createElement(b.default,(0,p.default)({},e,{totals:14,handlePrev:()=>{t&&this.handleGuideStep(t)},handleClose:()=>{this.handleGuideStep("close")},handleNext:()=>{a&&(r(),this.handleGuideStep(a))}}))}),this.handleGuideStep=(e=>{this.setState({guideStep:e})}),this.state={loading:!0,configs:{},guideStep:13,task:null}}componentDidMount(){this.loadTask()}render(){var e,t=this.props,a=t.selectProvider,l=t.form,r=this.state,p=r.configs,f=r.loading,m=r.commitloading,g=r.guideStep,h=l.getFieldDecorator;switch(a){case"ack":e="\u963f\u91cc\u4e91\u6258\u7ba1\u96c6\u7fa4";break;case"tke":e="\u817e\u8baf\u4e91\u6258\u7ba1\u96c6\u7fa4";break;case"custom":e="\u81ea\u5b9a\u4e49\u5bf9\u63a5\u96c6\u7fa4";break;case"rke":e="\u81ea\u5efa\u96c6\u7fa4";break;default:e="\u81ea\u5efa\u96c6\u7fa4"}var v={position:"relative",zIndex:1e3,padding:"0 16px",margin:"0 -16px",background:"#fff"};return y.default.createElement(k.default,null,y.default.createElement(s.default,{loading:f,bordered:!1,style:{padding:"0 16px"}},y.default.createElement(o.default,null,!p.apiAddress&&y.default.createElement(c.default,{message:"\u672a\u6b63\u5e38\u83b7\u53d6\u5230\u96c6\u7fa4\u7684\u521d\u59cb\u5316\u72b6\u6001\uff0c\u4e0d\u80fd\u8fdb\u884c\u5bf9\u63a5",type:"error"}),p.apiAddress&&y.default.createElement(u.default,null,y.default.createElement(u.default.Item,{label:"API\u901a\u4fe1\u5730\u5740"},y.default.createElement("div",{style:{display:"flex",alignItems:"center"}},p.apiAddress,y.default.createElement(c.default,{style:{marginLeft:"20px"},message:"\u8bf7\u786e\u4fdd\u8be5IP\u5730\u5740\u76848443\u7aef\u53e3\uff0c6060\u7aef\u53e3\u5bf9\u5916\u5f00\u653e",type:"warning"}))))),y.default.createElement(o.default,{style:{marginTop:"32px"}},y.default.createElement("h4",null,"\u96c6\u7fa4\u8bbe\u7f6e")),y.default.createElement(o.default,{style:13===g?v:{}},y.default.createElement(i.default,{span:6,style:{paddingRight:"16px"}},y.default.createElement(k.default.Item,{label:"\u96c6\u7fa4ID"},h("region_name",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8fa8\u8bc6\u5ea6\u9ad8\u7684\u96c6\u7fa4ID\uff0c\u4e0d\u53ef\u4fee\u6539"},{pattern:/^[a-z0-9A-Z-_]+$/,message:"\u53ea\u652f\u6301\u5b57\u6bcd\u3001\u6570\u5b57\u548c-_\u7ec4\u5408"}]})(y.default.createElement(n.default,{placeholder:"\u8bf7\u586b\u5199\u8fa8\u8bc6\u5ea6\u9ad8\u7684\u96c6\u7fa4ID\uff0c\u4e0d\u53ef\u4fee\u6539"})))),y.default.createElement(i.default,{span:6},y.default.createElement(k.default.Item,{label:"\u96c6\u7fa4\u540d\u79f0"},h("region_alias",{initialValue:e,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u96c6\u7fa4\u540d\u79f0!"},{max:24,message:"\u6700\u5927\u957f\u5ea624\u4f4d"}]})(y.default.createElement(n.default,{placeholder:"\u8bf7\u586b\u5199\u96c6\u7fa4\u540d\u79f0"}))))),13===g&&this.handleNewbieGuiding({tit:"\u96c6\u7fa4\u670d\u52a1\u5df2\u7ecf\u5b89\u88c5\u6210\u529f\u4e86",desc:"\u8bf7\u8f93\u5165\u96c6\u7fa4\u8bbe\u7f6e\u4fe1\u606f",send:!1,configName:"clusterDocking",showSvg:!1,showArrow:!0,nextStep:14}),y.default.createElement(o.default,null,y.default.createElement(i.default,{style:{textAlign:"center",marginTop:"32px"},span:24},y.default.createElement(d.default,{loading:m,onClick:this.createClusters,disabled:!p.apiAddress,type:"primary"},"\u5bf9\u63a5"),14===g&&this.handleNewbieGuiding({tit:"\u96c6\u7fa4\u8bbe\u7f6e\u914d\u7f6e\u5b8c\u6210\u540e\u8bf7\u5f00\u59cb\u5bf9\u63a5",btnText:"\u5bf9\u63a5",send:!0,configName:"clusterDocking",nextStep:15,handleClick:()=>{p.apiAddress&&this.createClusters()},conPosition:{left:"50%",bottom:"-138px"},svgPosition:{left:"50%",marginTop:"-11px"}})))))}},v=E))||v)||v);t.default=S},sExd:function(e,t,a){"use strict";var l=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var s=l(a("bx4M"));a("14J3");var d=l(a("BMrR"));a("y8nQ");var i=l(a("Vl3Y"));a("FJo9");var n,o,u,c,p=l(a("L41K")),f=a("MuoO"),m=a("7DNP"),g=r(a("q1tI")),h=l(a("Zw3B")),v=l(a("XZXw")),E=l(a("+iC2")),k=p.default.Step,b=(n=i.default.create(),o=(0,f.connect)(e=>{var t=e.user,a=e.list,l=e.loading,r=e.global,s=e.index;return{user:t.currentUser,list:a,loading:l.models.list,rainbondInfo:r.rainbondInfo,enterprise:r.enterprise,isRegist:r.isRegist,oauthLongin:l.effects["global/creatOauth"],overviewInfo:s.overviewInfo}}),n(u=o((c=class extends g.PureComponent{constructor(e){super(e),this.loadSteps=(()=>{var e=[{title:"\u9009\u62e9\u4f9b\u5e94\u5546"},{title:"\u9009\u62e9(\u521b\u5efa)\u5e73\u53f0\u96c6\u7fa4"},{title:"\u521d\u59cb\u5316\u5e73\u53f0\u96c6\u7fa4"},{title:"\u5b8c\u6210\u5bf9\u63a5"}];return e});var t=this.props.user,a=E.default.isCompanyAdmin(t);this.state={adminer:a}}componentWillMount(){var e=this.state.adminer,t=this.props.dispatch;e||t(m.routerRedux.push("/"))}componentDidMount(){}render(){var e=this.props.match.params,t=e.eid,a=e.provider,l=e.clusterID;return g.default.createElement(v.default,{title:"\u6dfb\u52a0\u96c6\u7fa4",content:"\u96c6\u7fa4\u662f\u8d44\u6e90\u7684\u96c6\u5408\uff0c\u4ee5Kubernetes\u96c6\u7fa4\u4e3a\u57fa\u7840\uff0c\u90e8\u7f72\u5e73\u53f0Region\u670d\u52a1\u5373\u53ef\u6210\u4e3a\u5e73\u53f0\u96c6\u7fa4\u8d44\u6e90\u3002"},g.default.createElement(d.default,{style:{marginBottom:"16px"}},g.default.createElement(p.default,{current:3},this.loadSteps().map(e=>g.default.createElement(k,{key:e.title,title:e.title})))),g.default.createElement(s.default,null,g.default.createElement(d.default,{style:{marginBottom:"16px"}},g.default.createElement(h.default,{eid:t,selectProvider:a,selectClusterID:l}))))}},u=c))||u)||u);t.default=b}}]);