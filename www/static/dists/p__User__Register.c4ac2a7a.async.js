(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[87],{cSxo:function(e,t,a){"use strict";var s=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var r=s(a("BMrR"));a("+L6B");var o=s(a("2/Rp"));a("jCWc");var i=s(a("kPKH"));a("5NDa");var l=s(a("5rEg"));a("y8nQ");var c,d,u,m,p=s(a("Vl3Y")),g=a("MuoO"),f=a("7DNP"),h=n(a("q1tI")),v=(a("LLXN"),s(a("nyIC")),s(a("QDog"))),b=s(a("mWxT")),S=s(a("5WY0")),w=p.default.Item,C=(c=(0,g.connect)(e=>{var t=e.user,a=e.loading,s=e.global;return{register:t.register,rainbondInfo:s.rainbondInfo,isRegist:s.isRegist,submitting:a.effects["user/register"],thirdsubmitting:a.effects["user/thirdRegister"]}}),d=p.default.create(),c(u=d((m=class extends h.Component{constructor(){super(...arguments),this.state={confirmDirty:!1,visible:!1,time:Date.now(),countdown:0},this.handleSubmit=(e=>{e.preventDefault();var t=this.props,a=t.form,s=t.onSubmit;a.validateFields({force:!0},(e,t)=>{e||(v.default.removeCookie(),s&&s(t))})}),this.changeTime=(()=>{this.setState({time:Date.now()})}),this.getRedirectParams=(()=>{var e=window.localStorage.getItem("redirect"),t=encodeURIComponent(e);return e&&e.includes("invite")?"/user/login?redirect="+t:"/user/login"}),this.handleSendCode=(()=>{var e=this.props.form;e.validateFields(["phone"],{force:!0},(e,t)=>{if(!e){var a=this.props.dispatch;a({type:"user/getSmsCode",payload:{phone:t.phone,purpose:"register"},callback:()=>{this.setState({countdown:60}),this.interval=setInterval(()=>{var e=this.state.countdown;e<=1&&clearInterval(this.interval),this.setState({countdown:e-1})},1e3)}})}})})}componentDidMount(){v.default.removeCookie()}componentWillUnmount(){clearInterval(this.interval)}render(){var e=this.props,t=e.form,a=e.submitting,s=e.thirdsubmitting,n=e.type,c=(e.user_info,e.rainbondInfo),d={labelCol:{xs:{span:24},sm:{span:0}},wrapperCol:{xs:{span:24},sm:{span:24}}},u=t.getFieldDecorator,m=!b.default.fetchIsFirstRegist(c);this.state.time;return h.default.createElement(p.default,{onSubmit:this.handleSubmit},h.default.createElement(w,d,u("nick_name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"},{min:3,message:"\u6700\u5c0f\u957f\u5ea63\u4f4d"},{max:24,message:"\u6700\u5927\u957f\u5ea624\u4f4d"},{pattern:/^[a-z](?:[a-z0-9]|-(?=[a-z0-9]))*$/,message:"\u53ea\u652f\u6301\u5c0f\u5199\u5b57\u6bcd\u3001\u6570\u5b57\u548c-\u7ec4\u5408"}]})(h.default.createElement(l.default,{autoComplete:"off",size:"large",placeholder:"\u7528\u6237\u540d"}))),h.default.createElement(w,null,u("phone",{rules:[{required:!0,message:"\u624b\u673a\u53f7"},{pattern:/^1[3-9]\d{9}$/,message:"\u624b\u673a\u53f7\u683c\u5f0f\u9519\u8bef\uff01"}]})(h.default.createElement(l.default,{autoComplete:"off",size:"large",placeholder:"\u624b\u673a\u53f7"}))),h.default.createElement(w,null,h.default.createElement(r.default,{gutter:8},h.default.createElement(i.default,{span:16},u("code",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"},{len:6,message:"\u8bf7\u8f93\u51656\u4f4d\u9a8c\u8bc1\u7801"}]})(h.default.createElement(l.default,{placeholder:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"}))),h.default.createElement(i.default,{span:8},h.default.createElement(o.default,{disabled:this.state.countdown>0,onClick:this.handleSendCode,style:{width:"100%",marginTop:"-16px",color:"#000"}},this.state.countdown>0?"".concat(this.state.countdown,"s"):"\u83b7\u53d6\u9a8c\u8bc1\u7801")))),h.default.createElement(w,null,h.default.createElement(o.default,{size:"large",loading:"register"===n?a:s,className:S.default.submit,style:{width:"100%"},type:"primary",htmlType:"submit"},m?"\u7ba1\u7406\u5458\u6ce8\u518c":"register"===n?"\u6ce8\u518c":"\u6ce8\u518c\u5e76\u7ed1\u5b9a"),!m&&"register"===n&&h.default.createElement(f.Link,{className:S.default.login,to:this.getRedirectParams()},"\u4f7f\u7528\u5df2\u6709\u8d26\u6237\u767b\u5f55")),m&&h.default.createElement(r.default,null,h.default.createElement(i.default,{span:24,style:{fontSize:12,marginTop:-12,color:"#666666"}},"\u8bf7\u6ce8\u610f\uff1a\u6ce8\u518c\u4f7f\u7528\u5373\u540c\u610f\u4ea7\u54c1\u53d1\u884c\u7248\u7528\u6237\u8bb8\u53ef\u534f\u8bae\u3002")))}},u=m))||u)||u);t.default=C},cq3J:function(e,t,a){"use strict";var s=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o,i,l=s(a("p0pE")),c=a("MuoO"),d=a("7DNP"),u=n(a("q1tI")),m=a("LLXN"),p=s(a("QDog")),g=s(a("mWxT")),f=(s(a("Trn4")),s(a("5WY0"))),h=s(a("dYZ0")),v=s(a("cSxo")),b=(r=(0,c.connect)(e=>{var t=e.user,a=e.global;return{register:t.register,rainbondInfo:a.rainbondInfo,isRegist:a.isRegist}}),r((i=class extends u.Component{constructor(){super(...arguments),this.state={},this.handleSubmit=(e=>{var t=this.props.rainbondInfo,a=!g.default.fetchIsFirstRegist(t),s=t&&t.version&&t.version.enable?t.version.value:"",n=this.props.dispatch;n({type:"user/register",payload:(0,l.default)({},e),complete:t=>{a&&p.default.putRegistLog(Object.assign({enterprise_alias:e.enter_name,version:s},t))}})}),this.handleUserSource=(e=>{var t=this.props.dispatch;t({type:"global/fetchUserSource",payload:{content:e},callback:e=>{window.localStorage.removeItem("link")}})}),this.handleSmsSubmit=(e=>{var t=this.props.dispatch,a=window.localStorage.getItem("link"),s=window.localStorage.getItem("redirect"),n="";if(a)n="\n        ".concat((0,m.formatMessage)({id:"login.registerComponent.smslink"}),":").concat(a,"\n        ").concat((0,m.formatMessage)({id:"login.registerComponent.smsusers"}),":").concat(e.nick_name,"\n        ").concat((0,m.formatMessage)({id:"login.registerComponent.smsphone"}),":").concat(e.phone,"\n      ");else if(s&&s.includes("app_name")){var r=s.split("#")[1],o=r.split("?")[1],i=new URLSearchParams(o),l=i.get("app_name");n="\n        ".concat((0,m.formatMessage)({id:"login.registerComponent.smslink"}),":").concat(l,"\n        ").concat((0,m.formatMessage)({id:"login.registerComponent.smsusers"}),":").concat(e.nick_name,"\n        ").concat((0,m.formatMessage)({id:"login.registerComponent.smsphone"}),":").concat(e.phone,"\n      ")}else n="\n        ".concat((0,m.formatMessage)({id:"login.registerComponent.smslink"}),":","cloud","\n        ").concat((0,m.formatMessage)({id:"login.registerComponent.smsusers"}),":").concat(e.nick_name,"\n        ").concat((0,m.formatMessage)({id:"login.registerComponent.smsphone"}),":").concat(e.phone,"\n      ");t({type:"user/smsRegister",payload:e,complete:e=>{console.log("Register Success"),n&&this.handleUserSource(n)}})})}render(){var e=this.props,t=e.isRegist,a=e.dispatch,s=e.rainbondInfo;if(!t)return a(d.routerRedux.replace("/user/login")),null;var n=!g.default.fetchIsFirstRegist(s),r=(null===s||void 0===s?void 0:s.is_saas)||!1;return u.default.createElement("div",{className:f.default.main},(n||!r)&&u.default.createElement(h.default,{onSubmit:this.handleSubmit,type:"register"}),r&&!n&&u.default.createElement(v.default,{onSubmit:this.handleSmsSubmit,type:"register"}))}},o=i))||o);t.default=b}}]);