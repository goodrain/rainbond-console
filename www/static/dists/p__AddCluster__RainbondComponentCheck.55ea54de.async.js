(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[23],{"3//m":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("T2oS");var o,r,d,i=l(a("W9HT")),u=l(a("PWDA")),c=l(a("AklW")),m=a("MuoO"),p=n(a("q1tI")),f=a("LLXN"),g=l(a("e6Ls")),h=l(a("A0Wr")),C=(o=(0,m.connect)(),o((d=class extends p.PureComponent{constructor(e){super(e),this.getLineHtml=((e,t)=>{return p.default.createElement("div",{className:h.default.logline,key:e},p.default.createElement("a",null,e),p.default.createElement(u.default,null,t))}),this.queryCreateLog=(()=>{var e=this.props,t=e.dispatch,a=e.eid,l=e.selectProvider,n=e.clusterID;t({type:"cloud/queryCreateLog",payload:{enterprise_id:a,provider_name:l,clusterID:n},callback:e=>{if(e){var t=e.content.split("\n");this.setState({createLog:t,showCreateLog:!1})}},handleError:e=>{c.default.handleCloudAPIError(e)}})}),this.state={createLog:"",showCreateLog:!0}}componentDidMount(){this.queryCreateLog()}render(){var e=this.props,t=e.title,a=e.onCancel,l=this.state,n=l.createLog,o=l.showCreateLog;return p.default.createElement(s.default,{title:t||p.default.createElement(f.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.creat_log"}),visible:!0,className:g.default.TelescopicModal,onCancel:a,onOk:this.onOk,width:1e3,maskClosable:!1,bodyStyle:{background:"#000"},footer:null},p.default.createElement("div",{className:h.default.cmd},o?p.default.createElement("div",{style:{textAlign:"center"}},p.default.createElement(i.default,{spinning:!0,className:h.default.customSpin})):n&&n.length>0&&n.map((e,t)=>{return this.getLineHtml(t+1,e)})))}},r=d))||r);t.default=C},"4AJc":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("5Dmo");var s=l(a("3S7+"));a("cWXX");var o=l(a("/ezw"));a("IzEo");var r=l(a("bx4M"));a("jCWc");var d=l(a("kPKH"));a("bP8k");var i=l(a("gFTJ"));a("14J3");var u=l(a("BMrR"));a("+L6B");var c=l(a("2/Rp"));a("y8nQ");var m=l(a("Vl3Y")),p=l(a("qIgq"));a("/xke");var f=l(a("TeRw"));a("OaEy");var g=l(a("2fM7"));a("fu2T");var h,C,E,v=l(a("gK9i")),y=a("MuoO"),_=l(a("wd/R")),b=n(a("q1tI")),I=a("LLXN"),S=l(a("q76B")),M=l(a("PWDA")),N=l(a("qkmd")),w=v.default.Panel,T=g.default.Option,k=(h=(0,y.connect)(e=>{var t=e.global,a=e.region;return{rainbondInfo:t.rainbondInfo,enterprise:t.enterprise,cluster_info_add_cluster:a.cluster_info_add_cluster}}),h((E=class extends b.PureComponent{constructor(e){super(e),this.closeTimer=(()=>{this.timer&&clearInterval(this.timer)}),this.startLogStream=((e,t)=>{this.logEventSource&&this.logEventSource.close(),this.logMessages=[],this.logUpdateTimer&&clearTimeout(this.logUpdateTimer);var a=this.props.cluster_info_add_cluster.cluster_id,l="/console/rb_component_logs_sse?cluster_id=".concat(a,"&pod_name=").concat(e,"&container_name=").concat(t,"&tail_lines=100");this.setState({logLoading:!0,logStarted:!0,selectedContainer:{podName:e,containerName:t},containerLog:[]}),this.logEventSource=new EventSource(l,{withCredentials:!0});var n=1e3;this.logEventSource.onmessage=(e=>{var t=e.data;if(t&&t.trim()){var a;try{var l=JSON.parse(t);a={timestamp:l.timestamp,data:l.data,original:t}}catch(e){a={timestamp:Date.now()/1e3,data:t,original:t}}this.logMessages||(this.logMessages=[]),this.logMessages.push(a),this.logMessages.length>=1?this.updateLogDisplay(n):(this.logUpdateTimer&&clearTimeout(this.logUpdateTimer),this.logUpdateTimer=setTimeout(()=>{this.logMessages&&this.logMessages.length>0&&this.updateLogDisplay(n)},1e3))}}),this.logEventSource.onerror=(e=>{console.error("SSE error:",e),this.setState({logLoading:!1,logStarted:!1}),this.logEventSource.close()})}),this.updateLogDisplay=(e=>{this.logMessages&&0!==this.logMessages.length&&(this.setState(t=>{var a=[...t.containerLog,...this.logMessages],l=a.length>e?a.slice(-e):a;return{logLoading:!1,containerLog:l}},()=>{this.scrollLogToBottom()}),this.logMessages=[],this.logUpdateTimer&&(clearTimeout(this.logUpdateTimer),this.logUpdateTimer=null))}),this.scrollLogToBottom=(()=>{this.logContainerRef&&(this.logContainerRef.scrollTop=this.logContainerRef.scrollHeight)}),this.formatTimestamp=(e=>{if(!e)return"";var t=new Date(1e3*e);return t.toISOString().replace("T"," ").substring(0,19)}),this.stopLogStream=(()=>{this.logEventSource&&(this.logEventSource.close(),this.logEventSource=null),this.setState({logStarted:!1,logLoading:!1})}),this.handleTimers=((e,t,a)=>{this[e]=setTimeout(()=>{t()},a)}),this.handlePodeInfo=(e=>{var t=0;return Object.keys(e||{}).map(a=>{var l=e[a]||[],n=l.every(e=>"Running"===e.status);n&&t++}),t}),this.fetchRainbondComponents=(e=>{var t=this.props,a=(t.eid,t.dispatch);e&&this.setState({componentsListLoading:!0}),a({type:"region/installClusterAllPodinfo",callback:e=>{e&&200===e.status_code&&this.setState({componentList:e.response_data.data.bean,componentsListLoading:!1,runningPodNum:this.handlePodeInfo(e.response_data.data.bean)},()=>{this.handleTimers("timer",()=>{this.fetchRainbondComponents()},2e3)})}})}),this.back=(()=>{this.setState({showDetails:!1})}),this.handleStateName=(e=>{var t=e&&e.toLowerCase(),a={failed:N.default.failedState,running:N.default.successState,pending:N.default.failedState,warning:N.default.warningState,error:N.default.failedState,crashloopbackoff:N.default.failedState,imagepullbackoff:N.default.failedState,containercreating:N.default.warningState,terminating:N.default.failedState,unexist:N.default.failedState,unknown:N.default.failedState};return a[t]||N.default.successState}),this.fetchPodDetails=(e=>{var t=this.props.dispatch;t({type:"region/installClusterPodinfo",payload:{pod_name:e},callback:e=>{e&&200==e.status_code&&this.setState({componentInfo:e.response_data.data.bean,showDetails:!0},()=>{this.autoSelectFirstContainer()})}})}),this.autoSelectFirstContainer=(()=>{var e,t=this.state.componentInfo,a=(null===t||void 0===t?void 0:null===(e=t.pod_status)||void 0===e?void 0:e.containers)||[];if(a.length>0){var l,n=a[0],s=null===t||void 0===t?void 0:null===(l=t.pod_status)||void 0===l?void 0:l.pod_name,o=n.container_name;this.startLogStream(s,o)}}),this.unInstallCluster=(()=>{var e=this.props,t=e.dispatch,a=e.preStep;this.setState({unInstallLoading:!0}),t({type:"region/unInstallCluster",callback:e=>{this.setState({unInstallLoading:!1}),f.default.success({message:(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.unInstallSuccess"})}),a&&a()}})}),this.renderLogContent=(()=>{var e,t,a,l=this.state.componentInfo,n=this.state,s=n.containerLog,o=n.logStarted,r=n.logLoading,d=n.selectedContainer,i=(null===l||void 0===l?void 0:null===(e=l.pod_status)||void 0===e?void 0:e.containers)||[];return b.default.createElement("div",null,b.default.createElement(m.default,{layout:"inline",className:N.default.logControls},b.default.createElement(m.default.Item,{label:(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.selectContainer"})},b.default.createElement(g.default,{style:{width:200},placeholder:(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.selectContainerPlaceholder"}),onChange:e=>{var t=e.split("|"),a=(0,p.default)(t,2),l=a[0],n=a[1];this.startLogStream(l,n)},value:d?"".concat(d.podName,"|").concat(d.containerName):i.length>0?"".concat(null===l||void 0===l?void 0:null===(t=l.pod_status)||void 0===t?void 0:t.pod_name,"|").concat(i[0].container_name):void 0},i.map((e,t)=>{var a;return b.default.createElement(T,{key:t,value:"".concat(null===l||void 0===l?void 0:null===(a=l.pod_status)||void 0===a?void 0:a.pod_name,"|").concat(e.container_name)},e.container_name)}))),b.default.createElement(m.default.Item,null,o?b.default.createElement(c.default,{onClick:this.stopLogStream,type:"danger"},(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.stopLog"})):b.default.createElement(c.default,{onClick:()=>{if(d)this.startLogStream(d.podName,d.containerName);else if(i.length>0){var e;this.startLogStream(null===l||void 0===l?void 0:null===(e=l.pod_status)||void 0===e?void 0:e.pod_name,i[0].container_name)}},type:"primary",disabled:0===i.length},(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.restartLog"})))),b.default.createElement("div",{className:N.default.logStats},(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.logTotal"}),": ",s.length," ",(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.logCount"}),(d||i.length>0)&&b.default.createElement("span",{style:{marginLeft:16}},(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.currentContainer"}),": ",(null===d||void 0===d?void 0:d.containerName)||(null===(a=i[0])||void 0===a?void 0:a.container_name)||(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.unknown"}))),b.default.createElement("div",{ref:e=>{this.logContainerRef=e},className:N.default.logContainer},r&&b.default.createElement("div",{style:{color:"#1890ff"}},(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.loadingLog"})),!o&&!r&&0===s.length&&b.default.createElement("div",{style:{color:"#666"}},(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.autoConnecting"})),s.map((e,t)=>b.default.createElement("div",{key:t,className:N.default.logLine},b.default.createElement("span",{className:N.default.lineNumber},t+1),b.default.createElement("div",{className:N.default.logContent},b.default.createElement(M.default,null,e.data||e.original||e))))))}),this.timer=null,this.state={componentInfo:!1,componentsListLoading:!0,componentList:[],showDetails:!1,runningPodNum:0,showUnInstallModal:!1,unInstallLoading:!1,containerLog:[],logStarted:!1,logLoading:!1,selectedContainer:null}}componentDidMount(){this.fetchRainbondComponents(!0)}componentWillUnmount(){this.closeTimer(),this.eventSources&&this.eventSources.close(),this.logEventSource&&this.logEventSource.close(),this.logUpdateTimer&&clearTimeout(this.logUpdateTimer),this.logMessages=null}render(){var e,t,a,l,n,m,p,f,g,h,C,E=this.props.completeInit,y=this.state,M=y.componentInfo,T=(y.componentsLoading,y.componentList),k=y.showDetails,L=y.componentsListLoading,P=y.runningPodNum,x=y.showUnInstallModal,D=y.unInstallLoading;return b.default.createElement(b.default.Fragment,null,k?b.default.createElement(r.default,{title:(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.comInfo"}),className:N.default.podInfo},b.default.createElement(u.default,null,b.default.createElement(c.default,{type:"dashed",icon:"arrow-left",onClick:this.back},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.back"}))),b.default.createElement("div",{className:N.default.podStatus},b.default.createElement("p",null,"Pod: ",b.default.createElement("span",null,(null===M||void 0===M?void 0:null===(e=M.pod_status)||void 0===e?void 0:e.pod_name)||"-")),b.default.createElement("span",{className:this.handleStateName(null===M||void 0===M?void 0:null===(t=M.pod_status)||void 0===t?void 0:t.status)},null===M||void 0===M?void 0:null===(a=M.pod_status)||void 0===a?void 0:a.status)),b.default.createElement(i.default,{bordered:!0},b.default.createElement(i.default.Item,{label:(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.namespace"})},null===M||void 0===M?void 0:null===(l=M.pod_status)||void 0===l?void 0:l.namespace," "),b.default.createElement(i.default.Item,{label:"PodIP"},null===M||void 0===M?void 0:null===(n=M.pod_status)||void 0===n?void 0:n.pod_ip),b.default.createElement(i.default.Item,{label:"Node"},null===M||void 0===M?void 0:null===(m=M.pod_status)||void 0===m?void 0:m.node_name),b.default.createElement(i.default.Item,{label:"HostIP"},null===M||void 0===M?void 0:null===(p=M.pod_status)||void 0===p?void 0:p.host_ip),b.default.createElement(i.default.Item,{label:(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.greatTime"})},(0,_.default)(null===M||void 0===M?void 0:null===(f=M.pod_status)||void 0===f?void 0:f.start_time).format("YYYY-MM-DD HH:mm:ss"))),b.default.createElement(v.default,{defaultActiveKey:["1","2","3"],className:N.default.customCollapse},(null===M||void 0===M?void 0:null===(g=M.pod_status)||void 0===g?void 0:g.containers)&&(null===M||void 0===M?void 0:null===(h=M.pod_status)||void 0===h?void 0:h.containers.length)>0&&b.default.createElement(w,{header:b.default.createElement("div",{className:N.default.panelBox},b.default.createElement("div",null,b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.ClusterComponents.container"})),b.default.createElement("div",null,b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.ClusterComponents.Container_pod"}))),key:"1"},b.default.createElement(u.default,{className:N.default.customCollapseTable},b.default.createElement(d.default,{span:3},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.status"})),b.default.createElement(d.default,{span:3},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.bame"})),b.default.createElement(d.default,{span:14},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.img"})),b.default.createElement(d.default,{span:4},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.RestartNum"}))),null===M||void 0===M?void 0:null===(C=M.pod_status)||void 0===C?void 0:C.containers.map((e,t)=>{return b.default.createElement(u.default,{className:N.default.customCollapseDetails,key:t},b.default.createElement(d.default,{span:3},b.default.createElement("span",{className:this.handleStateName(e.status)},e.status)),b.default.createElement(d.default,{span:3,className:N.default.podname},e.container_name),b.default.createElement(d.default,{span:14},e.image),b.default.createElement(d.default,{span:4},e.restart_count))})),b.default.createElement(w,{header:b.default.createElement("div",{className:N.default.panelBox},b.default.createElement("div",null,(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.containerLog"})),b.default.createElement("div",null,(0,I.formatMessage)({id:"enterpriseColony.ClusterComponents.containerLogDesc"}))),key:"2"},this.renderLogContent()),(null===M||void 0===M?void 0:M.events)&&(null===M||void 0===M?void 0:M.events.length)>0&&b.default.createElement(w,{header:b.default.createElement("div",{className:N.default.panelBox},b.default.createElement("div",null,b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.ClusterComponents.event"})),b.default.createElement("div",null,b.default.createElement(I.FormattedMessage,{id:"enterpriseColony.ClusterComponents.pod"}))),key:"3"},b.default.createElement(u.default,{className:N.default.customCollapseTable},b.default.createElement(d.default,{span:3},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.type"})),b.default.createElement(d.default,{span:3},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.reason"})),b.default.createElement(d.default,{span:14},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.info"})),b.default.createElement(d.default,{span:4},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.lastUpdata"}))),null===M||void 0===M?void 0:M.events.map((e,t)=>{return b.default.createElement(u.default,{className:N.default.customCollapseDetails,key:t+"events"},b.default.createElement(d.default,{span:3},b.default.createElement("span",{className:this.handleStateName(null===e||void 0===e?void 0:e.event_type)},null===e||void 0===e?void 0:e.event_type)),b.default.createElement(d.default,{span:3},null===e||void 0===e?void 0:e.reason),b.default.createElement(d.default,{span:14},null===e||void 0===e?void 0:e.message),b.default.createElement(d.default,{span:4},(0,_.default)(null===e||void 0===e?void 0:e.last_timestamp).format("YYYY-MM-DD HH:mm:ss")))})))):b.default.createElement(r.default,{title:"\u96c6\u7fa4\u7ec4\u4ef6(".concat(P+"/"+Object.keys(T).length,")"),className:N.default.tableInfo},b.default.createElement(u.default,null,b.default.createElement(d.default,{span:4},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.status"})),b.default.createElement(d.default,{span:6},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.bame"})),b.default.createElement(d.default,{span:14},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.img"}))),L?b.default.createElement(o.default,{active:!0,rows:10}):b.default.createElement(b.default.Fragment,null,Object.keys(T).map((e,t)=>{return b.default.createElement("div",{className:N.default.pod_Info},b.default.createElement("p",null,e),T[e]&&T[e].length>0&&T[e].map((t,a)=>{return b.default.createElement(u.default,{key:a,className:N.default.details,style:{borderBottom:a==T[e].length-1?"0":"1px solid #e8e8e8"},onClick:()=>this.fetchPodDetails(t.pod_name)},b.default.createElement(d.default,{span:4},b.default.createElement("span",{className:this.handleStateName(t.status)},t.status)),b.default.createElement(d.default,{span:6},t.pod_name||(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.noName"})),b.default.createElement(d.default,{span:14},b.default.createElement("div",null,""==t.image?b.default.createElement("p",null,t.image_status||(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.noImg"})):b.default.createElement("p",null,t.image),b.default.createElement("p",null,(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.greatTimeText"}),(0,_.default)(null===t||void 0===t?void 0:t.start_time).format("YYYY-MM-DD HH:mm:ss")||"-"," ",(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.RestartNumText"}),t.restarts||0))))}))})),b.default.createElement("div",{style:{background:"#fff",padding:"20px",textAlign:"right",position:"fixed",bottom:0,left:0,right:0,zIndex:2,borderTop:"1px solid #e8e8e8"}},b.default.createElement("div",{className:N.default.ButtonBox},b.default.createElement(c.default,{type:"danger",onClick:()=>{this.setState({showUnInstallModal:!0})},style:{marginRight:24}},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.unInstall"})),b.default.createElement(s.default,{title:P!==Object.keys(T).length&&(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.podRunning"})},b.default.createElement(c.default,{disabled:P!==Object.keys(T).length,onClick:()=>E&&E(),type:"primary"},(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.next"}))),x&&b.default.createElement(S.default,{onOk:this.unInstallCluster,title:(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.unInstallCluster"}),desc:(0,I.formatMessage)({id:"enterpriseColony.newHostInstall.node.unInstallIng"}),onCancel:()=>{this.setState({showUnInstallModal:!1})},loading:D})))))}},C=E))||C),L=k;t.default=L},A0Wr:function(e,t,a){e.exports={nameID:"nameID___1QFa8",icon:"icon___1PBDq",iconm:"iconm___2cbra",cmd:"cmd___1oPsr",logline:"logline___2wsZy",customSpin:"customSpin___1EvNu"}},LWWM:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var s=l(a("BMrR"));a("jCWc");var o=l(a("kPKH"));a("Pwec");var r=l(a("CtXQ"));a("fu2T");var d,i,u,c=l(a("gK9i")),m=a("MuoO"),p=n(a("q1tI")),f=l(a("wd/R")),g=l(a("QDog")),h=a("LLXN"),C=l(a("ALo4")),E=l(a("sVIN")),v=c.default.Panel,y=(d=(0,m.connect)(),d((u=class extends p.PureComponent{constructor(e){super(e),this.fetchClusterStatus=(()=>{var e=this.props,t=e.dispatch,a=e.cluster_id,l=e.enterprise_id;t({type:"region/fetchClusterStatus",payload:{enterprise_id:l,clusterID:a},callback:e=>{this.is_mounted?(e&&e.response_data&&200===e.response_data.code&&this.setState({clusterStateEle:this.handleClusterState(),isShowContainer:!0,nodeList:e.response_data.nodes,podsList:e.response_data.pods}),this.timerClick=setInterval(()=>{clearInterval(this.timerClick),this.fetchClusterStatus()},5e3)):clearInterval(this.timerClick)},handleError:()=>{this.is_mounted?this.timerClick=setInterval(()=>{clearInterval(this.timerClick),this.fetchClusterStatus()},5e3):clearInterval(this.timerClick)}})}),this.handleStateName=(e=>{var t=e&&e.toLowerCase(),a={failed:E.default.failedState,running:E.default.successState,pending:E.default.warningState,warning:E.default.warningState};return a[t]||E.default.successState}),this.handleShowColor=(e=>{return e.conditions&&e.conditions.length>0&&e.conditions.some(e=>{return"Ready"===e.type&&"True"===e.status})?E.default.successState:E.default.failedState}),this.handleClusterState=(()=>{var e,t=this.props,a=t.clusterList,l=t.cluster_id,n=a.filter(e=>{return e.cluster_id===l});switch(n.length>0&&n[0].state){case"running":e=p.default.createElement(p.default.Fragment,null,p.default.createElement(r.default,{style:{margin:"0 5px",color:g.default.getPublicColor("rbd-success-status")},type:"check-circle"}),p.default.createElement("span",{style:{color:g.default.getPublicColor("rbd-success-status")}},(0,h.formatMessage)({id:"utils.getAliyunClusterStatus.operation"})));break;case"offline":e=p.default.createElement(p.default.Fragment,null,p.default.createElement(r.default,{style:{margin:"0 5px",color:g.default.getPublicColor("rbd-down-status")},type:"warning"}),p.default.createElement("span",{style:{color:g.default.getPublicColor("rbd-down-status")}},(0,h.formatMessage)({id:"utils.getAliyunClusterStatus.Offline"})));break;case"installing":e=p.default.createElement(p.default.Fragment,null,p.default.createElement(r.default,{style:{margin:"0 5px",color:g.default.getPublicColor("rbd-processing-status")},type:"sync",spin:!0}),p.default.createElement("span",{style:{color:g.default.getPublicColor("rbd-processing-status")}},(0,h.formatMessage)({id:"utils.getAliyunClusterStatus.Being_installed"})));break;case"initial":e=p.default.createElement(p.default.Fragment,null,p.default.createElement(r.default,{style:{margin:"0 5px",color:g.default.getPublicColor("rbd-processing-status")},type:"sync",spin:!0}),p.default.createElement("span",{style:{color:g.default.getPublicColor("rbd-processing-status")}},(0,h.formatMessage)({id:"utils.getAliyunClusterStatus.Initializing"})));break;case"failed":e=p.default.createElement(p.default.Fragment,null,p.default.createElement(r.default,{style:{margin:"0 5px",color:g.default.getPublicColor("rbd-error-status")},type:"close-circle"}),p.default.createElement("span",{style:{color:g.default.getPublicColor("rbd-error-status")}},(0,h.formatMessage)({id:"utils.getAliyunClusterStatus.Installation_failed"})));break;default:break}return e}),this.state={isShowContainer:!1,nodeList:[],podsList:[],clusterStateEle:null},this.timerClick=null,this.is_mounted=!1}componentDidMount(){this.is_mounted=!0,this.fetchClusterStatus()}componentWillUnmount(){this.is_mounted=!1,this.timerClick&&clearInterval(this.timerClick)}render(){var e=this.state,t=e.isShowContainer,a=e.clusterStateEle,l=e.nodeList,n=e.podsList,r=(this.props.cluster_id,p.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.35)"}},"\xa0/\xa0")),d=l.length>0&&l.filter(e=>{return e.status.conditions.some(e=>{return"Ready"===e.type&&"True"===e.status})}),i=n.length>0&&n.filter(e=>{return"Running"===e.status.phase||"Succeeded"===e.status.phase});return p.default.createElement("div",{className:E.default.container_style},t?p.default.createElement(s.default,null,p.default.createElement(s.default,{className:E.default.componentState_style},p.default.createElement(o.default,{span:8},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ShowNodeComponent.node_com"}),"(",p.default.createElement("span",{style:{color:g.default.getPublicColor("rbd-success-status")}},d.length||0),"/",l.length||0,")"),p.default.createElement(o.default,{span:8,style:{textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center"}},a),p.default.createElement(o.default,{span:8,style:{textAlign:"right"}},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ShowNodeComponent.cluter_com"}),"(",p.default.createElement("span",{style:{color:g.default.getPublicColor("rbd-success-status")}},i.length||0),"/",n.length||0,")")),p.default.createElement(o.default,{style:{paddingBottom:16}},p.default.createElement(c.default,{expandIconPosition:"right"},p.default.createElement(v,{header:(0,h.formatMessage)({id:"enterpriseColony.ShowNodeComponent.node_com"}),key:"1"},p.default.createElement("div",{className:E.default.customTables},p.default.createElement(s.default,{className:E.default.customTablesTit},p.default.createElement(o.default,{span:3},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.state"})),p.default.createElement(o.default,{span:3},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.name"})),p.default.createElement(o.default,{span:3},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ShowNodeComponent.role"})),p.default.createElement(o.default,{span:3},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ShowNodeComponent.version"})),p.default.createElement(o.default,{span:3},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ShowNodeComponent.external_iP"})),p.default.createElement(o.default,{span:3},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ShowNodeComponent.internal_iP"})),p.default.createElement(o.default,{span:3},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ShowNodeComponent.arch"})),p.default.createElement(o.default,{span:3},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ShowNodeComponent.container_version"}))),p.default.createElement("div",{className:E.default.boxs},l&&l.length?l.map(e=>{var t=e.metadata,a=(e.spec,e.status);return p.default.createElement(s.default,{className:E.default.customTableCon},p.default.createElement(o.default,{span:3},p.default.createElement("div",{style:{width:100,textAlign:"center"},className:this.handleShowColor(a)},a.conditions&&a.conditions.length>0&&a.conditions.some(e=>{return"Ready"===e.type&&"True"===e.status})?"Ready":"Not Ready")),p.default.createElement(o.default,{span:3},p.default.createElement("span",null,t&&t.name)),p.default.createElement(o.default,{span:3},p.default.createElement("span",null,t&&t.labels&&t.labels["beta.kubernetes.io/arch"])),p.default.createElement(o.default,{span:3},p.default.createElement("span",null,a&&a.nodeInfo&&a.nodeInfo.kubeletVersion)),p.default.createElement(o.default,{span:3},p.default.createElement("span",null,a&&a.addresses&&a.addresses.filter(e=>{return"ExternalIP"===e.type})[0].address)),p.default.createElement(o.default,{span:3},p.default.createElement("span",null,a&&a.addresses&&a.addresses.filter(e=>{return"InternalIP"===e.type})[0].address)),p.default.createElement(o.default,{span:3},p.default.createElement("span",null,t&&t.labels&&t.labels["beta.kubernetes.io/arch"])),p.default.createElement(o.default,{span:3},p.default.createElement("span",null,a&&a.nodeInfo&&a.nodeInfo.containerRuntimeVersion)))}):p.default.createElement("div",{style:{textAlign:"center",color:"rgba(0,0,0,0.35)",marginTop:"15px"}},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.created"}))))))),p.default.createElement(o.default,null,p.default.createElement(c.default,{expandIconPosition:"right"},p.default.createElement(v,{header:(0,h.formatMessage)({id:"enterpriseColony.ShowNodeComponent.cluter_com"}),key:"1"},p.default.createElement("div",{className:E.default.customTables},p.default.createElement(s.default,{className:E.default.customTablesTit},p.default.createElement(o.default,{span:3},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.state"})),p.default.createElement(o.default,{span:7},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.name"})),p.default.createElement(o.default,{span:14},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.image"}))),p.default.createElement("div",{className:E.default.boxs},n&&n.length?n.map(e=>{var t=e.metadata,a=e.spec,l=e.status;return p.default.createElement(s.default,{className:E.default.customTableCon},p.default.createElement(o.default,{span:3},p.default.createElement("div",{className:this.handleStateName(l&&l.phase)},l&&l.phase)),p.default.createElement(o.default,{span:7},p.default.createElement("span",null,t&&t.name)),p.default.createElement(o.default,{span:14},p.default.createElement("div",null,a&&a.containers&&a.containers.length>0&&a.containers[0].image),p.default.createElement("div",null,p.default.createElement("span",null,l&&l.hostIP,r),p.default.createElement("span",null,l&&l.podIP,r),p.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.35)"}},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.Time"}),t&&t.creationTimestamp&&(0,f.default)(t.creationTimestamp).format("YYYY-MM-DD HH:mm:ss")),p.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.35)"}},"\xa0/\xa0 ",p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.number"}),l&&l.containerStatuses&&l.containerStatuses.length&&l.containerStatuses[0].restartCount))))}):p.default.createElement("div",{style:{textAlign:"center",color:"rgba(0,0,0,0.35)",marginTop:"15px"}},p.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.created"})))))))):p.default.createElement(C.default,{style:{background:"#fff",marginTop:"10px",padding:"20px"},type:"ing",title:"\u83b7\u53d6\u96c6\u7fa4\u5b89\u88c5\u8fdb\u5ea6\u4e2d",description:"\u6b63\u5728\u83b7\u53d6\u96c6\u7fa4\u5b89\u88c5\u72b6\u6001\u4fe1\u606f\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f851\uff5e3\u5206\u949f"}))}},i=u))||i);t.default=y},PGD2:function(e,t,a){e.exports={clusterInit:"clusterInit___1rnOD",clusterComponent:"clusterComponent___uq4zh"}},UBd8:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var s=l(a("kLXV"));a("14J3");var o=l(a("BMrR"));a("RC8p");var r=l(a("rgW5"));a("+L6B");var d=l(a("2/Rp"));a("fOrg");var i,u,c,m=l(a("+KLJ")),p=l(a("mWxT")),f=a("MuoO"),g=n(a("q1tI")),h=a("LLXN"),C=l(a("e6Ls")),E=l(a("imTl")),v=l(a("3//m")),y=l(a("LWWM")),_=l(a("w58A")),b=(i=(0,f.connect)(e=>{var t=e.global;return{rainbondInfo:t.rainbondInfo,enterprise:t.enterprise}}),i((c=class extends g.PureComponent{constructor(e){super(e),this.queryCreateLog=(()=>{this.setState({showCreateLog:!0})}),this.handleIsComponents=(e=>{this.setState({isComponents:e})}),this.state={showCreateLog:!1,isComponents:!1}}render(){var e=this.props,t=e.onCancel,a=e.title,l=e.eid,n=e.selectProvider,i=e.providerName,u=e.steps,c=e.loading,f=e.complete,b=e.clusterID,I=e.msg,S=e.guideStep,M=e.handleNewbieGuiding,N=e.isLog,w=void 0===N||N,T=e.rainbondInfo,k=e.clusterList,L=e.isShowNodeComponent,P=e.isK8sProgress,x=void 0!==P&&P,D=this.state,F=D.showCreateLog,H=D.isComponents,R=p.default.isEnterpriseEdition(T),B=n||i,A=u&&u.length&&u.filter(e=>"InitRainbondRegionOperator"===e.Type),O=(A&&A.length,"".concat((0,h.formatMessage)({id:"enterpriseColony.ClusterProgressQuery.hand"})));return f&&(O=!1),g.default.createElement(g.default.Fragment,null,x?g.default.createElement(s.default,{title:"showNode"===L?(0,h.formatMessage)({id:"enterpriseColony.ClusterProgressQuery.cluster_state"}):a,visible:!0,maskClosable:!1,width:"showNode"===L?1100:600,onCancel:t,className:C.default.TelescopicModal,footer:[]},F&&g.default.createElement(v.default,{eid:l,clusterID:b,selectProvider:n||i,onCancel:()=>{this.setState({showCreateLog:!1})}}),H&&g.default.createElement(E.default,{eid:l,clusterID:b,providerName:n||i,onCancel:()=>{this.handleIsComponents(!1)}}),"showNode"!==L?g.default.createElement(o.default,{loading:c,className:_.default.box},g.default.createElement(m.default,{style:{marginBottom:"16px"},message:g.default.createElement("span",null,I,!R&&g.default.createElement(g.default.Fragment,null,g.default.createElement("a",{target:"_blank",href:"https://www.rainbond.com/docs/support",style:{padding:0}},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.ding"})),g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.support"}))),type:"info",showIcon:!0}),S&&13!==S&&M?M({tit:(0,h.formatMessage)({id:"enterpriseColony.ClusterProgressQuery.state"}),btnText:(0,h.formatMessage)({id:"enterpriseColony.ClusterProgressQuery.Known"}),configName:"clusterTheInitialization",showSvg:!1,conPosition:{right:"-97px",top:"88px"},nextStep:13}):"",g.default.createElement(r.default,{loading:c,pending:O&&g.default.createElement("div",null,O)},u&&u.length&&u.map((e,t)=>{var a=e.Status,l=e.Title,n=e.Description,s=e.Message,o=e.reason;return g.default.createElement(r.default.Item,{color:e.Color,key:"step".concat(t)},g.default.createElement("h4",null,l),g.default.createElement("p",null,n),g.default.createElement("p",null,s),o&&"NamespaceBeingTerminated"===o&&g.default.createElement(m.default,{style:{marginBottom:"16px"},message:g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.name"}),type:"warning",showIcon:!0}),w&&"failure"===a&&b&&g.default.createElement("div",null,g.default.createElement(d.default,{type:"link",style:{padding:0},onClick:this.queryCreateLog},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.log"}))))})),f&&g.default.createElement("span",null,g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.over"}))):g.default.createElement(y.default,{clusterList:k,cluster_id:b,enterprise_id:l})):g.default.createElement("div",null,g.default.createElement("div",{className:_.default.componentTitle},a),F&&g.default.createElement(v.default,{eid:l,clusterID:b,selectProvider:n||i,onCancel:()=>{this.setState({showCreateLog:!1})}}),H&&g.default.createElement(E.default,{eid:l,clusterID:b,providerName:n||i,onCancel:()=>{this.handleIsComponents(!1)}}),g.default.createElement(o.default,{loading:c,className:_.default.box},g.default.createElement(m.default,{style:{marginBottom:"16px"},message:g.default.createElement("span",null,I,!R&&g.default.createElement(g.default.Fragment,null,g.default.createElement("a",{target:"_blank",href:"https://www.rainbond.com/community/support",style:{padding:0}},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.ding"})),g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.support"}))),type:"info",showIcon:!0}),S&&13!==S&&M?M({tit:(0,h.formatMessage)({id:"enterpriseColony.ClusterProgressQuery.state"}),btnText:(0,h.formatMessage)({id:"enterpriseColony.ClusterProgressQuery.Known"}),configName:"clusterTheInitialization",showSvg:!1,conPosition:{right:"-97px",top:"88px"},nextStep:13}):"",g.default.createElement(r.default,{loading:c,pending:O&&g.default.createElement("div",null,O)},u&&u.length&&u.map((e,t)=>{var a=e.Status,l=e.Title,n=e.Description,s=e.Message,o=e.reason;return g.default.createElement(r.default.Item,{color:e.Color,key:"step".concat(t)},g.default.createElement("h4",null,l),g.default.createElement("p",null,n),g.default.createElement("p",null,s),o&&"NamespaceBeingTerminated"===o&&g.default.createElement(m.default,{style:{marginBottom:"16px"},message:g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.name"}),type:"warning",showIcon:!0}),w&&"failure"===a&&b&&g.default.createElement("div",null,g.default.createElement(d.default,{type:"link",style:{padding:0},onClick:this.queryCreateLog},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.log"}))))})),f&&g.default.createElement("span",null,g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterProgressQuery.over"})))))}},u=c))||u),I=b;t.default=I},aMNY:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,o,r,d=l(a("jehZ")),i=a("MuoO"),u=n(a("q1tI")),c=a("LLXN"),m=l(a("AklW")),p=l(a("QDog")),f=l(a("UBd8")),g=(s=(0,i.connect)(e=>{var t=e.global;return{rainbondInfo:t.rainbondInfo,enterprise:t.enterprise}}),s((r=class extends u.PureComponent{constructor(e){super(e),this.refresh=!0,this.loadTask=(()=>{var e=this.props,t=e.dispatch,a=e.eid,l=e.clusterID,n=e.providerName;t({type:"cloud/loadInitRainbondTask",payload:{enterprise_id:a,clusterID:l,providerName:n},callback:e=>{e&&this.setState({complete:"complete"===e.status})},handleError:e=>{m.default.handleCloudAPIError(e),this.setState({loading:!1})}})}),this.loadTaskEvents=(()=>{var e=this.props,t=e.dispatch,a=e.eid,l=e.taskID,n=e.rainbondInfo,s=e.enterprise,o=e.providerName,r=e.completeEvents;t({type:"cloud/loadTaskEvents",payload:{enterprise_id:a,taskID:l},callback:e=>{if(e){var t=m.default.showInitRainbondSteps(e.events),d=t.complete,i=t.steps;d&&i.length>0&&(p.default.putInstallClusterLog(s,n,{eid:a,taskID:l,status:i[i.length-1].Status,message:i[i.length-1].Message,install_step:"createRainbond",provider:o}),r&&r(!0)),this.setState({clusterID:e.clusterID,complete:d,loading:!1,steps:i}),!d&&this.refresh&&setTimeout(()=>this.loadTaskEvents(),4e3)}},handleError:e=>{m.default.handleCloudAPIError(e),this.setState({loading:!1})}})}),this.queryCreateLog=(()=>{this.setState({showCreateLog:!0})}),this.state={loading:!0,complete:!1,steps:[],clusterID:"",showCreateLog:!1}}componentDidMount(){this.loadTask(),this.loadTaskEvents()}componentWillUnmount(){this.refresh=!1}render(){var e=this.props.title;return u.default.createElement(f.default,(0,d.default)({title:e||u.default.createElement(c.FormattedMessage,{id:"enterpriseColony.ShowInitRainbondDetail.title"}),msg:u.default.createElement(c.FormattedMessage,{id:"enterpriseColony.ShowInitRainbondDetail.msg"}),isLog:!1},this.state,this.props))}},o=r))||o),h=g;t.default=h},imTl:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var s=l(a("W9HT"));a("14J3");var o=l(a("BMrR"));a("jCWc");var r=l(a("kPKH"));a("Pwec");var d=l(a("CtXQ"));a("fu2T");var i,u,c,m=l(a("gK9i")),p=a("MuoO"),f=l(a("wd/R")),g=n(a("q1tI")),h=a("LLXN"),C=a("mLYH"),E=a("9Mv3"),v=l(a("4W9V")),y=(l(a("e6Ls")),l(a("sVIN"))),_=m.default.Panel,b=(i=(0,p.connect)(e=>{var t=e.global;return{rainbondInfo:t.rainbondInfo,enterprise:t.enterprise}}),i((c=class extends g.PureComponent{constructor(e){super(e),this.fetchRainbondComponents=(()=>{var e=this.props,t=(e.eid,e.clusterID,e.providerName,e.completePods),a=this.state.componentInfo;(0,E.installClusterAllPodinfo)().then(e=>{var l=e&&e.list||[],n=!1;l.map(e=>{a.app===e.app&&e.pods&&e.pods.length&&(n=Object.assign({},e.pods[0],{app:e.app}))}),this.handleComponentDetails(n),this.setState({list:l},()=>{if(this.refresh){for(var e=!0,a=0;a<l.length;a++){var n=l[a].pods;if(null==n||0===n.length){e=!1;break}for(var s=0;s<n.length;s++)if("Running"!==n[s].status.phase){e=!1;break}}e&&t&&t(!0),this.delayTimer=setTimeout(()=>this.fetchRainbondComponents(),4e3)}})}).catch(e=>{var t=null;e.response&&e.response.data?t=e.response.data:e.data&&(t=e.data);var a=t&&t.code;a&&7002!==a&&(0,v.default)(e),this.fetchRainbondComponents()}).finally(()=>{this.setState({componentsLoading:!1})})}),this.fetchPodEvent=(e=>{var t=this.props,a=t.eid,l=t.clusterID,n=t.providerName;(0,C.getPodEvent)({clusterID:l,providerName:n,podName:e,enterprise_id:a}).then(e=>{this.setState({evens:e&&e.response_data||[]})}).catch(e=>{(0,v.default)(e)}).finally(()=>{this.handleEventLoading()})}),this.handleEventLoading=(()=>{this.setState({eventLoading:!1})}),this.handleComponentDetails=(e=>{e&&e.metadata&&e.metadata.name?this.fetchPodEvent(e.metadata.name):this.handleEventLoading(),this.setState({componentInfo:e})}),this.handleStateName=(e=>{var t=e&&e.toLowerCase(),a={failed:y.default.failedState,running:y.default.successState,pending:y.default.warningState,warning:y.default.warningState};return a[t]||y.default.successState}),this.state={componentInfo:!1,componentsLoading:!0,eventLoading:!0,evens:[],list:[]},this.delayTimer=null}componentDidMount(){this.refresh=!0,this.fetchRainbondComponents()}componentWillUnmount(){this.refresh=!1,this.delayTimer&&clearTimeout(this.delayTimer)}render(){var e=this.props,t=(e.onCancel,e.openInitInfo,this.state),a=t.list,l=t.evens,n=t.componentInfo,i=t.componentsLoading,u=t.eventLoading,c=a&&a.length,p=[],C=[];a.forEach(e=>{e.pods&&e.pods.length>0&&(e.pods.forEach(e=>{"Running"===e.status.phase&&C.push(e)}),C.length===e.pods.length&&(p.push(e),C=[]))});var E=g.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.35)"}},"\xa0/\xa0");return g.default.createElement("div",null,g.default.createElement("div",{className:y.default.componentTitle},n?"".concat((0,h.formatMessage)({id:"enterpriseColony.ClusterComponents.details"})):"".concat((0,h.formatMessage)({id:"enterpriseColony.ClusterComponents.Rainbond"}))+"(".concat(p.length,"/").concat(c,")")),g.default.createElement(s.default,{spinning:n?i||u:i},n?g.default.createElement("div",{className:y.default.copmonentDetail},g.default.createElement("div",{style:{marginBottom:"20px"}},g.default.createElement(d.default,{type:"arrow-left",style:{fontSize:"20px",color:"#4d73b1"},onClick:()=>{this.handleComponentDetails(!1)}})),g.default.createElement("div",{className:y.default.componentHeader},g.default.createElement("div",null,"Pod:",n.metadata&&n.metadata.name),g.default.createElement("div",{className:this.handleStateName(n.status&&n.status.phase)},n.status&&n.status.phase)),g.default.createElement("div",{className:y.default.componentBox},g.default.createElement("div",null,g.default.createElement("div",null,g.default.createElement("span",null,g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.Name"})),g.default.createElement("span",null,n.metadata&&n.metadata.namespace)),g.default.createElement("div",{style:{width:"66.66%",border:"none"}},g.default.createElement("div",{className:y.default.componentBoxs},g.default.createElement("div",null,g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.Image"})),g.default.createElement("div",null,n.spec&&n.spec.containers&&n.spec.containers.length&&n.spec.containers[0].image)))),g.default.createElement("div",null,g.default.createElement("div",null,g.default.createElement("span",null,"PodIP\uff1a"),g.default.createElement("span",null,n.status&&n.status.podIP)),g.default.createElement("div",null,g.default.createElement("p",null,g.default.createElement("span",null,"Node\uff1a"),n.spec&&n.spec.nodeName),g.default.createElement("p",null,g.default.createElement("span",null,"HostIP\uff1a"),n.status&&n.status.hostIP)),g.default.createElement("div",null,g.default.createElement("p",null,g.default.createElement("span",null,g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.Time"})),n.metadata&&n.metadata.creationTimestamp&&(0,f.default)(n.metadata.creationTimestamp).format("YYYY-MM-DD HH:mm:ss")),g.default.createElement("p",null,g.default.createElement("span",null,g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.Number"})),n.status&&n.status.containerStatuses&&n.status.containerStatuses.length&&n.status.containerStatuses[0].restartCount)))),g.default.createElement(m.default,{defaultActiveKey:["1","2"],onChange:this.handleChange,className:y.default.customCollapse},g.default.createElement(_,{header:g.default.createElement("div",{className:y.default.panelBox},g.default.createElement("div",null,g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.container"})),g.default.createElement("div",null,g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.Container_pod"}))),key:"1"},g.default.createElement("div",{className:y.default.customTables},g.default.createElement(o.default,{className:y.default.customTablesTit},g.default.createElement(r.default,{span:4},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.state"})),g.default.createElement(r.default,{span:6},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.name"})),g.default.createElement(r.default,{span:10},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.image"})),g.default.createElement(r.default,{span:4,style:{textAlign:"center"}},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.number"}))),n.status&&n.status.containerStatuses&&n.status.containerStatuses.length&&n.status.containerStatuses.map(e=>{var t=e.image,a=e.state,l=e.name,n=e.restartCount;return g.default.createElement(o.default,{className:y.default.customTableCon},g.default.createElement(r.default,{span:4},g.default.createElement("div",{className:this.handleStateName(a&&Object.keys(a)[0])},a&&Object.keys(a)[0])),g.default.createElement(r.default,{span:6},g.default.createElement("a",null,l)),g.default.createElement(r.default,{span:10},g.default.createElement("span",null,t)),g.default.createElement(r.default,{span:4,style:{textAlign:"center"}},n))}))),g.default.createElement(_,{header:g.default.createElement("div",{className:y.default.panelBox},g.default.createElement("div",null,g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.event"})),g.default.createElement("div",null,g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.pod"}))),key:"2"},g.default.createElement("div",{className:y.default.customTables},g.default.createElement(o.default,{className:y.default.customTablesTit},g.default.createElement(r.default,{span:4},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.type"})),g.default.createElement(r.default,{span:6},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.Cause"})),g.default.createElement(r.default,{span:10},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.information"})),g.default.createElement(r.default,{span:4},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.last"}))),l&&l.length?l.map(e=>{var t=e.type,a=e.reason,l=e.message,n=e.eventTime;return g.default.createElement(o.default,{className:y.default.customTableCon},g.default.createElement(r.default,{span:4},g.default.createElement("div",{className:this.handleStateName(t)},t)),g.default.createElement(r.default,{span:6},g.default.createElement("span",null,a)),g.default.createElement(r.default,{span:10},g.default.createElement("span",null,l)),g.default.createElement(r.default,{span:4},n&&(0,f.default)(n).format("YYYY-MM-DD HH:mm:ss")))}):g.default.createElement("div",{style:{textAlign:"center",color:"rgba(0,0,0,0.35)",marginTop:"15px"}},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.null"})))))):g.default.createElement("div",{className:y.default.customTables},g.default.createElement(o.default,{className:y.default.customTablesTit},g.default.createElement(r.default,{span:3},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.state"})),g.default.createElement(r.default,{span:7},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.name"})),g.default.createElement(r.default,{span:14},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.image"}))),g.default.createElement("div",{className:y.default.boxs},a&&a.length?a.map(e=>{var t=e.app,a=e.pods;return g.default.createElement(o.default,null,g.default.createElement(o.default,{className:y.default.customTableMinTit},t),a&&a.length>0?a.map(e=>{var a=e.status,l=e.metadata,n=e.spec;return g.default.createElement(o.default,{className:y.default.customTableCon,key:a.phase},g.default.createElement(r.default,{span:3},g.default.createElement("div",{className:this.handleStateName(a&&a.phase)},a&&a.phase)),g.default.createElement(r.default,{span:7},g.default.createElement("a",{onClick:()=>{this.handleComponentDetails(Object.assign({},e,{app:t}))}},l&&l.name)),g.default.createElement(r.default,{span:14},g.default.createElement("div",null,n&&n.containers&&n.containers.length>0&&n.containers[0].image),g.default.createElement("div",null,g.default.createElement("span",{style:{color:"#4d73b1"}},a&&a.hostIP,E),g.default.createElement("span",{style:{color:"#4d73b1"}},n&&n.nodeName,E),g.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.35)"}},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.Time"}),l&&l.creationTimestamp&&(0,f.default)(l.creationTimestamp).format("YYYY-MM-DD HH:mm:ss")),g.default.createElement("span",{style:{color:"rgba(0, 0, 0, 0.35)"}},"\xa0/\xa0 ",g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.number"}),a&&a.containerStatuses&&a.containerStatuses.length&&a.containerStatuses[0].restartCount))))}):g.default.createElement("div",{style:{marginTop:"12px",textAlign:"center "}},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.Pods"})))}):g.default.createElement("div",{style:{textAlign:"center",color:"rgba(0,0,0,0.35)",marginTop:"15px"}},g.default.createElement(h.FormattedMessage,{id:"enterpriseColony.ClusterComponents.created"}))))))}},u=c))||u),I=b;t.default=I},qkmd:function(e,t,a){e.exports={tableInfo:"tableInfo___202M8",pod_Info:"pod_Info___2Qv56",details:"details___1cV0m",podInfo:"podInfo___3koRX",podStatus:"podStatus___2Cu5U",failedState:"failedState___3QDQs",successState:"successState___3D52B",warningState:"warningState___9zAmP",customCollapse:"customCollapse___VE7-U",panelBox:"panelBox___3uNJJ",customCollapseTable:"customCollapseTable___34zTL",customCollapseDetails:"customCollapseDetails___1aWOv",podname:"podname___2oak7",ButtonBox:"ButtonBox___3fgZP",logContainer:"logContainer___2F0lF",logLine:"logLine___3Cn5k",lineNumber:"lineNumber___2zeV0",logContent:"logContent___2_6k_",timestamp:"timestamp___-BKgA",logControls:"logControls___23bB3",logStats:"logStats___jBP_p"}},sVIN:function(e,t,a){e.exports={nameID:"nameID___3NRa3",icon:"icon___1rW5r",iconm:"iconm___3KtEg",customTables:"customTables___3FsN7",customTableCon:"customTableCon___171eV",customTablesTit:"customTablesTit___S9AZ3",customTableMinTit:"customTableMinTit___tbdD0",failedState:"failedState___1wXTB",successState:"successState___2yJ83",warningState:"warningState___3v22N",componentHeader:"componentHeader___iuInv",componentBox:"componentBox___3Es1i",componentBoxs:"componentBoxs___E1sxf",customCollapse:"customCollapse___150OO",panelBox:"panelBox___3o84_",container_style:"container_style___1N2TN",componentState_style:"componentState_style___3HGJA",componentTitle:"componentTitle___IvJ4J",copmonentDetail:"copmonentDetail___3jao_"}},w58A:function(e,t,a){e.exports={nameID:"nameID___3kRbq",icon:"icon___3Y73l",iconm:"iconm___OoL9a",box:"box___102SU",componentTitle:"componentTitle___2cflL"}},yE1K:function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var s=l(a("BMrR"));a("y8nQ");var o=l(a("Vl3Y"));a("FJo9");var r,d,i,u,c=l(a("L41K")),m=a("MuoO"),p=a("7DNP"),f=a("LLXN"),g=n(a("q1tI")),h=(l(a("AklW")),l(a("QDog"))),C=l(a("4AJc")),E=(l(a("aMNY")),l(a("XZXw"))),v=l(a("2lxJ")),y=l(a("+iC2")),_=l(a("PGD2")),b=c.default.Step,I=(r=o.default.create(),d=(0,m.connect)(e=>{var t=e.user,a=e.list,l=e.loading,n=e.global,s=e.index;return{user:t.currentUser,list:a,loading:l.models.list,rainbondInfo:n.rainbondInfo,enterprise:n.enterprise,isRegist:n.isRegist,oauthLongin:l.effects["global/creatOauth"],overviewInfo:s.overviewInfo}}),r(i=d((u=class extends g.PureComponent{constructor(e){var t;super(e),t=this,this.toClusterList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rke",a=t.props.dispatch,l=t.props.match.params.eid,n={initializing:"/enterprise/{eid}/provider/{provider}/kclusters/append?event_id={eventId}",initialized:"/enterprise/{eid}/provider/{provider}/kclusters?event_id={eventId}",installing:"/enterprise/{eid}/provider/{provider}/kclusters?type=installing&event_id={eventId}",installed:"/enterprise/{eid}/provider/{provider}/kclusters?event_id={eventId}",integrating:"/enterprise/{eid}/provider/{provider}/kclusters/init?event_id={eventId}",integrated:"/enterprise/{eid}/provider/{provider}/kclusters/check?event_id={eventId}"};a({type:"region/fetchClusterInfo",payload:{cluster_id:""},callback:t=>{if(t&&200===t.status_code){window.localStorage.setItem("event_id",t.bean.event_id);var s=t.bean.create_status,o=n[s]||n.initializing;o=o.replace("{eid}",l).replace("{provider}",e),o.includes("{eventId}")&&(o=o.replace("{eventId}",t.bean.event_id)),a(p.routerRedux.push(o))}}})},this.loadTask=(e=>{var t=this.props,a=t.dispatch,l=t.match.params,n=l.eid,s=l.provider,o=l.clusterID,r=n||h.default.getCurrEnterpriseId();a({type:"cloud/loadInitRainbondTask",payload:{enterprise_id:r,clusterID:o,providerName:s},callback:e=>{if(e&&200===e.status_code&&e.response_data&&e.response_data.data){var t=e.response_data.data;this.setState({task:t})}},handleError:e=>{}})}),this.addClusterOK=(()=>{var e=this.props.dispatch,t=this.props.match.params.eid,a=t||h.default.getCurrEnterpriseId();e(p.routerRedux.push("/enterprise/".concat(a,"/clusters")))}),this.preStep=(()=>{var e=this.props.dispatch,t=this.props.match.params,a=t.eid,l=t.provider,n=a||h.default.getCurrEnterpriseId();e(p.routerRedux.push("/enterprise/".concat(n,"/provider/").concat(l,"/kclusters?event_id=").concat(window.localStorage.getItem("event_id"))))}),this.loadSteps=(()=>{var e=[{title:(0,f.formatMessage)({id:"enterpriseColony.addCluster.supplier"})},{title:(0,f.formatMessage)({id:"enterpriseColony.addCluster.cluster"})},{title:(0,f.formatMessage)({id:"enterpriseColony.addCluster.Initialize"})},{title:(0,f.formatMessage)({id:"enterpriseColony.addCluster.clusterInit"})},{title:(0,f.formatMessage)({id:"enterpriseColony.addCluster.docking"})}];return e}),this.completeInit=(()=>{var e=this.props.dispatch,t=this.props.match.params,a=t.eid,l=t.provider,n=(t.clusterID,a||h.default.getCurrEnterpriseId());e(p.routerRedux.push("/enterprise/".concat(n,"/provider/").concat(l,"/kclusters/link")))}),this.cancelShowInitDetail=(()=>{this.setState({showInitDetail:!1})});var a=this.props.user,l=y.default.isCompanyAdmin(a);this.state={adminer:l,showInitDetail:!1,guideStep:10,task:null}}componentWillMount(){var e=this.state.adminer,t=this.props.dispatch;e||t(p.routerRedux.push("/"))}componentWillUnmount(){this.refresh=!1}componentDidMount(){}render(){var e=this.props.match.params,t=e.eid,a=e.provider,l=e.clusterID,n=(e.taskID,this.state);n.showInitDetail,n.guideStep,n.task;return g.default.createElement(E.default,{title:g.default.createElement(f.FormattedMessage,{id:"enterpriseColony.button.text"}),content:g.default.createElement(f.FormattedMessage,{id:"enterpriseColony.PageHeaderLayout.content"}),titleSvg:v.default.getPageHeaderSvg("clusters",18)},g.default.createElement(s.default,{style:{marginBottom:"16px"}},g.default.createElement(c.default,{current:3},this.loadSteps().map(e=>g.default.createElement(b,{key:e.title,title:e.title})))),g.default.createElement("div",{className:_.default.clusterInit},g.default.createElement("div",{className:_.default.clusterComponent},g.default.createElement(C.default,{eid:t,clusterID:l,providerName:a,completeInit:this.completeInit,preStep:this.preStep}))))}},i=u))||i)||i);t.default=I}}]);