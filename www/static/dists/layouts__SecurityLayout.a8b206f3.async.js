(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{aej6:function(e,t,r){"use strict";var o=r("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,r("/xke");var n=o(r("TeRw")),s=r("MuoO"),a=r("s4NR"),i=o(r("q1tI")),c=r("ArA+"),l=o(r("3a4m")),u=o(r("xqX8")),d=o(r("8+Sn")),h=o(r("QDog")),p=o(r("o1c1"));class f extends i.default.PureComponent{constructor(){super(...arguments),this.state={isReady:!1},this.fetchLicenses=(()=>{var e=this.props.dispatch;e&&e({type:"global/fetchLicenses",callback:e=>{e&&(!e.is_permanent&&e.is_expired||!e.have_license)?l.default.push({pathname:"/authorization/overdue",query:{isLicense:e.have_license}}):this.fetchRainbondInfo()},handleError:()=>{l.default.push("/authorization/overdue")}})}),this.fetchRainbondInfo=(()=>{var e=this.props,t=e.dispatch,r=e.location.query;t&&t({type:"global/fetchRainbondInfo",callback:e=>{e&&("true"===e.sso_enable&&r&&r.token?t({type:"user/ssologin",payload:{token:r.token},callback:()=>{this.fetchUserInfo()},handleError:()=>{n.default.warning({message:"\u5355\u70b9\u767b\u5f55\u4e0d\u6210\u529f"}),h.default.removeCookie(),l.default.push("/user/login")}}):this.fetchUserInfo())}})}),this.fetchUserInfo=(()=>{var e=this.props.dispatch;e&&e({type:"user/fetchCurrent",callback:()=>{this.setState({isReady:!0})},handleError:()=>{this.setState({isReady:!0})}})})}componentDidMount(){this.fetchLicenses()}render(){var e=this.props,t=e.children,r=e.currentUser,o=e.needLogin,n=this.state.isReady,s=d.default.get("token"),l=s&&r,f=(0,a.stringify)({redirect:window.location.href});return o?(h.default.removeCookie(),i.default.createElement(c.Redirect,{to:"/user/login?".concat(f)})):n?n&&!l&&"/user/login"!==window.location.pathname?(h.default.removeCookie(),i.default.createElement(c.Redirect,{to:"/user/login?".concat(f)})):i.default.createElement(p.default,{children:t}):i.default.createElement(u.default,null)}}var g=(0,s.connect)(e=>{var t=e.user,r=e.loading,o=e.global;return{currentUser:t.currentUser,loading:r.models.user,needLogin:o.needLogin}})(f);t.default=g},o1c1:function(e,t,r){"use strict";(function(e){var o=r("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,s,a,i=o(r("q1tI")),c=r("MuoO"),l=(n=(0,c.connect)(e=>{var t=e.user;return{currentUser:t.currentUser}}),n((a=class extends i.PureComponent{constructor(e){super(e),this.saveLog=(e=>{var t=this.props,r=t.dispatch,o=t.currentUser;r({type:"global/saveLog",payload:{username:o&&o.user_name,enterprise_id:o&&o.enterprise_id,address:window.location.href,msg:"\u9519\u8bef\uff1a".concat(e.toString())}})}),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(t,r){return console.log("err",t.toString()),console.log("errorInfo",r),e&&Object({NODE_ENV:"production"}),this.saveLog(t)}render(){var e=this.state.hasError,t=this.props.children;return e&&(i.Result,i.Button),t}},s=a))||s);t.default=l}).call(this,r("Q2Ig"))}}]);