(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[30],{VMuN:function(e,t,a){e.exports={nameID:"nameID___1ITqR",icon:"icon___gohI4",iconm:"iconm___1RD7_",box:"box___1Uhcz",consoleBody:"consoleBody___2DZ7p",menus:"menus___3r8E8",col:"col___3QrBB",header:"header___1eJBw",sync:"sync___3m3Ko",control:"control___mb5Yb",tabs:"tabs___3XRXq",consoleBox:"consoleBox___2Oxez",titleTab:"titleTab___Knaf3",closeTab:"closeTab___3eM_g"}},uj6I:function(e,t,a){"use strict";var n=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var l=n(a("BMrR"));a("jCWc");var i=n(a("kPKH"));a("T2oS");var c=n(a("W9HT"));a("Znn+");var o=n(a("ZTPi"));a("ozfa");var r,d,p,h=n(a("MJZm")),u=a("MuoO"),m=s(a("q1tI")),f=a("LLXN"),v=n(a("QDog")),_=n(a("VMuN")),g=n(a("GQsv")),b=h.default.TreeNode,w=o.default.TabPane,y=(r=(0,u.connect)(e=>{var t=e.user,a=e.appControl,n=e.global,s=e.teamControl,l=e.enterprise;return{currUser:t.currentUser,appDetail:a.appDetail,pods:a.pods,groups:n.groups,build_upgrade:a.build_upgrade,currentTeam:s.currentTeam,currentRegionName:s.currentRegionName,currentEnterprise:l.currentEnterprise}},null,null,{withRef:!0}),r((p=class extends m.PureComponent{constructor(e){super(e),this.onEdit=((e,t)=>{this[t](e)}),this.onChange=(e=>{this.setState({activeKey:e})}),this.onSelect=(e=>{if(e.length>0){var t=e[0];if(t.indexOf(".")>-1){var a=t.split("."),n=a[0],s=a[1];this.setState({podName:n,containerName:s}),this.openConsole(n,s)}}else{var l=this.state,i=l.podName,c=l.containerName;i&&c&&this.openConsole(i,c)}}),this.openConsole=((e,t)=>{var a=Math.random().toString(36).slice(-8),n={podName:e,containerName:t,title:t,key:a},s=this.state.tabs;s.push(n),this.setState({tabs:s,activeKey:a})}),this.updateTitle=((e,t)=>{var a=this.state.tabs,n=[];a.forEach(a=>{a.key==e&&(a.title=t),n.push(a)}),this.setState({tabs:n})}),this.fetchPods=(e=>{this.setState({loading:!0});var t=this.state.appDetail.service.service_id;this.props.dispatch({type:"appControl/fetchPods",payload:{team_name:v.default.getCurrTeamName(),app_alias:v.default.getComponentID()},callback:a=>{var n=[];if(a.list&&a.list.new_pods&&(n=a.list.new_pods),a.list&&a.list.old_pods&&(n=n.concat(a.list.old_pods)),this.clearLoading(),e&&n&&n.length>0&&n[0].container&&n[0].container.length>0){var s=n[0].container.filter(e=>e.container_name.includes(t)),l=s&&s.length>0?s[0].container_name:n[0].container[0].container_name,i=Math.random().toString(36).slice(-8),c={podName:n[0].pod_name,containerName:l,title:l,key:i};this.setState({tabs:[c],activeKey:i,pods:n})}else this.setState({pods:n})}})}),this.loadDetail=(()=>{this.props.dispatch({type:"appControl/fetchDetail",payload:{team_name:v.default.getCurrTeamName(),app_alias:v.default.getComponentID()},callback:e=>{this.setState({appDetail:e},()=>{this.fetchPods(!0)})}})}),this.controllLeft=(()=>{var e=this.state.leftWidth;0===e?this.setState({leftWidth:5}):this.setState({leftWidth:0})}),this.clearLoading=(()=>{this.setState({loading:!1})}),this.remove=(e=>{var t=this.state.tabs,a=t.filter(t=>t.key!==e),n=a.length>0?a[0].key:"";this.setState({tabs:a,activeKey:n})}),this.leftRender=(e=>{var t=this.state,a=t.pods,n=t.loading,s=[];return a&&a.length>0&&a[0].container&&a[0].container.length>0&&(s=[a[0].container[0].container_name]),m.default.createElement("div",{className:_.default.menus},m.default.createElement("div",{className:_.default.header},m.default.createElement("span",null,(0,f.formatMessage)({id:"componentOverview.header.list"})),m.default.createElement("span",{className:_.default.sync,onClick:()=>{this.fetchPods(!1)}},m.default.createElement("svg",{t:"1588475055820",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3297",width:"20",height:"20"},m.default.createElement("path",{d:"M134.4 518.4c19.2 0 38.4-19.2 38.4-38.4 0-185.6 153.6-339.2 339.2-339.2 115.2 0 217.6 57.6 281.6 147.2h-44.8c-19.2 0-38.4 19.2-38.4 38.4s19.2 38.4 38.4 38.4h140.8c19.2 0 38.4-19.2 38.4-38.4V192c0-19.2-19.2-38.4-38.4-38.4s-38.4 19.2-38.4 38.4v44.8C768 128 646.4 64 512 64 281.6 64 96 249.6 96 480c0 19.2 19.2 38.4 38.4 38.4z m755.2-76.8c-19.2 0-38.4 19.2-38.4 38.4 0 185.6-153.6 339.2-339.2 339.2-102.4 0-204.8-51.2-262.4-128h38.4c19.2 0 38.4-19.2 38.4-38.4s-19.2-38.4-38.4-38.4H147.2c-19.2 0-38.4 19.2-38.4 38.4v140.8c0 19.2 19.2 38.4 38.4 38.4s38.4-19.2 38.4-38.4v-57.6C262.4 838.4 384 896 512 896c230.4 0 416-185.6 416-416 0-19.2-19.2-38.4-38.4-38.4z","p-id":"3298",fill:"#ffffff"})))),m.default.createElement(c.default,{spinning:n,tip:"Loading..."},a&&a.length>0&&m.default.createElement(h.default,{defaultExpandAll:!0,onSelect:this.onSelect,defaultSelectedKeys:s},a.map(t=>{var a=t.pod_name,n=a;return n.includes("deployment")&&(n=n.slice(n.indexOf("-")+1)),m.default.createElement(b,{title:(0,f.formatMessage)({id:"componentOverview.header.example"},{title:n}),key:a},t.container.map(t=>{var n=t.container_name,s="".concat((0,f.formatMessage)({id:"componentOverview.header.container"},{name:n}));return n.includes(e.k8s_component_name)&&!n.includes("default-tcpmesh")?s="".concat((0,f.formatMessage)({id:"componentOverview.header.Component_container"})):n.includes("plugin")?s="".concat((0,f.formatMessage)({id:"componentOverview.header.Plug_container"})):n.includes("default-tcpmesh")&&(s="".concat((0,f.formatMessage)({id:"componentOverview.header.mesh"}))),m.default.createElement(b,{isLeaf:!0,title:s,key:"".concat(a,".").concat(n)})}))}))))}),this.tabContent=((e,t,a)=>{var n=this.state.appDetail;return m.default.createElement(g.default,{key:e+t,tenantID:n.service.tenant_id,serviceID:n.service.service_id,WebsocketURL:n.event_websocket_url,updateTitle:e=>this.updateTitle(a,e),podName:e,containerName:t,namespace:n.service.namespace})}),this.state={loading:!1,pods:[],tabs:[],leftWidth:5,appDetail:{},activeKey:""}}componentDidMount(){this.loadDetail()}render(){var e=this.state,t=e.leftWidth,a=e.tabs,n=e.appDetail,s=e.activeKey,c=n&&n.service;return m.default.createElement(l.default,{className:_.default.box},m.default.createElement(i.default,{className:_.default.col,style:{background:"#2f2a2a"},span:t},c&&this.leftRender(c)),m.default.createElement(i.default,{className:_.default.col,span:24-t},m.default.createElement("span",{onClick:this.controllLeft,className:_.default.control},t>0?m.default.createElement("svg",{t:"1588476023049",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4836",width:"200",height:"200"},m.default.createElement("path",{d:"M68.608 517.632l207.36 159.744V357.888zM939.52 227.328H83.968c-8.704 0-15.872-7.168-15.872-15.872V144.384c0-8.704 7.168-15.872 15.872-15.872h855.552c8.704 0 15.872 7.168 15.872 15.872v67.072c0 8.704-7.168 15.872-15.872 15.872M939.52 906.24H83.968c-8.704 0-15.872-7.168-15.872-15.872v-67.072c0-8.704 7.168-15.872 15.872-15.872h855.552c8.704 0 15.872 7.168 15.872 15.872v67.072c0 8.704-7.168 15.872-15.872 15.872M939.52 453.632H429.056c-8.704 0-15.872-7.168-15.872-15.872V370.688c0-8.704 7.168-15.872 15.872-15.872h510.464c8.704 0 15.872 7.168 15.872 15.872v67.072c0 8.704-7.168 15.872-15.872 15.872M939.52 679.936H429.056c-8.704 0-15.872-7.168-15.872-15.872v-67.072c0-8.704 7.168-15.872 15.872-15.872h510.464c8.704 0 15.872 7.168 15.872 15.872v67.072c0 8.704-7.168 15.872-15.872 15.872",fill:"#ffffff","p-id":"4837"})):m.default.createElement("svg",{t:"1588476580322",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5067",width:"200",height:"200"},m.default.createElement("path",{d:"M112.80000001 356L623.2 356c24.8 0 44.8 21.6 44.8 48s-20 48-44.8 48l-510.4 0c-24.8 0-44.8-21.6-44.8-48s20-48 44.80000001-48z m-1e-8 224L623.2 580c24.8 0 44.8 21.6 44.8 48s-20 48-44.8 48l-510.4-1e-8c-24.8 0-44.8-21.6-44.8-47.99999999s20-48 44.8-48zM116 796L900 796c26.4 0 48 21.6 48 48s-21.6 48-48 48l-784 0c-26.4 0-48-21.6-48-48s21.6-48 48-48zM724 356L948 516l-224 160 0-320zM900 236l-784 0c-26.4 0-48-21.6-48-48s21.6-48 48-48L900 140c26.4 0 48 21.6 48 48s-21.6 48-48 48z","p-id":"5068",fill:"#ffffff"}))),m.default.createElement("div",{className:_.default.tabs},a.length>0&&c&&m.default.createElement(o.default,{defaultActiveKey:"".concat(a[a.length-1].key),onChange:this.onChange,activeKey:s,type:"editable-card",onEdit:this.onEdit,hideAdd:!0},a.map(e=>{var t=e.title,a=e.podName,n=e.key,s=e.containerName;return m.default.createElement(w,{tab:m.default.createElement("div",null,m.default.createElement("span",{className:_.default.titleTab},t||a)),className:_.default.consoleBox,key:n},this.tabContent(a,s,n))})))))}},d=p))||d);t.default=y}}]);