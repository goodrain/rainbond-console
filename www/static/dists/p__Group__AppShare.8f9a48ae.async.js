(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[54],{C5h0:function(e,t,a){"use strict";var s=a("g09b"),r=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bbsP");var l=s(a("/wGt"));a("g9YV");var i=s(a("wCAj"));a("+L6B");var n=s(a("2/Rp"));a("IzEo");var o=s(a("bx4M"));a("O3gP");var d=s(a("lrIw")),p=s(a("jehZ"));a("Pwec");var c=s(a("CtXQ")),h=s(a("p0pE"));a("miYZ");var u=s(a("tsqr"));a("/xke");var m=s(a("TeRw"));a("giR+");var f=s(a("fyUT"));a("14J3");var _=s(a("BMrR"));a("jCWc");var g=s(a("kPKH"));a("sRBo");var v=s(a("kaz8"));a("/zsF");var b=s(a("PArb"));a("2qtc");var M=s(a("kLXV"));a("OaEy");var E=s(a("2fM7"));a("5NDa");var S=s(a("5rEg"));a("y8nQ");var k=s(a("Vl3Y"));a("Znn+");var y,C,x,w,P=s(a("ZTPi")),A=a("MuoO"),I=a("7DNP"),D=r(a("q1tI")),V=a("LLXN"),N=s(a("qula")),L=s(a("WnAZ")),R=s(a("XZXw")),T=a("vSx2"),F=s(a("8+Sn")),O=s(a("QDog")),q=s(a("/EMh")),B=s(a("a06M")),z=s(a("ZNrE")),X=s(a("pLWA")),j=P.default.TabPane,Z=k.default.Item,G=S.default.TextArea,U=E.default.Option,J=M.default.confirm,W={labelCol:{span:8},wrapperCol:{span:16}},Y=F.default.get("token"),Q={};Y&&(Q.Authorization="GRJWT ".concat(Y));class H extends D.PureComponent{constructor(){super(...arguments),this.state={checked:!0},this.getValue=(e=>{this.props.form.validateFields((t,a)=>{t||e(a)})}),this.handleCheckChange=((e,t,a)=>{var s={},r=t;s[e]="**None**",a.target.checked?this.props.form.setFieldsValue(s):(s[e]=r,this.props.form.setFieldsValue(s))}),this.handleIsChange=((e,t)=>{this.props.form.setFieldsValue({[e]:t.target.checked})}),this.renderConnectInfo=(()=>{var e=this.props,t=e.app,a=void 0===t?{}:t,s=e.form,r=e.ID,l=s.getFieldDecorator;return a.service_connect_info_map_list&&a.service_connect_info_map_list.length?D.default.createElement("div",{style:{marginBottom:24}},D.default.createElement("h4",{style:{marginBottom:8}},(0,V.formatMessage)({id:"appPublish.shop.pages.title.joinMsg"})),D.default.createElement(b.default,null),D.default.createElement(_.default,null,a.service_connect_info_map_list.map((e,t)=>D.default.createElement(g.default,{key:"connection_".concat(t),span:8},D.default.createElement(Z,{label:e.attr_name,style:{padding:16}},l("connect||".concat(e.attr_name,"||attr_value||").concat(r),{initialValue:e.attr_value,rules:[{required:!1}]})(D.default.createElement(S.default,{placeholder:e.attr_value})),l("connect||".concat(e.attr_name,"||random||").concat(r),{valuePropName:"checked",initialValue:"**None**"===e.attr_value})(D.default.createElement(v.default,{onChange:this.handleCheckChange.bind(this,"connect||".concat(e.attr_name,"||attr_value||").concat(r),e.attr_value)},(0,V.formatMessage)({id:"appPublish.shop.pages.title.random"})))))))):null}),this.renderEvn=(()=>{var e=this.props,t=e.app,a=void 0===t?{}:t,s=e.form,r=e.ID,l=s.getFieldDecorator;return a.service_env_map_list&&a.service_env_map_list.length?D.default.createElement("div",{style:{marginBottom:24}},D.default.createElement("h4",{style:{marginBottom:8}},(0,V.formatMessage)({id:"appPublish.shop.pages.title.environment_variable"})),D.default.createElement(b.default,null),D.default.createElement(_.default,null,a.service_env_map_list.map(e=>{var t=e.attr_name,a=e.attr_value;return D.default.createElement(g.default,{span:8},D.default.createElement(Z,{label:t,style:{padding:16}},l("env||".concat(t,"||").concat(r),{initialValue:a,rules:[{required:!1,message:(0,V.formatMessage)({id:"placeholder.copy.not_null"})}]})(D.default.createElement(S.default,null))))}))):null}),this.renderExtend=(()=>{var e=this.props,t=e.app,a=void 0===t?{}:t,s=e.ID,r=void 0===s?"extend":s,l=e.form,i=l.getFieldDecorator,n=l.getFieldValue,o={padding:16};if(a.extend_method_map){var d=n("".concat(r,"||step_node"));return D.default.createElement("div",{style:{marginBottom:24}},D.default.createElement("h4",{style:{marginBottom:8}},(0,V.formatMessage)({id:"appPublish.shop.pages.title.flexible"})),D.default.createElement(b.default,null),D.default.createElement(_.default,null,D.default.createElement(g.default,{span:8},D.default.createElement(Z,{label:(0,V.formatMessage)({id:"appPublish.shop.pages.form.label.min_node"}),style:o},i("".concat(r,"||min_node"),{initialValue:a.extend_method_map.min_node,rules:[{required:!0,message:(0,V.formatMessage)({id:"placeholder.appShare.formatError"})}]})(D.default.createElement(f.default,{style:{width:"100%"},placeholder:(0,V.formatMessage)({id:"placeholder.appShare.min_node"}),min:1,step:d||a.extend_method_map.step_node})))),D.default.createElement(g.default,{span:8},D.default.createElement(Z,{label:(0,V.formatMessage)({id:"appPublish.shop.pages.form.label.max_node"}),style:o},i("".concat(r,"||max_node"),{initialValue:a.extend_method_map.max_node,rules:[{required:!0,message:(0,V.formatMessage)({id:"placeholder.appShare.formatError"})}]})(D.default.createElement(f.default,{style:{width:"100%"},placeholder:(0,V.formatMessage)({id:"placeholder.appShare.max_node"}),min:1,step:d||a.extend_method_map.step_node})))),D.default.createElement(g.default,{span:8},D.default.createElement(Z,{label:(0,V.formatMessage)({id:"appPublish.shop.pages.form.label.step_node"}),style:o},i("".concat(r,"||step_node"),{initialValue:a.extend_method_map.step_node,rules:[{required:!0,message:(0,V.formatMessage)({id:"placeholder.appShare.formatError"})}]})(D.default.createElement(f.default,{style:{width:"100%"},placeholder:(0,V.formatMessage)({id:"placeholder.appShare.step_node"}),min:a.extend_method_map.min_node,max:a.extend_method_map.max_node})))),D.default.createElement(g.default,{span:8},D.default.createElement(Z,{label:(0,V.formatMessage)({id:"appPublish.shop.pages.form.label.init_memory"}),style:o},i("".concat(r,"||init_memory"),{initialValue:a.extend_method_map.init_memory||0,rules:[{required:!0,message:(0,V.formatMessage)({id:"placeholder.appShare.formatError"})}]})(D.default.createElement(f.default,{style:{width:"100%"},placeholder:(0,V.formatMessage)({id:"placeholder.appShare.init_memory"}),min:0,max:a.extend_method_map.max_memory,step:a.extend_method_map.step_memory})),D.default.createElement("div",{style:{color:"#999999",fontSize:"12px"}},(0,V.formatMessage)({id:"appPublish.shop.pages.form.quota0.desc"})))),D.default.createElement(g.default,{span:8},D.default.createElement(Z,{label:(0,V.formatMessage)({id:"appPublish.shop.pages.form.label.container_cpu"}),style:o},i("".concat(r,"||container_cpu"),{initialValue:a.extend_method_map.container_cpu||0,rules:[{required:!0,message:(0,V.formatMessage)({id:"placeholder.appShare.container_cpu"})},{pattern:new RegExp(/^[0-9]\d*$/,"g"),message:(0,V.formatMessage)({id:"placeholder.plugin.min_cpuMsg"})}]})(D.default.createElement(f.default,{style:{width:"100%"},min:0,placeholder:(0,V.formatMessage)({id:"placeholder.appShare.container_cpu"})})),D.default.createElement("div",{style:{color:"#999999",fontSize:"12px"}},(0,V.formatMessage)({id:"appPublish.shop.pages.form.quota1000.desc"}))))))}return null})}componentDidMount(){this.props.getref&&this.props.getref(this)}render(){return D.default.createElement(D.Fragment,null,this.renderConnectInfo(),this.renderEvn(),this.renderExtend())}}var K=(y=(0,A.connect)(e=>{var t=e.user,a=e.application,s=e.loading,r=e.enterprise,l=e.teamControl;return{currUser:t.currentUser,apps:a.apps,currentTeam:l.currentTeam,currentRegionName:l.currentRegionName,currentEnterprise:r.currentEnterprise,groupDetail:a.groupDetail||{},loading:s}}),C=k.default.create(),y(x=C((w=class extends D.PureComponent{constructor(e){super(e),this.onCancels=(()=>{this.setState({shareModal:null,dep_service_name:[]})}),this.getBase64=(e=>{return new Promise((t,a)=>{var s=new FileReader;s.readAsDataURL(e),s.onload=(()=>t(s.result)),s.onerror=(e=>a(e))})}),this.fetchRecord=(()=>{this.setState({loading:!0});var e=this.props.match.params,t=e.teamName,a=e.appID,s=e.shareId,r=this.props.dispatch;r({type:"application/fetchShareRecord",payload:{team_name:t,app_id:a,record_id:s},callback:e=>{e&&e.bean&&200===e.status_code&&this.setState({record:e.bean,loading:!1},()=>{this.fetchModels()})}})}),this.fetchModels=((e,t)=>{var a=this.state.record,s=a&&a.scope,r=a&&a.scope_target,l=this.props.match.params,i=l.teamName,n=l.appID,o=this.props,d=o.dispatch,p=o.form,c=p.setFieldsValue,h={team_name:i,app_id:n};"goodrain"===s&&r?(h.scope="goodrain",h.market_id=r.store_id):h.scope="local",this.setState({loadingModels:!0}),d({type:"enterprise/fetchShareModels",payload:h,callback:a=>{a&&200===a.status_code&&this.setState({models:a.list,model:a.bean,loadingModels:!1},()=>{if(a.list.length>0){if(t){var s=a.list.filter(e=>{return e.app_id===t.app_id});return s&&s.length>0&&(c({describe:s[0].app_describe||""}),this.setState({model:s[0]})),null}e&&c({app_id:a.list[0].app_id}),"{}"===JSON.stringify(a.bean)?this.changeCurrentModel(a.list[0].app_id):this.changeCurrentModel(e?a.list[0].app_id:a.bean&&a.bean.app_id,e?"":a.bean&&a.bean.version,e)}})}})}),this.fetchAppDetail=(()=>{var e=this.props.dispatch,t=this.props.match.params,a=t.teamName,s=t.regionName,r=t.appID;this.setState({loadingDetail:!0}),e({type:"application/fetchGroupDetail",payload:{team_name:a,region_name:s,group_id:r},callback:e=>{e&&200===e.status_code&&this.setState({appDetail:e.bean,loadingDetail:!1})},handleError:e=>{e&&404===e.code&&this.props.dispatch(I.routerRedux.push("/team/".concat(O.default.getCurrTeamName(),"/region/").concat(O.default.getCurrRegionName(),"/apps")))}})}),this.handleSubmitConditions=(()=>{var e=this.state,t=e.record,a=e.versionInfo,s=this.props.form;s.validateFieldsAndScroll({scroll:{offsetTop:80}},(e,s)=>{e||("goodrain"!==t.scope&&a&&s.version===a.version&&a.dev_status?J({title:(0,V.formatMessage)({id:"appPublish.shop.pages.confirm.title"}),content:"",okText:(0,V.formatMessage)({id:"popover.confirm"}),cancelText:(0,V.formatMessage)({id:"popover.cancel"}),onOk:()=>{this.handleSubmit()}}):this.handleSubmit())})}),this.handleSubmit=(()=>{var e=this.props,t=e.dispatch,a=e.form,s=this.state,r=s.record,l=s.sharearrs,i=s.share_service_list,n=(s.isAppPlugin,s.share_k8s_resources),o={};a.validateFields((e,a)=>{if(!e){this.setState({submitLoading:!0});var s={share_id:r.record_id,app_model_id:a.app_id,describe:a.describe,version:a.version,version_alias:a.version_alias,is_plugin:a.is_plugin};"goodrain"===r.scope&&(s.scope_target=r.scope_target,s.scope=r.scope,s.market_id=r.scope_target&&r.scope_target.store_id,s.template_type="RAM");var d=i;i.map((e,t)=>{var s=e.extend_method_map,r=e.service_id;return s&&Object.keys(s).forEach(function(e){a["".concat(r,"||").concat(e)]&&(d[t].extend_method_map[e]=a["".concat(r,"||").concat(e)])}),e});var p=[],c=[];l.map(e=>{return d.map(t=>{return e===t.service_share_uuid&&(p.push(t),t.dep_service_map_list&&t.dep_service_map_list.length>0&&t.dep_service_map_list.map(e=>{c.push(e.dep_service_key)})),e}),e});var h=this.com;h.map(e=>{var t=e.props.tab,a=null;e.props.form.validateFields((e,t)=>{e||(a=t)}),d.map(e=>{var s=e.service_id;if(e.service_alias==t){var r=function(t){var r=[];r=t.split("||");var l=r&&r.length>0&&r[0];if(l){var i="connect"===l,n="env"===l;i&&"random"!=r[2]&&e.service_connect_info_map_list.map(e=>{i&&"random"!=r[2]&&e.attr_name==r[1]&&s===r[3]&&(e[r[2]]=a[t],e.is_change=!0)}),n&&e.service_env_map_list.map(e=>{var l=e.attr_name;l===r[1]&&s===r[2]&&n&&(e.attr_value=a[t],e.is_change=!0)}),"extend"===l&&(e.extend_method_map[r[1]]=a[t])}};for(var l in a)r(l)}})}),o.app_version_info=s,o.share_service_list=p,o.share_plugin_list=this.state.plugin_list,o.share_k8s_resources=n;var u=O.default.getCurrTeamName(),f=this.props.match.params,_=f.appID,g=f.shareId;t({type:"application/subShareInfo",payload:{team_name:u,share_id:g,use_force:!0,new_info:o},callback:e=>{this.setState({submitLoading:!1}),e&&t(I.routerRedux.push("/team/".concat(O.default.getCurrTeamName(),"/region/").concat(O.default.getCurrRegionName(),"/apps/").concat(_,"/share/").concat(g,"/two?isAppPlugin=").concat(s.is_plugin)))},handleError:e=>{this.setState({submitLoading:!1});var t=e&&e.data,a=t&&t.msg_show;if(t&&t.code&&10501===t.code)return m.default.warning({message:(0,V.formatMessage)({id:"confirmModal.component.hint"}),description:a}),this.setState({isShare:"true"}),null;m.default.warning({message:(0,V.formatMessage)({id:"confirmModal.component.request_Error"}),description:a})}})}})}),this.handleGiveup=(()=>{var e=this.props.match.params.appID,t=this.props.dispatch;t({type:"application/giveupShare",payload:{team_name:O.default.getCurrTeamName(),share_id:this.props.match.params.shareId},callback:()=>{t(I.routerRedux.push("/team/".concat(O.default.getCurrTeamName(),"/region/").concat(O.default.getCurrRegionName(),"/apps/").concat(e)))}})}),this.handleLogoChange=(e=>{var t=e.fileList;this.setState({fileList:t})}),this.handleLogoRemove=(()=>{this.setState({fileList:[]})}),this.save=(e=>{this.com.push(e)}),this.tabClick=(e=>{this.setState({tabk:e})}),this.showCreateAppModel=(()=>{this.setState({showCreateAppModel:!0})}),this.hideCreateAppModel=(()=>{this.setState({showCreateAppModel:!1})}),this.handleCreateAppModel=(()=>{m.default.success({message:(0,V.formatMessage)({id:"notification.success.setUp"})}),this.fetchModels(!0),this.hideCreateAppModel()}),this.handleCancel=(()=>this.setState({previewVisible:!1})),this.changeCurrentVersion=(e=>{var t=this.state.model;t&&t.versions&&t.versions.length>0&&t.versions.map(t=>{e===t.version&&this.handleSetFieldsValue(t)})}),this.changeCurrentModel=((e,t,a)=>{var s=this.state.models;s&&s.length>0&&s.map(s=>{var r=s.app_id,l=s.versions;return e===r&&this.setState({model:s,versions:l},()=>{if(l&&l.length>0){var e=l[0];t&&l.map(a=>{var r=a.version;return r===t&&(e=a),s}),this.handleSetFieldsValue(e,a)}else this.handleSetFieldsValue(s,a)}),s})}),this.handleSetFieldsValue=((e,t)=>{var a=this.props.form.setFieldsValue;this.setState({versionInfo:e}),a({version:t?"0.1":e?e.version:""}),a({version_alias:e?e.version_alias:""}),a({describe:e?e.describe||e.app_describe:""})}),this.handleEditorAppModel=(e=>{m.default.success({message:(0,V.formatMessage)({id:"notification.success.edit"})}),this.fetchModels(!1,e),this.hideEditorAppModel()}),this.showEditorAppModel=(e=>{var t=this.state.models,a=t.filter(t=>{return t.app_id===e});a&&a.length>0&&this.setState({appModelInfo:a[0],editorAppModel:!0})}),this.hideEditorAppModel=(()=>{this.setState({editorAppModel:!1,appModelInfo:!1})}),this.checkVersion=((e,t,a)=>{""!==t&&t||a((0,V.formatMessage)({id:"placeholder.appShare.versions_notNull"})),!t||/^[0-9]+(\.[0-9]+){1,2}$/.test(t)?a():a((0,V.formatMessage)({id:"placeholder.appShare.layout_grid_mode"}))}),this.removeComponent=(e=>{var t=this.state.share_service_list,a=[];1!==t.length?(t.map(t=>{return t.dep_service_map_list.map(s=>{return s.dep_service_key===e&&a.push(t.service_cname),s}),t}),a.length>0?this.setState({del_component_share_key:e,dep_service_name:a,shareModal:!0}):this.removeComponentReal(e)):u.default.info((0,V.formatMessage)({id:"placeholder.appShare.leastOne"}))}),this.removeComponentReal=(e=>{var t=this.state,a=t.share_service_list,s=t.tabk,r=a.filter(t=>t.service_share_uuid!==e);s!==e?this.setState({share_service_list:r},()=>{this.update_publish_plugins()}):this.setState({share_service_list:r,tabk:r.length>0&&r[0].service_share_uuid},()=>{this.update_publish_plugins()})}),this.update_publish_plugins=(()=>{var e=this.state,t=e.share_service_list,a=e.info,s=[];if(t.map(e=>{return e.service_related_plugin_config&&e.service_related_plugin_config.map(e=>s.push(e.plugin_id)),e}),a.share_plugin_list){var r=a.share_plugin_list.filter(e=>s.indexOf(e.plugin_id)>-1);this.setState({plugin_list:r})}}),this.updateSelectComponents=(e=>{var t=this.state,a=t.info,s=t.tabk,r=a.share_service_list.filter(t=>e.indexOf(t.service_share_uuid)>-1);e.indexOf(s)>-1?this.setState({batchEditShow:!1,share_service_list:r},()=>{this.update_publish_plugins()}):this.setState({batchEditShow:!1,share_service_list:r,tabk:r.length>0&&r[0].service_share_uuid},()=>{this.update_publish_plugins()})}),this.getPageContent=(e=>{this.setState({currentPage:e})}),this.onClose=(()=>{this.setState({showDrawerSwitchVal:!1})}),this.showDrawer=((e,t)=>{this.setState({k8sContent:e,k8sName:t.name,showDrawerSwitchVal:!this.state.showDrawerSwitchVal})}),this.state={previewVisible:!1,previewImage:"",toDelete:!1,recordShare:!1,checkShare:!0,ShareStep:0,ID:0,info:null,selectedApp:"",service:null,tabk:"",fileList:[],shareList:[],sharearrs:[],shareModal:null,isShare:"false",service_cname:"",dep_service_name:[],share_service_list:[],share_k8s_resources:[],ShareTypeShow:!1,scopeValue:"goodrain:private",appDetail:{},record:{},model:{},submitLoading:!1,loadingModels:!0,models:[],versions:[],versionInfo:!1,editorAppModel:!1,appModelInfo:!1,batchEditShow:!1,selectComponentID:[],allSelect:!1,isAppPlugin:null,currentPage:1,showDrawerSwitchVal:!1,k8sContent:"",k8sName:""},this.com=[],this.share_group_info=null}componentDidMount(){this.fetchAppDetail(),this.fetchRecord(),this.getShareInfo()}getParams(){return{groupId:this.props.match.params.appID,shareId:this.props.match.params.shareId}}getShareInfo(){var e=this.props.dispatch,t=this.getParams();e({type:"application/getShareInfo",payload:(0,h.default)({team_name:O.default.getCurrTeamName()},t),callback:e=>{var t="";if(e&&(e.bean.share_service_list[0]&&(t=e.bean.share_service_list[0].service_alias),this.setState({info:e.bean,plugin_list:e.bean.share_plugin_list,selectedApp:t,tabk:e.bean.share_service_list[0].service_share_uuid,share_service_list:e.bean.share_service_list,share_k8s_resources:e.bean.share_k8s_resources}),e.bean.share_service_list&&e.bean.share_service_list.length>0)){var a=e.bean.share_service_list.map(e=>e.service_share_uuid);this.setState({shareList:a,sharearrs:a})}},handleError:e=>{e&&404===e.status&&this.props.dispatch(I.routerRedux.push("/team/".concat(O.default.getCurrTeamName(),"/region/").concat(O.default.getCurrRegionName(),"/exception/404")))}})}render(){var e=this.state,t=e.info,a=e.tabk,s=e.share_service_list,r=e.plugin_list,h=e.share_k8s_resources,u=e.currentPage,m=e.k8sContent,f=e.k8sName;if(!t)return null;var y=s||[],C=r||[],x=this.props,w=x.loading,A=x.form,I=x.currentEnterprise,F=x.currentTeam,O=x.currentRegionName,Z=A.getFieldDecorator,J=A.getFieldValue,Y=A.setFieldsValue,Q=this.state,K=Q.shareModal,$=Q.dep_service_name,ee=Q.models,te=Q.appDetail,ae=Q.showCreateAppModel,se=Q.editorAppModel,re=Q.model,le=Q.record,ie=Q.versionInfo,ne=Q.versions,oe=Q.submitLoading,de=Q.appModelInfo,pe=Q.batchEditShow,ce=J("app_id"),he=[];he=(0,T.createApp)((0,T.createTeam)((0,T.createEnterprise)(he,I),F,O),F,O,{appName:te.group_name,appID:te.group_id}),he.push({title:(0,V.formatMessage)({id:"appPublish.btn.record.list.title"}),href:"/team/".concat(F.team_name,"/region/").concat(O,"/apps/").concat(te.group_id,"/publish")}),le&&"goodrain"===le.scope?he.push({title:(0,V.formatMessage)({id:"appPublish.btn.market"})}):he.push({title:(0,V.formatMessage)({id:"appPublish.btn.local"})});var ue=le.scope_target&&le.scope_target.store_id,me=le.scope_target&&le.scope_target.store_version,fe=5,_e=h&&h.length||0,ge=(Math.ceil(_e/fe),h&&h.slice((u-1)*fe,u*fe)),ve={onChange:this.getPageContent,total:_e,pageSize:fe};return D.default.createElement(R.default,{breadcrumbList:he},D.default.createElement("div",null,D.default.createElement(o.default,{style:{marginBottom:24},title:(0,V.formatMessage)({id:"appPublish.btn.record.list.title.versions"}),bordered:!1,bodyStyle:{padding:0}},D.default.createElement("div",{style:{padding:"24px"}},D.default.createElement(_.default,{gutter:24},D.default.createElement(g.default,{span:"12"},D.default.createElement(k.default.Item,(0,p.default)({},W,{label:(0,V.formatMessage)({id:"appPublish.btn.record.list.title.appMode"})}),Z("app_id",{initialValue:re.app_id,rules:[{required:!0,message:(0,V.formatMessage)({id:"placeholder.appShare.appTemplate"})}]})(D.default.createElement(E.default,{getPopupContainer:e=>e.parentNode,style:{width:280},onChange:this.changeCurrentModel,placeholder:(0,V.formatMessage)({id:"placeholder.appShare.selectAppTemplate"}),dropdownRender:e=>D.default.createElement("div",null,e,D.default.createElement(b.default,{style:{margin:"4px 0"}}),D.default.createElement("div",{style:{padding:"4px 8px",cursor:"pointer",textAlign:"center"},onMouseDown:e=>e.preventDefault(),onClick:this.showCreateAppModel},D.default.createElement(c.default,{type:"plus"}),(0,V.formatMessage)({id:"appPublish.btn.record.list.label.newAppTemplate"})))},ee.map(e=>D.default.createElement(U,{key:e.app_id},e.app_name)))),ce&&ee&&ee.length>0&&!ue&&D.default.createElement("a",{style:{marginLeft:"10px"},onClick:()=>{this.showEditorAppModel(ce)}},(0,V.formatMessage)({id:"appPublish.btn.record.list.label.deitAppTemplate"})))),D.default.createElement(g.default,{span:"12"},D.default.createElement(k.default.Item,(0,p.default)({},W,{label:(0,V.formatMessage)({id:"appPublish.btn.record.list.label.version"})}),Z("version",{initialValue:ie&&ie.version||"",rules:[{required:!0,validator:this.checkVersion}]})(D.default.createElement(d.default,{style:{width:280},onChange:this.changeCurrentVersion,placeholder:(0,V.formatMessage)({id:"placeholder.appShare.version"})},ne&&ne.length>0&&ne.map((e,t)=>{var a=e.version;return D.default.createElement(d.default.Option,{key:"version".concat(t),value:a},a)}))))),D.default.createElement(g.default,{span:"12"},D.default.createElement(k.default.Item,(0,p.default)({},W,{label:(0,V.formatMessage)({id:"appPublish.btn.record.list.label.version_alias"})}),Z("version_alias",{initialValue:ie&&ie.version_alias||"",rules:[{max:64,message:(0,V.formatMessage)({id:"placeholder.appShare.max64"})}]})(D.default.createElement(S.default,{style:{width:280},placeholder:(0,V.formatMessage)({id:"placeholder.appShare.version_alias"})}))),D.default.createElement(k.default.Item,(0,p.default)({},W,{label:(0,V.formatMessage)({id:"appPublish.btn.record.list.label.is_plugin"})}),Z("is_plugin",{initialValue:ie&&ie.is_plugin||!1})(C.length>0?D.default.createElement(v.default,null):D.default.createElement(v.default,{disabled:!0})))),D.default.createElement(g.default,{span:"12",style:{height:"104px"}},D.default.createElement(k.default.Item,(0,p.default)({},W,{label:(0,V.formatMessage)({id:"appPublish.btn.record.list.label.describe"})}),Z("describe",{initialValue:ie&&(ie.describe||ie.app_describe)||"",rules:[{max:255,message:(0,V.formatMessage)({id:"placeholder.max255"})}]})(D.default.createElement(G,{placeholder:(0,V.formatMessage)({id:"placeholder.appShare.describe"}),style:{height:"70px"}}))))))),D.default.createElement(o.default,{style:{marginBottom:24},title:(0,V.formatMessage)({id:"appPublish.btn.record.list.title.publish_component_config"}),bordered:!1,bodyStyle:{padding:0}},D.default.createElement("div",{style:{padding:"24px"}},D.default.createElement("div",{className:X.default.mytab},D.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"16px",lineHeight:"32px"}},D.default.createElement("h4",{className:X.default.required,style:{marginBottom:0}},(0,V.formatMessage)({id:"appPublish.btn.record.list.title.edit_publish_componentMsg"}),"}"),D.default.createElement(n.default,{style:{float:"right"},onClick:()=>{this.setState({batchEditShow:!0})}},(0,V.formatMessage)({id:"appPublish.btn.record.list.title.bulk_edit"}))),D.default.createElement("div",{className:X.default.mytabtit,id:"mytabtit"},D.default.createElement(P.default,{type:"editable-card",hideAdd:!0,activeKey:a,onChange:this.tabClick,onEdit:(e,t)=>{"remove"===t&&this.removeComponent(e)}},y.map(e=>{var t=e.service_share_uuid;return D.default.createElement(j,{key:t,tab:D.default.createElement("span",{className:X.default.cont},D.default.createElement("a",{tab:e.service_cname,onClick:()=>{this.tabClick(t)}},e.service_cname))},D.default.createElement(H,{key:t,form:A,app:e,getref:this.save,tab:e.service_alias,ID:e.service_id}))})))))),D.default.createElement(o.default,{style:{marginBottom:24},title:(0,V.formatMessage)({id:"appPublish.btn.record.list.title.publish_pluginMsg"}),bordered:!1},D.default.createElement(i.default,{size:"middle",dataSource:C,columns:[{title:(0,V.formatMessage)({id:"appPublish.btn.record.list.table.plugin_alias"}),dataIndex:"plugin_alias"},{title:(0,V.formatMessage)({id:"appPublish.btn.record.list.table.category"}),dataIndex:"category",render:e=>{return q.default.getCategoryCN(e)}},{title:(0,V.formatMessage)({id:"appPublish.btn.record.list.table.build_version"}),dataIndex:"build_version"}]})),D.default.createElement(o.default,{style:{marginBottom:128},title:(0,V.formatMessage)({id:"appPublish.btn.record.list.title.k8s"}),bordered:!1},D.default.createElement(i.default,{size:"middle",dataSource:ge,columns:[{title:(0,V.formatMessage)({id:"appPublish.btn.record.list.table.name"}),dataIndex:"name",key:"name",align:"left"},{title:(0,V.formatMessage)({id:"appPublish.btn.record.list.table.kind"}),dataIndex:"kind",key:"kind",align:"left"},{title:(0,V.formatMessage)({id:"appPublish.btn.record.list.table.content"}),dataIndex:"content",key:"content",align:"center",render:(e,t)=>{return D.default.createElement(D.default.Fragment,null,D.default.createElement(n.default,{onClick:()=>this.showDrawer(e,t)},(0,V.formatMessage)({id:"appPublish.btn.record.list.table.view_details"})))}}],pagination:ve})),D.default.createElement(l.default,{title:(0,V.formatMessage)({id:"appPublish.btn.record.list.title.detailMsg"}),placement:"right",closable:!0,onClose:this.onClose,visible:this.state.showDrawerSwitchVal,width:500},D.default.createElement(z.default,{setFieldsValue:Y,Form:k.default,style:{marginBottom:"20px"},getFieldDecorator:Z,data:m||"",name:f,mode:"yaml",isUpload:!1,disabled:!0})),K&&D.default.createElement(M.default,{title:(0,V.formatMessage)({id:"appPublish.btn.record.list.title.check"}),visible:K,onOk:()=>{this.removeComponentReal(this.state.del_component_share_key),this.onCancels()},onCancel:this.onCancels,okText:(0,V.formatMessage)({id:"popover.confirm"}),cancelText:(0,V.formatMessage)({id:"popover.cancel"})},D.default.createElement("div",null,(0,V.formatMessage)({id:"appPublish.btn.record.list.pages.needPublish"}),$&&$.length>0&&$.map((e,t)=>{return D.default.createElement("span",{style:{marginLeft:"5px",color:"#4d73b1"},key:t},e)}),(0,V.formatMessage)({id:"appPublish.btn.record.list.pages.componentPublish"}))),pe&&D.default.createElement(B.default,{allcomponents:t.share_service_list,components:y,onCancel:()=>{this.setState({batchEditShow:!1})},onOk:this.updateSelectComponents}),ae&&D.default.createElement(N.default,{title:(0,V.formatMessage)({id:"appPublish.btn.record.list.pages.createAppTemplate"}),appName:te&&te.group_name,eid:I.enterprise_id,onOk:this.handleCreateAppModel,defaultScope:"team",marketId:ue,marketVersion:me,onCancel:this.hideCreateAppModel}),se&&D.default.createElement(N.default,{title:(0,V.formatMessage)({id:"appPublish.btn.record.list.pages.editAppTemplate"}),team_name:F.team_name,appInfo:de,eid:I.enterprise_id,onOk:this.handleEditorAppModel,defaultScope:"team",onCancel:this.hideEditorAppModel}),D.default.createElement(L.default,null,D.default.createElement(n.default,{type:"primary",htmlType:"submit",loading:oe,onClick:this.handleSubmitConditions},(0,V.formatMessage)({id:"button.submit"})),D.default.createElement(n.default,{disabled:w.effects["application/giveupShare"],onClick:this.handleGiveup},(0,V.formatMessage)({id:"button.give_up_release"})))))}},x=w))||x)||x);t.default=K},a06M:function(e,t,a){"use strict";var s=a("tAuX"),r=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(a("q1tI"));a("2qtc");var i=r(a("kLXV"));a("+L6B");var n=r(a("2/Rp"));a("/zsF");var o=r(a("PArb"));a("sRBo");var d=r(a("kaz8"));a("miYZ");var p=r(a("tsqr"));a("y8nQ");var c,h,u,m=r(a("Vl3Y")),f=a("LLXN"),_=(c=m.default.create(),c((u=class extends l.PureComponent{constructor(e){super(e),this.setOptions=(()=>{var e=this.props,t=e.components,a=e.allcomponents;if(t){var s=t.map(e=>e.service_share_uuid),r=a.map(e=>e.service_share_uuid);this.setState({allOptions:r,checkedList:s,checkAll:r.length===s.length,indeterminate:!!s.length&&s.length<r.length})}}),this.batchEdit=(()=>{var e=this.state.checkedList;if(e.length<1)p.default.info((0,f.formatMessage)({id:"placeholder.appShare.leastOne"}));else{var t=this.props.onOk;t&&t(e)}}),this.onChange=(e=>{if(e.length<1)p.default.info((0,f.formatMessage)({id:"placeholder.appShare.retain"}));else{var t=this.state.allOptions;this.setState({checkedList:e,indeterminate:!!e.length&&e.length<t.length,checkAll:e.length===t.length})}}),this.onCheckAllChange=(e=>{var t=this.state.allOptions;this.setState({checkedList:e.target.checked?t:[],indeterminate:!1,checkAll:e.target.checked})}),this.state={indeterminate:!0,checkAll:!1,checkedList:[],allOptions:[]}}componentDidMount(){this.setOptions()}render(){var e=this.state,t=e.indeterminate,a=e.checkAll,s=e.checkedList,r=this.props,p=r.allcomponents,c=r.onCancel;return l.default.createElement(i.default,{title:(0,f.formatMessage)({id:"appPublish.btn.record.list.title.bulk_editPublish"}),visible:!0,maskClosable:!1,onOk:this.batchEdit,onCancel:c,okText:(0,f.formatMessage)({id:"popover.confirm"}),cancelText:(0,f.formatMessage)({id:"popover.cancel"})},l.default.createElement(d.default,{indeterminate:t,onChange:this.onCheckAllChange,checked:a},(0,f.formatMessage)({id:"appPublish.btn.record.list.pages.selectAll"})),l.default.createElement(o.default,null),l.default.createElement(d.default.Group,{style:{width:"100%",display:"flex",flexFlow:"row wrap"},onChange:this.onChange,value:s},p.map(e=>{return l.default.createElement("div",{style:{padding:"8px",flex:"0 0 50%"}},l.default.createElement(n.default,{style:{width:"100%",textAlign:"left",overflow:"hidden",padding:0}},l.default.createElement(d.default,{checked:!0,value:e.service_share_uuid,style:{width:"100%",marginRight:"10px",padding:"5px 15px"}},e.service_cname)))})))}},h=u))||h),g=_;t.default=g},pLWA:function(e,t,a){e.exports={mytabtit:"mytabtit___3DE4w",cont:"cont___296Gw",required:"required___25zA8"}}}]);