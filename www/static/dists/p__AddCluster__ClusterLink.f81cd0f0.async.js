(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{Zw3B:function(e,t,a){"use strict";var r=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var n=r(a("bx4M"));a("+L6B");var o=r(a("2/Rp"));a("jCWc");var i=r(a("kPKH"));a("5NDa");var l=r(a("5rEg"));a("14J3");var d=r(a("BMrR"));a("bP8k");var u=r(a("gFTJ"));a("fOrg");var c=r(a("+KLJ")),f=r(a("jehZ"));a("/xke");var g=r(a("TeRw")),p=r(a("p0pE"));a("y8nQ");var m,C,h,y,v=r(a("Vl3Y")),E=r(a("18gR")),k=a("MuoO"),S=a("7DNP"),M=s(a("q1tI")),b=a("LLXN"),R=r(a("AklW")),x=(m=(0,k.connect)(),C=v.default.create(),m(h=C((y=class extends M.PureComponent{constructor(e){super(e),this.createClusters=(()=>{var e,t=this.props,a=t.dispatch,r=t.eid,s=t.form,n=t.selectClusterID,o=t.selectProvider,i=this.state,l=i.configsYaml,d=i.task;switch(o){case"ack":e="".concat((0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.staackrt"}));break;case"tke":e="".concat((0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.tke"}));break;case"custom":e="".concat((0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.custom"}));break;case"rke":e="".concat((0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.rke"}));break;default:e="".concat((0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.Self"}))}s.validateFields((t,s)=>{t||(this.setState({commitloading:!0}),a({type:"region/createEnterpriseCluster",payload:(0,p.default)({},s,{enterprise_id:r,desc:e,token:l,region_type:["custom"],provider:o,providerClusterID:n}),callback:e=>{e&&200===e._condition&&(g.default.success({message:(0,b.formatMessage)({id:"notification.success.add"})}),a(d?{type:"cloud/updateInitTaskStatus",payload:{enterprise_id:r,taskID:d.taskID,status:"complete"},callback:()=>{a(S.routerRedux.push("/enterprise/".concat(r,"/clusters")))},handleError:e=>{404==e.data.code?a(S.routerRedux.push("/enterprise/".concat(r,"/clusters"))):R.default.handleCloudAPIError(e),this.setState({commitloading:!1})}}:S.routerRedux.push("/enterprise/".concat(r,"/clusters"))))},handleError:e=>{R.default.handleCloudAPIError(e),this.setState({commitloading:!1})}}))})}),this.loadRegionConfig=(()=>{var e=this.props,t=e.dispatch,a=e.eid,r=e.selectClusterID,s=e.selectProvider;t({type:"cloud/loadRegionConfig",payload:{enterprise_id:a,clusterID:r,providerName:s},callback:e=>{e&&this.setState({configs:e.configs,configsYaml:e.configs_yaml,loading:!1})},handleError:e=>{R.default.handleCloudAPIError(e),this.setState({loading:!1})}})}),this.loadTask=(()=>{var e=this.props,t=e.dispatch,a=e.eid,r=e.selectClusterID,s=e.selectProvider;t({type:"cloud/loadInitRainbondTask",payload:{enterprise_id:a,clusterID:r,providerName:s},callback:e=>{e&&(this.setState({task:e}),this.loadRegionConfig())},handleError:e=>{e.data&&404===e.data.code?this.loadRegionConfig():(R.default.handleCloudAPIError(e),this.setState({loading:!1}))}})}),this.handleNewbieGuiding=(e=>{var t=e.prevStep,a=e.nextStep,r=e.handleClick,s=void 0===r?()=>{}:r;return M.default.createElement(E.default,(0,f.default)({},e,{totals:14,handlePrev:()=>{t&&this.handleGuideStep(t)},handleClose:()=>{this.handleGuideStep("close")},handleNext:()=>{a&&(s(),this.handleGuideStep(a))}}))}),this.handleGuideStep=(e=>{this.setState({guideStep:e})}),this.state={loading:!0,configs:{},guideStep:13,task:null}}componentDidMount(){this.loadTask()}render(){var e,t=this.props,a=t.selectProvider,r=t.form,s=this.state,f=s.configs,g=s.loading,p=s.commitloading,m=s.guideStep,C=r.getFieldDecorator;switch(a){case"ack":e="".concat((0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.ali"}));break;case"tke":e="".concat((0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.tenxun"}));break;case"custom":e="".concat((0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.docking"}));break;case"rke":e="".concat((0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.Self"}));break;default:e="".concat((0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.Self"}))}var h={position:"relative",zIndex:1e3,padding:"0 16px",margin:"0 -16px",background:"#fff"};return M.default.createElement(v.default,null,M.default.createElement(n.default,{loading:g,bordered:!1,style:{padding:"0 16px"}},M.default.createElement(d.default,null,!f.apiAddress&&M.default.createElement(c.default,{message:M.default.createElement(b.FormattedMessage,{id:"enterpriseColony.SetRegionConfig.state"}),type:"error"}),f.apiAddress&&M.default.createElement(u.default,null,M.default.createElement(u.default.Item,{label:M.default.createElement(b.FormattedMessage,{id:"enterpriseColony.SetRegionConfig.api"})},M.default.createElement("div",{style:{display:"flex",alignItems:"center"}},f.apiAddress,M.default.createElement(c.default,{style:{marginLeft:"20px"},message:M.default.createElement(b.FormattedMessage,{id:"enterpriseColony.SetRegionConfig.ip"}),type:"warning"}))))),M.default.createElement(d.default,{style:{marginTop:"32px"}},M.default.createElement("h4",null,M.default.createElement(b.FormattedMessage,{id:"enterpriseColony.SetRegionConfig.setting"}))),M.default.createElement(d.default,{style:13===m?h:{}},M.default.createElement(i.default,{span:6,style:{paddingRight:"16px"}},M.default.createElement(v.default.Item,{label:M.default.createElement(b.FormattedMessage,{id:"enterpriseColony.SetRegionConfig.id"})},C("region_name",{initialValue:"",rules:[{required:!0,message:(0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.input_id"})},{pattern:/^[a-z0-9A-Z-_]+$/,message:(0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.only"})}]})(M.default.createElement(l.default,{placeholder:(0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.input_id"})})))),M.default.createElement(i.default,{span:6},M.default.createElement(v.default.Item,{label:M.default.createElement(b.FormattedMessage,{id:"applicationMarket.CreateHelmAppModels.colony"})},C("region_alias",{initialValue:e,rules:[{required:!0,message:(0,b.formatMessage)({id:"enterpriseColony.BaseAddCluster.name"})},{max:24,message:(0,b.formatMessage)({id:"enterpriseColony.addCluster.host.max"})}]})(M.default.createElement(l.default,{placeholder:(0,b.formatMessage)({id:"enterpriseColony.BaseAddCluster.name"})}))))),13===m&&this.handleNewbieGuiding({tit:(0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.success"}),desc:(0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.input"}),send:!1,configName:"clusterDocking",showSvg:!1,showArrow:!0,nextStep:14}),M.default.createElement(d.default,null,M.default.createElement(i.default,{style:{textAlign:"center",marginTop:"32px"},span:24},M.default.createElement(o.default,{loading:p,onClick:this.createClusters,disabled:!f.apiAddress,type:"primary"},M.default.createElement(b.FormattedMessage,{id:"button.Docking"})),14===m&&this.handleNewbieGuiding({tit:(0,b.formatMessage)({id:"enterpriseColony.SetRegionConfig.start"}),btnText:(0,b.formatMessage)({id:"button.Docking"}),send:!0,configName:"clusterDocking",nextStep:15,handleClick:()=>{f.apiAddress&&this.createClusters()},conPosition:{left:"50%",bottom:"-138px"},svgPosition:{left:"50%",marginTop:"-11px"}})))))}},h=y))||h)||h);t.default=x},sExd:function(e,t,a){"use strict";var r=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var n=r(a("bx4M"));a("14J3");var o=r(a("BMrR"));a("y8nQ");var i=r(a("Vl3Y"));a("FJo9");var l,d,u,c,f=r(a("L41K")),g=a("MuoO"),p=a("7DNP"),m=s(a("q1tI")),C=r(a("Zw3B")),h=a("LLXN"),y=r(a("XZXw")),v=r(a("+iC2")),E=f.default.Step,k=(l=i.default.create(),d=(0,g.connect)(e=>{var t=e.user,a=e.list,r=e.loading,s=e.global,n=e.index;return{user:t.currentUser,list:a,loading:r.models.list,rainbondInfo:s.rainbondInfo,enterprise:s.enterprise,isRegist:s.isRegist,oauthLongin:r.effects["global/creatOauth"],overviewInfo:n.overviewInfo}}),l(u=d((c=class extends m.PureComponent{constructor(e){super(e),this.loadSteps=(()=>{var e=[{title:(0,h.formatMessage)({id:"enterpriseColony.addCluster.supplier"})},{title:(0,h.formatMessage)({id:"enterpriseColony.addCluster.cluster"})},{title:(0,h.formatMessage)({id:"enterpriseColony.addCluster.Initialize"})},{title:(0,h.formatMessage)({id:"enterpriseColony.addCluster.docking"})}];return e});var t=this.props.user,a=v.default.isCompanyAdmin(t);this.state={adminer:a}}componentWillMount(){var e=this.state.adminer,t=this.props.dispatch;e||t(p.routerRedux.push("/"))}componentDidMount(){}render(){var e=this.props.match.params,t=e.eid,a=e.provider,r=e.clusterID;return m.default.createElement(y.default,{title:m.default.createElement(h.FormattedMessage,{id:"enterpriseColony.button.text"}),content:m.default.createElement(h.FormattedMessage,{id:"enterpriseColony.PageHeaderLayout.content"})},m.default.createElement(o.default,{style:{marginBottom:"16px"}},m.default.createElement(f.default,{current:3},this.loadSteps().map(e=>m.default.createElement(E,{key:e.title,title:e.title})))),m.default.createElement(n.default,null,m.default.createElement(o.default,{style:{marginBottom:"16px"}},m.default.createElement(C.default,{eid:t,selectProvider:a,selectClusterID:r}))))}},u=c))||u)||u);t.default=k}}]);