(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[69],{p1oR:function(e,t,a){"use strict";var r=a("g09b"),s=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var n=r(a("BMrR"));a("jCWc");var u=r(a("kPKH"));a("fOrg");var i=r(a("+KLJ"));a("miYZ");var o=r(a("tsqr")),d=r(a("p0pE"));a("y8nQ");var l,c,f,h,p=r(a("Vl3Y")),m=a("MuoO"),_=a("7DNP"),v=s(a("q1tI")),g=r(a("8+Sn")),b=r(a("mWxT")),E=r(a("5WY0")),y=r(a("dYZ0")),k=b.default.OauthParameter("oauth_user_id"),w=b.default.OauthParameter("code"),R=b.default.OauthParameter("service_id"),x="/user/login?disable_auto_login=true",I=(l=(0,m.connect)(e=>{var t=e.user,a=e.global;return{register:t.register,rainbondInfo:a.rainbondInfo,isRegist:a.isRegist}}),c=p.default.create(),l(f=c((h=class extends v.Component{constructor(){super(...arguments),this.state={user_info:null},this.handleSubmit=(e=>{var t=this.props.dispatch;w&&R&&k&&t({type:"user/thirdRegister",payload:(0,d.default)({},e),callback:e=>{e&&""!==e.token?(g.default.set("token",e.token),t({type:"user/fetchThirdBinding",payload:{service_id:R,oauth_user_id:k},callback:e=>{e&&200===e.status_code?o.default.success("\u8ba4\u8bc1\u6210\u529f",1,()=>{var e=window.localStorage.getItem("redirect");e&&""!==e||(e="/"),e.startsWith("/")?t(_.routerRedux.push(e)):window.location.href=e}):this.handleError()},handleError:()=>{this.handleError()}})):this.handleError()}})}),this.handleError=(()=>{var e=this.props.dispatch;o.default.warning("\u8ba4\u8bc1\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u8ba4\u8bc1",1,()=>{e(_.routerRedux.push(x))})})}componentDidMount(){this.props.dispatch({type:"user/fetchThirdInfo",payload:{code:w,service_id:R},callback:e=>{e&&200===e.status_code&&this.setState({user_info:e.bean.user_info})}})}render(){var e=this.props,t=e.isRegist,a=e.dispatch,r=e.rainbondInfo;if(!t)return a(_.routerRedux.replace(w&&R&&k?"/user/login?code=".concat(w,"&service_id=").concat(R):x)),null;var s=this.state.user_info,o=!b.default.fetchIsFirstRegist(r),d=null;b.default.OauthbEnable(r)&&r.oauth_services&&r.oauth_services.value&&r.oauth_services.value.map(e=>{return e.service_id===R&&(d=e),e});var l=d&&d.name||"",c=s&&s.oauth_user_name||"",f=l&&"\u6765\u81ea".concat(l,"\u767b\u5f55\u7684"),h=e=>{return"/user/third/".concat(e,"?code=").concat(w,"&service_id=").concat(R,"&oauth_user_id=").concat(k)};return v.default.createElement("div",{className:E.default.main},v.default.createElement(i.default,{style:{margin:"24px 0"},message:"".concat(f).concat(c,"\u60a8\u597d\uff01\u4f60\u9700\u8981\u8865\u5145\u5b8c\u6574\u5e73\u53f0\u8d26\u53f7\u4fe1\u606f"),type:"info"}),v.default.createElement(n.default,{style:{marginBottom:"24px"}},v.default.createElement(u.default,{span:10,className:E.default.boxJump},!o&&v.default.createElement(_.Link,{to:h("login")},"\u5df2\u6709\u8d26\u53f7\uff0c\u9a6c\u4e0a\u7ed1\u5b9a")),v.default.createElement(u.default,{span:10,style:{background:"#CDE2FF"},className:E.default.boxJump,offset:4},v.default.createElement(_.Link,{to:h("register")},"\u672a\u6709\u8d26\u53f7\uff0c\u521b\u5efa\u8d26\u53f7"))),v.default.createElement(y.default,{user_info:s,onSubmit:this.handleSubmit,type:"thirdRegister"}))}},f=h))||f)||f);t.default=I}}]);