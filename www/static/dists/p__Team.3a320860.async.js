(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[57],{"1TN1":function(e,t,a){"use strict";var s=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var l=s(a("bx4M"));a("/xke");var n,r,o,d=s(a("TeRw")),m=a("MuoO"),c=i(a("q1tI")),u=s(a("QDog")),h=s(a("GFvx")),p=s(a("q76B")),f=s(a("puxM")),_=s(a("nqg8")),g=(n=(0,m.connect)(e=>{var t=e.teamControl,a=e.loading;return{regions:t.regions,currentTeam:t.currentTeam,toMoveTeamLoading:a.effects["teamControl/moveTeam"]}}),n((o=class extends c.PureComponent{constructor(e){super(e),this.onMoveTeam=(e=>{this.setState({toMoveTeam:e})}),this.onDelMember=(e=>{this.setState({toDeleteMember:e})}),this.onEditAction=(e=>{this.setState({toEditAction:e})}),this.hideMoveTeam=(()=>{this.setState({toMoveTeam:null})}),this.handleMoveTeam=(()=>{this.props.dispatch({type:"teamControl/moveTeam",payload:{team_name:u.default.getCurrTeamName(),user_id:this.state.toMoveTeam.user_id},callback:e=>{e&&200===e.status_code&&d.default.success({message:e.msg_show}),this.updateCurrentUser(),this.loadMembers(),this.hideMoveTeam()}})}),this.updateCurrentUser=(()=>{this.props.dispatch({type:"user/fetchCurrent"})}),this.hideEditAction=(()=>{this.setState({toEditAction:null})}),this.handleEditAction=(e=>{var t=this.state.toEditAction;this.props.dispatch({type:"teamControl/editMember",payload:{team_name:u.default.getCurrTeamName(),user_id:t.user_id,role_ids:e.role_ids},callback:()=>{this.loadMembers(),this.hideEditAction()}})}),this.showAddMember=(()=>{this.setState({showAddMember:!0})}),this.hideAddMember=(()=>{this.setState({showAddMember:!1})}),this.handleAddMember=(e=>{this.props.dispatch({type:"teamControl/addMember",payload:{team_name:u.default.getCurrTeamName(),user_ids:e.user_ids.map(e=>e.key).join(","),role_ids:e.role_ids.join(",")},callback:()=>{this.loadMembers(),this.hideAddMember()}})}),this.hideDelMember=(()=>{this.setState({toDeleteMember:null})}),this.handleDelMember=(()=>{this.props.dispatch({type:"teamControl/delMember",payload:{team_name:u.default.getCurrTeamName(),user_ids:this.state.toDeleteMember.user_id},callback:()=>{this.loadMembers(),this.hideDelMember()}})}),this.loadMembers=(()=>{var e=this.props.dispatch,t=u.default.getCurrTeamName(),a=u.default.getCurrRegionName();e({type:"teamControl/fetchTeamMember",payload:{team_name:t,region_name:a,page_size:this.state.pageSize,page:this.state.page},callback:e=>{e&&this.setState({members:e.list||[],total:e.total})}})}),this.hanldePageChange=(e=>{this.setState({page:e},()=>{this.loadMembers()})}),this.state={showAddMember:!1,toDeleteMember:null,toMoveTeam:null,page:1,pageSize:8,total:0,members:[]}}componentDidMount(){this.loadMembers()}render(){var e=this.props,t=e.currentTeam,a=e.memberPermissions,s=e.toMoveTeamLoading,i=e.memberPermissions.isCreate,n=this.state,r=n.page,o=n.pageSize,d=n.total,m=n.showAddMember,u=n.members,g=n.roles,v=n.toEditAction,E=n.toDeleteMember,b=n.toMoveTeam,C={current:r,pageSize:o,total:d,onChange:e=>{this.hanldePageChange(e)}};return c.default.createElement("div",null,c.default.createElement(l.default,{style:{marginBottom:24},bodyStyle:{paddingTop:12},bordered:!1,title:"\u56e2\u961f\u6210\u5458",extra:i&&c.default.createElement("a",{href:"javascript:;",onClick:this.showAddMember},"\u6dfb\u52a0\u6210\u5458")},c.default.createElement(f.default,{sm:600},c.default.createElement(_.default,{memberPermissions:a,pagination:C,team:t,onMoveTeam:this.onMoveTeam,onDelete:this.onDelMember,onEditAction:this.onEditAction,list:u}))),m&&c.default.createElement(h.default,{roles:g,onOk:this.handleAddMember,onCancel:this.hideAddMember}),v&&c.default.createElement(h.default,{roles:g,data:v,onOk:this.handleEditAction,onCancel:this.hideEditAction}),E&&c.default.createElement(p.default,{onOk:this.handleDelMember,title:"\u5220\u9664\u6210\u5458",subDesc:"\u6b64\u64cd\u4f5c\u4e0d\u53ef\u6062\u590d",desc:"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u6210\u5458\u5417\uff1f",onCancel:this.hideDelMember}),b&&c.default.createElement(p.default,{onOk:this.handleMoveTeam,loading:s,title:"\u79fb\u4ea4\u56e2\u961f",subDesc:"\u79fb\u4ea4\u540e\u60a8\u5c06\u5931\u53bb\u6240\u6709\u6743",desc:"\u786e\u5b9a\u8981\u628a\u56e2\u961f\u79fb\u4ea4\u7ed9 ".concat(b.nick_name," \u5417\uff1f"),onCancel:this.hideMoveTeam}))}},r=o))||r);t.default=g},"2inB":function(e,t,a){"use strict";var s=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var l,n,r,o=s(a("bx4M")),d=a("MuoO"),m=s(a("wd/R")),c=i(a("q1tI")),u=s(a("q76B")),h=s(a("QDog")),p=s(a("Jjnt")),f=s(a("XZTq")),_=(l=(0,d.connect)(e=>{var t=e.teamControl,a=e.loading;return{regions:t.regions,projectLoading:a.effects["project/fetchNotice"],activitiesLoading:a.effects["activities/fetchList"]}}),l((r=class extends c.PureComponent{constructor(e){super(e),this.onOpenRegion=(()=>{this.setState({openRegion:!0})}),this.cancelOpenRegion=(()=>{this.setState({openRegion:!1})}),this.handleOpenRegion=(e=>{this.props.dispatch({type:"teamControl/openRegion",payload:{team_name:h.default.getCurrTeamName(),region_names:e.join(",")},callback:()=>{this.fetchRegions(),this.props.dispatch({type:"user/fetchCurrent"}),this.cancelOpenRegion()}})}),this.handleCloseRegion=(()=>{var e=this.state.regionName;this.props.dispatch({type:"teamControl/closeTeamRegion",payload:{teamName:h.default.getCurrTeamName(),regionName:e},callback:()=>{this.fetchRegions(),this.props.dispatch({type:"user/fetchCurrent"}),this.cancelCloseRegion()}})}),this.fetchRegions=(()=>{var e=this.props.dispatch,t=h.default.getCurrTeamName();e({type:"teamControl/fetchRegions",payload:{team_name:t}})}),this.showCloseRegion=(e=>{this.setState({showUninstallCluster:!0,regionName:e})}),this.cancelCloseRegion=(()=>{this.setState({showUninstallCluster:!1})}),this.state={openRegion:!1,showUninstallCluster:!1,closeRegionLoading:!1}}componentDidMount(){this.fetchRegions()}render(){var e=this.props,t=e.regions,a=e.projectLoading,s=e.datecenterPermissions,i=s.isInstall,l=s.isUninstall,n=this.state,r=n.openRegion,d=n.showUninstallCluster,h=n.closeRegionLoading;return c.default.createElement("div",null,c.default.createElement(o.default,{className:f.default.projectList,style:{marginBottom:24},title:"\u5df2\u5f00\u901a\u96c6\u7fa4",bordered:!1,extra:i&&c.default.createElement("a",{onClick:this.onOpenRegion},"\u5f00\u901a\u96c6\u7fa4"),loading:a,bodyStyle:{padding:0}},(t||[]).map(e=>c.default.createElement(o.default.Grid,{className:f.default.projectGrid,key:e.ID},c.default.createElement(o.default,{bodyStyle:{padding:0},bordered:!1},c.default.createElement(o.default.Meta,{title:c.default.createElement("div",{className:f.default.cardTitle},c.default.createElement("svg",{t:"1597473134624",className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1784",width:"24",height:"24"},c.default.createElement("path",{d:"M513 564.538c-3.453 0-6.906-0.894-10-2.68L322.545 457.672a19.999 19.999 0 0 1-10-17.32V231.98a19.998 19.998 0 0 1 10-17.32L503 110.475a19.998 19.998 0 0 1 20 0L703.455 214.66a19.999 19.999 0 0 1 10 17.32v208.371a19.998 19.998 0 0 1-10 17.32L523 561.858a19.98 19.98 0 0 1-10 2.68zM352.545 428.805L513 521.444l160.455-92.64V243.527L513 150.889l-160.455 92.638v185.278z","p-id":"1785"}),c.default.createElement("path",{d:"M511.849 327.408a9.995 9.995 0 0 1-4.925-1.297l-110.393-62.465a9.998 9.998 0 0 1-0.098-17.35l111.561-64.802a10.002 10.002 0 0 1 10.017-0.017l110.395 63.634a10 10 0 0 1-0.04 17.351l-111.563 63.633a9.997 9.997 0 0 1-4.954 1.313z m-90.288-72.578l90.268 51.078 91.479-52.178-90.271-52.035-91.476 53.135z m-122.37 672.469c-3.453 0-6.906-0.894-10-2.68L108.736 820.433a19.999 19.999 0 0 1-10-17.32V594.741a19.998 19.998 0 0 1 10-17.32l180.455-104.186a19.998 19.998 0 0 1 20 0l180.456 104.186a19.999 19.999 0 0 1 10 17.32v208.371a19.998 19.998 0 0 1-10 17.32L309.191 924.619a19.991 19.991 0 0 1-10 2.68zM138.736 791.565l160.455 92.64 160.456-92.64V606.288l-160.456-92.639-160.455 92.639v185.277z","p-id":"1786"}),c.default.createElement("path",{d:"M298.039 690.169a9.995 9.995 0 0 1-4.925-1.297l-110.393-62.465a9.998 9.998 0 0 1-0.098-17.35l111.562-64.803a10.002 10.002 0 0 1 10.017-0.017l110.394 63.635a10.003 10.003 0 0 1-0.039 17.351l-111.563 63.633a10.014 10.014 0 0 1-4.955 1.313z m-90.288-72.578l90.268 51.077 91.479-52.178-90.271-52.035-91.476 53.136z m518.267 72.578a9.995 9.995 0 0 1-4.925-1.297L610.7 626.407a10 10 0 0 1-0.098-17.35l111.563-64.803a10.002 10.002 0 0 1 10.017-0.017l110.394 63.635a10.003 10.003 0 0 1-0.039 17.351l-111.563 63.633a10.02 10.02 0 0 1-4.956 1.313z m-90.288-72.578l90.268 51.077 91.479-52.178-90.271-52.035-91.476 53.136z","p-id":"1787"}),c.default.createElement("path",{d:"M725.408 927.299c-3.453 0-6.906-0.894-10-2.68L534.953 820.433a19.999 19.999 0 0 1-10-17.32V594.741a19.998 19.998 0 0 1 10-17.32l180.455-104.186a19.998 19.998 0 0 1 20 0l180.455 104.186a19.999 19.999 0 0 1 10 17.32v208.371a19.998 19.998 0 0 1-10 17.32L735.408 924.619a19.991 19.991 0 0 1-10 2.68zM564.953 791.565l160.455 92.64 160.455-92.64V606.288l-160.455-92.639-160.455 92.639v185.277z","p-id":"1788"})),c.default.createElement("a",null,e.region_alisa),l&&c.default.createElement("a",{onClick:()=>this.showCloseRegion(e.region_name),style:{float:"right",color:"#1890ff"}},"\u5378\u8f7d")),description:e.desc||"-"}),c.default.createElement("div",{className:f.default.projectItemContent},c.default.createElement("span",{className:f.default.datetime},"\u5f00\u901a\u4e8e"," ",(0,m.default)(e.create_time).locale("zh-cn").format("YYYY\u5e74-MM\u6708-DD\u65e5")))))),t&&t.length?"":c.default.createElement("p",{style:{textAlign:"center",paddingTop:20}},"\u6682\u65e0\u96c6\u7fa4")),r&&c.default.createElement(p.default,{onSubmit:this.handleOpenRegion,onCancel:this.cancelOpenRegion}),d&&c.default.createElement(u.default,{onOk:this.handleCloseRegion,loading:h,title:"\u5378\u8f7d\u96c6\u7fa4",desc:"\u5378\u8f7d\u5f53\u524d\u96c6\u7fa4\u5c06\u540c\u65f6\u5220\u9664\u56e2\u961f\u5728\u8be5\u96c6\u7fa4\u521b\u5efa\u7684\u76f8\u5173\u8d44\u6e90\uff0c\u786e\u8ba4\u8981\u5378\u8f7d\u5417?",onCancel:this.cancelCloseRegion}))}},n=r))||n);t.default=_},"4OG1":function(e,t,a){"use strict";var s=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var l=s(a("kLXV"));a("5NDa");var n=s(a("5rEg"));a("y8nQ");var r,o,d,m=s(a("Vl3Y")),c=i(a("q1tI")),u=m.default.Item,h=(r=m.default.create(),r((d=class extends c.PureComponent{constructor(){super(...arguments),this.handleSubmit=(e=>{e.preventDefault();var t=this.props.form;t.validateFields((e,t)=>{e||this.props.onSubmit(t)})}),this.onCancel=(()=>{this.props.onCancel()})}render(){var e=this.props.form.getFieldDecorator,t=this.props.teamAlias;return c.default.createElement(l.default,{title:"\u4fee\u6539\u56e2\u961f\u540d\u79f0",visible:!0,onOk:this.handleSubmit,onCancel:this.onCancel},c.default.createElement(m.default,{onSubmit:this.handleSubmit},c.default.createElement(u,{label:""},e("new_team_alias",{initialValue:t||"",rules:[{required:!0,message:"\u4e0d\u80fd\u4e3a\u7a7a!"},{max:32,message:"\u6700\u5927\u957f\u5ea632\u4f4d"}]})(c.default.createElement(n.default,{placeholder:"\u8bf7\u8f93\u5165\u65b0\u7684\u56e2\u961f\u540d\u79f0"})))))}},o=d))||o);t.default=h},"69fC":function(e,t,a){"use strict";var s=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var l=s(a("kLXV")),n=s(a("jehZ"));a("14J3");var r=s(a("BMrR"));a("g9YV");var o=s(a("wCAj"));a("P2fV");var d=s(a("NJEC"));a("jCWc");var m=s(a("kPKH"));a("IzEo");var c=s(a("bx4M"));a("Mwp2");var u=s(a("VXEj"));a("y8nQ");var h=s(a("Vl3Y"));a("OaEy");var p,f,_,g,v=s(a("2fM7")),E=a("MuoO"),b=a("7DNP"),C=i(a("q1tI")),y=s(a("QDog")),R=s(a("hMqj")),T=s(a("ck6v")),M=v.default.Option,A=h.default.Item,S=(p=h.default.create(),f=(0,E.connect)(e=>{var t=e.teamControl,a=e.loading,s=e.user;return{regions:t.regions,currUser:s.currentUser,activitiesLoading:a.effects["activities/fetchList"]}}),p(_=f((g=class extends C.PureComponent{constructor(e){super(e),this.loadEvents=(()=>{var e=y.default.getCurrTeamName();this.props.dispatch({type:"index/fetchEvents",payload:{team_name:e,page_size:this.state.pageSize,page:this.state.page},callback:e=>{e&&this.setState({events:e.list||[],total:e.total||e.list.length})}})}),this.loadRoles=(()=>{var e=this.props.dispatch;e({type:"teamControl/fetchTeamRoles",payload:{team_name:y.default.getCurrTeamName(),page_size:1e4,page:1},callback:e=>{e&&this.setState({roles:e.list||[]})}})}),this.loadJoinUsers=(()=>{var e=y.default.getCurrTeamName();this.props.dispatch({type:"teamControl/getJoinTeamUsers",payload:{team_name:e},callback:e=>{e&&this.setState({joinUsers:e.list||[]})}})}),this.hanldePageChange=(e=>{this.setState({page:e},()=>{this.loadEvents()})}),this.handleRefused=(e=>{this.props.dispatch({type:"teamControl/setJoinTeamUsers",payload:{team_name:y.default.getCurrTeamName(),user_id:e.user_id,action:!1},callback:()=>{this.loadJoinUsers()}})}),this.handleJoinShow=(e=>{this.setState({joinSettingShow:!0,joinUser:e})}),this.hideJoinShow=(()=>{this.setState({joinSettingShow:!1,joinUser:null})}),this.handleJoin=(()=>{var e=this.state.joinUser,t=this.props.form;t.validateFields((t,a)=>{t||this.props.dispatch({type:"teamControl/setJoinTeamUsers",payload:{team_name:y.default.getCurrTeamName(),user_id:e.user_id,role_ids:a.role_ids,action:!0},callback:()=>{this.hideJoinShow(),this.loadJoinUsers()}})})}),this.state={page:1,pageSize:8,total:0,events:[],roles:[],joinUsers:[],joinSettingShow:!1,joinUser:null}}componentDidMount(){this.loadEvents(),this.loadJoinUsers(),this.loadRoles()}renderActivities(){var e=this.state.events||[];return e.length?e.map(e=>{var t=e.UserName,a=e.OptType,s=e.FinalStatus,i=e.Status,l=e.create_time,n=e.Target,r="/team/".concat(y.default.getCurrTeamName(),"/region/").concat(y.default.getCurrRegionName(),"/components/").concat(e.service_alias,"/overview");return C.default.createElement(u.default.Item,{key:e.ID},C.default.createElement(u.default.Item.Meta,{title:C.default.createElement("span",null,C.default.createElement("a",{className:T.default.username},t),C.default.createElement("span",{className:T.default.event}," ",y.default.fetchStateOptTypeText(a)),"\xa0",n&&"service"===n&&C.default.createElement(b.Link,{to:r,className:T.default.event},e.service_name),C.default.createElement("span",null,"\u5e94\u7528"),C.default.createElement("span",{style:{color:y.default.fetchAbnormalcolor(a)}},y.default.fetchOperation(s,i))),description:C.default.createElement("span",{className:T.default.datatime_float,title:e.updatedAt},y.default.fetchdayTime(l))}))}):C.default.createElement("p",{style:{textAlign:"center",color:"ccc",paddingTop:20}},"\u6682\u65e0\u52a8\u6001")}render(){var e=this.props,t=e.activitiesLoading,a=e.memberPermissions.isCreate,s=e.form,i=this.state,p=i.joinSettingShow,f=i.roles,_=s.getFieldDecorator,g={current:this.state.page,pageSize:this.state.pageSize,total:this.state.total,onChange:e=>{this.hanldePageChange(e)}},E={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}};return C.default.createElement("div",null,C.default.createElement(r.default,{gutter:24},C.default.createElement(m.default,{md:12,sm:24},C.default.createElement(c.default,{bodyStyle:{paddingTop:12},bordered:!1,title:"\u52a8\u6001",loading:t},C.default.createElement(u.default,{pagination:g,loading:t,size:"large"},C.default.createElement("div",{className:T.default.activitiesList},this.renderActivities())))),C.default.createElement(m.default,{md:12,sm:24},C.default.createElement(c.default,{bodyStyle:{paddingTop:12},bordered:!1,title:"\u4ee5\u4e0b\u7528\u6237\u7533\u8bf7\u52a0\u5165\u56e2\u961f"},C.default.createElement(o.default,{pagination:!1,dataSource:this.state.joinUsers||[],columns:[{title:"\u7528\u6237",dataIndex:"user_name"},{title:"\u7533\u8bf7\u65f6\u95f4",dataIndex:"apply_time"},{title:"\u64cd\u4f5c",dataIndex:"",render:(e,t)=>0===t.is_pass&&a&&C.default.createElement(C.Fragment,null,C.default.createElement("a",{onClick:()=>this.handleJoinShow(t)},"\u901a\u8fc7"),C.default.createElement(d.default,{title:"\u786e\u5b9a\u8981\u62d2\u7edd\u7528\u6237\u4e48?",onConfirm:()=>{this.handleRefused(t)}},C.default.createElement("a",{style:{marginLeft:6}},"\u62d2\u7edd")))}]})))),p&&C.default.createElement(l.default,{title:"\u7528\u6237\u6388\u6743",visible:!0,onOk:this.handleJoin,onCancel:this.hideJoinShow},C.default.createElement(h.default,null,C.default.createElement(A,(0,n.default)({},E,{label:"\u9009\u62e9\u89d2\u8272"}),_("role_ids",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u89d2\u8272"}]})(C.default.createElement(v.default,{getPopupContainer:e=>e.parentNode,mode:"multiple",placeholder:"\u8bf7\u9009\u62e9\u89d2\u8272",style:{width:"100%"}},f.map(e=>{var t=e.ID,a=e.name;return C.default.createElement(M,{key:t,value:t},R.default.actionMap(a))})))))))}},_=g))||_)||_);t.default=S},CEQl:function(e,t,a){"use strict";var s=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var l=s(a("W9HT")),n=s(a("jehZ"));a("5NDa");var r=s(a("5rEg"));a("+L6B");var o=s(a("2/Rp"));a("/xke");var d=s(a("TeRw"));a("y8nQ");var m=s(a("Vl3Y"));a("ozfa");var c,u,h,p,f=s(a("MJZm")),_=a("MuoO"),g=i(a("q1tI")),v=s(a("QDog")),E=s(a("hMqj")),b=s(a("CXnr")),C=f.default.TreeNode,y=m.default.Item,R=(c=m.default.create(),u=(0,_.connect)(e=>{var t=e.teamControl,a=e.loading,s=e.user;return{teamControl:t,currUser:s.currentUser,activitiesLoading:a.effects["activities/fetchList"]}}),c(h=u((p=class extends g.PureComponent{constructor(e){var t;super(e),t=this,this.onExpand=(e=>{this.setState({expandedKeys:e,autoExpandParent:!1})}),this.onCheck=(e=>{this.setState({checkedKeys:e})}),this.onSelect=(e=>{this.setState({selectedKeys:e})}),this.handleResetRoleForm=(()=>{var e=this.props.form;this.setState({rolePermissionItem:null,expandedKeys:[],autoExpandParent:!0,checkedKeys:[],selectedKeys:[]}),e.resetFields()}),this.handleAddRole=(e=>{var t=this.props.dispatch;t({type:"teamControl/createRole",payload:{team_name:v.default.getCurrTeamName(),name:e.name},callback:e=>{if(e&&200===e.status_code)return this.loadTeamRolesPermissions(e.bean.ID,!0);this.handleCloseLoading()}})}),this.loadTeamRolesPermissions=function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=t.props.dispatch;s({type:"teamControl/fetchTeamRolesPermissions",payload:{team_name:v.default.getCurrTeamName(),role_id:e},callback:e=>{if(e&&200===e.status_code){var s=e.bean&&e.bean.permissions||null;s&&t.handlePermissions(e.bean,a)}}})},this.handlePermissions=((e,t)=>{var a=this.props.permissions,s=this.state.checkedKeys,i=[],l=e;a&&(a.team.perms.map((e,t)=>{var a=e.code,n=e.name,r=l.permissions.team.perms;r[t][n]&&i.push("".concat(a)),s&&(s.includes("".concat(a))?r[t][n]=!0:r[t][n]=!1)}),this.handlePermissionsSubmodels(a.team.sub_models,l.permissions.team.sub_models,i)),s&&(t?this.setState({rolePermissionItem:l},()=>{this.handleRolePermissions(l)}):this.setState({expandedKeys:i,checkedKeys:i,autoExpandParent:!0}))}),this.handlePermissionsSubmodels=((e,t,a)=>{var s=this.state.checkedKeys;e.map(e=>{t.map(t=>{var i=Object.keys(e)[0],l=Object.keys(t)[0];if(i===l){if(e[i].sub_models&&e[i].sub_models.length>0)return this.handlePermissionsSubmodels(e[i].sub_models,t[l].sub_models,a);e[i].perms.map(e=>{t[l].perms.map(t=>{var i=e.code,l=e.name,n=Object.keys(t)[0];n===l&&(t[l]&&a.push("".concat(i)),s&&(s.includes("".concat(i))?t[l]=!0:t[l]=!1))})})}})})}),this.handleRoleName=((e,t)=>{if(t&&t.length>0){var a=t.filter(t=>{return"".concat(t.ID)==="".concat(e)});if(a&&a.length>0){var s=this.props.form.setFieldsValue;s({name:a[0].name})}}}),this.handleEditRole=(e=>{var t=this.props,a=t.dispatch,s=t.rolesID;a({type:"teamControl/editRole",payload:{team_name:v.default.getCurrTeamName(),role_id:s,name:e.name},callback:e=>{if(e&&200===e.status_code)return this.loadTeamRolesPermissions(e.bean.ID,!0);this.handleCloseLoading()}})}),this.handleRolePermissions=(e=>{if(e){var t=this.props,a=t.dispatch,s=t.onCancelAddRole,i=t.isAddRole;a({type:"teamControl/updateRolePermissions",payload:{team_name:v.default.getCurrTeamName(),role_id:e.role_id,permissions:e.permissions},callback:e=>{e&&200===e.status_code&&(s(parseInt(e.bean.role_id)),d.default.success({message:i?"\u521b\u5efa\u6210\u529f":"\u7f16\u8f91\u6210\u529f"})),this.handleCloseLoading()}})}}),this.handleCloseLoading=(()=>{this.setState({loading:!1})}),this.handleSubmit=(()=>{this.props.form.validateFields((e,t)=>{if(!e){var a=this.props.isAddRole;this.setState({loading:!0},()=>{a?this.handleAddRole(t):this.handleEditRole(t)})}})}),this.renderTreePermsNodes=(e=>{return e.map(e=>{var t=e.code,a=e.desc;return g.default.createElement(C,{key:t,title:a})})}),this.renderTreeNodes=(e=>e.map(e=>{var t=Object.keys(e)[0];return e[t].sub_models&&e[t].sub_models.length>0?this.renderTreeNodes(e[t].sub_models):g.default.createElement(C,{key:t,title:E.default.fetchAccessText(t)},e[t].perms.map(e=>{return g.default.createElement(C,{key:e.code,title:e.desc})}))})),this.handleSubmitButton=((e,t)=>{return g.default.createElement(o.default,{loading:e,type:"primary",onClick:this.handleSubmit},t?"\u65b0\u589e":"\u4fdd\u5b58\u4fee\u6539")}),this.state={rolePermissionItem:null,expandedKeys:[],autoExpandParent:!0,checkedKeys:[],selectedKeys:[],loading:!1}}componentDidMount(){var e=this.props,t=e.rolesID,a=e.roleList;t&&(this.loadTeamRolesPermissions(t),this.handleRoleName(t,a))}componentWillReceiveProps(e){(this.props.rolesID!==e.rolesID&&e.rolesID||this.props.isAddRole!==e.isAddRole&&!e.isAddRole)&&(this.loadTeamRolesPermissions(e.rolesID),this.handleRoleName(e.rolesID,e.roleList)),(this.props.isAddRole!==e.isAddRole&&e.isAddRole||!e.rolesID&&!e.isAddRole)&&this.handleResetRoleForm(e.isAddRole)}render(){var e=this.props,t=e.form,a=e.permissions,s=e.permissionsLoading,i=e.isAddRole,d=e.onCancelAddRole,c=e.isEdit,u=e.isCreate,h=this.state,p=h.expandedKeys,_=h.autoExpandParent,v=h.checkedKeys,E=h.selectedKeys,R=h.loading,T=t.getFieldDecorator,M={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:14}}};return g.default.createElement(m.default,{onSubmit:this.handleSubmit},g.default.createElement(l.default,{spinning:s},g.default.createElement("div",{className:b.default.AuthModuleWrap},g.default.createElement(y,(0,n.default)({},M,{label:"\u89d2\u8272\u540d\u79f0"}),T("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0!"},{max:32,message:"\u6700\u5927\u957f\u5ea632\u4f4d"}]})(g.default.createElement(r.default,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"}))),a&&g.default.createElement(y,(0,n.default)({},M,{label:"\u6743\u9650\u5206\u914d"}),T("permissions",{rules:[{required:!1,message:"\u6743\u9650\u5206\u914d!"}]})(g.default.createElement(f.default,{className:b.default.tree,checkable:!0,onExpand:this.onExpand,expandedKeys:p,autoExpandParent:_,onCheck:this.onCheck,checkedKeys:v,onSelect:this.onSelect,selectedKeys:E},a.team.perms.map(e=>{var t=e.code,a=e.desc;return g.default.createElement(C,{key:t,title:a})}),this.renderTreeNodes(a.team.sub_models)))))),g.default.createElement("div",{className:b.default.systemFormBtn},i&&g.default.createElement(o.default,{onClick:d,style:{marginRight:"20px"}},"\u53d6\u6d88"),!i&&c&&this.handleSubmitButton(R,i),u&&i&&this.handleSubmitButton(R,i)))}},h=p))||h)||h);t.default=R},CXnr:function(e,t,a){e.exports={nameID:"nameID___p9uAZ",icon:"icon___3R8Sp",iconm:"iconm___24A6n",systemRoleWrapper:"systemRoleWrapper___2_MW5",systemRole:"systemRole___1v3ii",systemRoleTitle:"systemRoleTitle___2axA0",authSettingBody:"authSettingBody___F6WcO",roleName:"roleName___2oW2k",projectList:"projectList___2hnQq",cardTitle:"cardTitle___EaLdl",projectGrid:"projectGrid___3QVYj",projectItemContent:"projectItemContent___2cp8H",datetime:"datetime___2qUj5",noRole:"noRole___3VLyn",systemRoleList:"systemRoleList___2QGX-",AuthModuleWrap:"AuthModuleWrap___2FBuO",systemFormBtn:"systemFormBtn___f_HBr",systemRoleBtn:"systemRoleBtn___15D15",tree:"tree___1dghD"}},IzeZ:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEcAAABGCAYAAACe7Im6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4FpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjMjYwMjM1My00YTg5LTQzYTgtODg4Mi1kNWI0M2Q4MzJhZGQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NDZFMTdENjAxRUVGMTFFODgxRDFFMjkwOTQxREFDNTEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NDZFMTdENUYxRUVGMTFFODgxRDFFMjkwOTQxREFDNTEiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MWJlMThkMGMtYzM4NS00MjFjLWEwZmEtN2UwMzNmNTI4Y2ZmIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ZjY4ZTBkYjktNzZhMy0wNjQzLTk3NmItYjVl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"},PVYy:function(e,t,a){"use strict";var s=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("R9oj");var l=s(a("ECub"));a("+L6B");var n=s(a("2/Rp"));a("T2oS");var r=s(a("W9HT"));a("Pwec");var o=s(a("CtXQ"));a("Znn+");var d=s(a("ZTPi"));a("lUTK");var m,c,u,h=s(a("BvKs")),p=a("MuoO"),f=i(a("q1tI")),_=s(a("QDog")),g=s(a("hMqj")),v=s(a("q76B")),E=s(a("CXnr")),b=s(a("CEQl")),C=h.default.Item,y=d.default.TabPane,R=(m=(0,p.connect)(e=>{var t=e.teamControl,a=e.loading;return{teamControl:t,activitiesLoading:a.effects["activities/fetchList"]}}),m((u=class extends f.PureComponent{constructor(e){var t;super(e),t=this,this.onDelRole=(e=>{this.setState({deleteRole:e})}),this.showAddRole=(()=>{this.setState({showAddRole:!0})}),this.hideAddRole=(e=>{if(this.setState({showAddRole:!1}),e&&"number"===typeof e)return this.loadTeamRoles(e)}),this.handleDelRole=(()=>{this.props.dispatch({type:"teamControl/removeRole",payload:{team_name:_.default.getCurrTeamName(),role_id:this.state.deleteRole.ID},callback:()=>{this.hideDelRole(),this.loadTeamRoles()}})}),this.hideDelRole=(()=>{this.setState({deleteRole:null})}),this.loadTeamRoles=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=t.props.dispatch;a({type:"teamControl/fetchTeamRoles",payload:{team_name:_.default.getCurrTeamName()},callback:a=>{if(a&&200===a.status_code){var s=null;a.list&&a.list.length>0&&(s=a.list[0].ID),t.setState({roleList:a.list,rolesID:e||s,rolesLoading:!1})}}})},this.loadPermissions=(()=>{var e=this.props.dispatch;e({type:"global/fetchPermissions",callback:e=>{e&&200===e.status_code&&this.setState({permissions:e.bean||[],permissionsLoading:!1})}})}),this.selectKey=(e=>{var t=e.key;this.setState({rolesID:t})}),this.state={showAddRole:!1,roleList:[],rolesID:null,rolesLoading:!0,permissions:null,permissionsLoading:!0}}componentDidMount(){this.loadTeamRoles(),this.loadPermissions()}render(){var e=this.props.rolePermissions,t=e.isCreate,a=e.isEdit,s=e.isDelete,i=this.state,m=i.roleList,c=i.rolesLoading,u=i.permissions,p=i.permissionsLoading,_=i.showAddRole,R=i.rolesID,T=i.deleteRole,M=m&&m.length>0;return f.default.createElement(f.Fragment,null,f.default.createElement("div",{className:E.default.systemRoleWrapper},f.default.createElement("div",{className:E.default.systemRole},f.default.createElement("div",{className:E.default.systemRoleTitle},"\u89d2\u8272\u5217\u8868"),f.default.createElement(r.default,{spinning:c},f.default.createElement("div",{className:E.default.systemRoleList},M&&f.default.createElement(h.default,{mode:"inline",selectedKeys:["".concat(R)],onClick:this.selectKey},m.map(e=>{var t=e.ID,a=e.name;return f.default.createElement(C,{key:t,className:E.default.roleName},f.default.createElement("div",null," ",g.default.actionMap(a)),s&&f.default.createElement(o.default,{type:"delete",onClick:()=>{this.onDelRole(e)}}))})))),f.default.createElement("div",{className:E.default.systemRoleBtn},!_&&t&&f.default.createElement(n.default,{type:"primary",onClick:this.showAddRole},"\u6dfb\u52a0\u89d2\u8272"))),f.default.createElement("div",{className:E.default.authSettingBody},f.default.createElement(d.default,{defaultActiveKey:"1"},f.default.createElement(y,{tab:"\u6743\u9650\u8bbe\u7f6e",key:"1"},M||p||_?f.default.createElement(b.default,{isEdit:a,isCreate:t,isAddRole:_,onCancelAddRole:this.hideAddRole,rolesID:R,roleList:m,permissions:u,permissionsLoading:p}):f.default.createElement("div",{className:E.default.noRole},f.default.createElement(l.default,{description:f.default.createElement("span",null,"\u6682\u65e0\u89d2\u8272\u3001\u8bf7\u5148\u6dfb\u52a0\u89d2\u8272")})))))),T&&f.default.createElement(v.default,{onOk:this.handleDelRole,title:"\u5220\u9664\u89d2\u8272",subDesc:"\u6b64\u64cd\u4f5c\u4e0d\u53ef\u6062\u590d",desc:"\u786e\u5b9a\u8981\u5220\u9664\u89d2\u8272 \uff08".concat(T.name,"\uff09 \u5417\uff1f"),onCancel:this.hideDelRole}))}},c=u))||c);t.default=R},T1ah:function(e,t,a){"use strict";var s=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var l=s(a("2/Rp"));a("Pwec");var n=s(a("CtXQ"));a("Telt");var r,o,d,m=s(a("Tckk")),c=s(a("p0pE")),u=a("MuoO"),h=a("7DNP"),p=s(a("wd/R")),f=i(a("q1tI")),_=s(a("IzeZ")),g=s(a("q76B")),v=s(a("2inB")),E=s(a("69fC")),b=s(a("1TN1")),C=s(a("PVYy")),y=s(a("XZXw")),R=a("vSx2"),T=s(a("QDog")),M=s(a("hMqj")),A=s(a("zcww")),S=s(a("mzlC")),N=s(a("4OG1")),D=(r=(0,u.connect)(e=>{var t=e.user,a=e.teamControl,s=e.loading,i=e.enterprise;return{currUser:t.currentUser,teamControl:a,projectLoading:s.effects["project/fetchNotice"],activitiesLoading:s.effects["activities/fetchList"],currentTeam:a.currentTeam,currentRegionName:a.currentRegionName,currentEnterprise:i.currentEnterprise,currentTeamPermissionsInfo:a.currentTeamPermissionsInfo}}),r((d=class extends f.PureComponent{constructor(e){super(e),this.handleEventPermissions=(e=>{var t=this.props.currentTeamPermissionsInfo;return M.default.queryTeamBasicInfo(t,e)}),this.handlePermissions=(e=>{var t=this.props.currentTeamPermissionsInfo;return M.default.querySpecifiedPermissionsInfo(t,e)}),this.showEditName=(()=>{this.setState({showEditName:!0})}),this.hideEditName=(()=>{this.setState({showEditName:!1})}),this.showExitTeam=(()=>{this.setState({showExitTeam:!0})}),this.hideExitTeam=(()=>{this.setState({showExitTeam:!1})}),this.handleExitTeam=(()=>{var e=this.props.dispatch,t=this.state.teamsUrl;e({type:"teamControl/exitTeam",payload:{team_name:T.default.getCurrTeamName()},callback:a=>{a&&200===a.status_code&&e(h.routerRedux.push(t))}})}),this.showDelTeam=(()=>{this.setState({showDelTeam:!0})}),this.hideDelTeam=(()=>{this.setState({showDelTeam:!1})}),this.handleEditName=(e=>{this.props.dispatch({type:"teamControl/editTeamAlias",payload:(0,c.default)({team_name:T.default.getCurrTeamName()},e),callback:()=>{this.props.dispatch({type:"user/fetchCurrent"}),this.hideEditName(),this.handleUpDataHeader()}})}),this.handleUpDataHeader=(()=>{var e=this.props.dispatch;e({type:"global/IsUpDataHeader",payload:{isUpData:!0}})}),this.handleDelTeam=(()=>{var e=this.state.teamsUrl,t=this.props.dispatch;t({type:"teamControl/delTeam",payload:{team_name:T.default.getCurrTeamName()},callback:a=>{a&&200===a.status_code&&t(h.routerRedux.push(e))}})}),this.handleTabChange=(e=>{this.setState({scope:e})}),this.state={showEditName:!1,showDelTeam:!1,showExitTeam:!1,scope:"",teamsUrl:this.props.currentEnterprise?"/enterprise/".concat(this.props.currentEnterprise.enterprise_id,"/teams"):"/",eventPermissions:this.handleEventPermissions("dynamic_describe"),memberPermissions:this.handlePermissions("queryTeamMemberInfo"),datecenterPermissions:this.handlePermissions("queryTeamRegionInfo"),rolePermissions:this.handlePermissions("queryTeamRolesInfo")}}componentWillMount(){var e=this.props.dispatch,t=this.state,a=t.eventPermissions,s=t.memberPermissions.isAccess,i=t.datecenterPermissions.isAccess,l=t.rolePermissions.isAccess;a||s||i||l||T.default.withoutPermission(e);var n="";n=a?"event":s?"member":i?"datecenter":"role",this.setState({scope:n});var r=this.props.location.state;r&&r.config&&this.setState({scope:r.config})}componentDidMount(){this.props.dispatch({type:"teamControl/fetchAllPerm"})}getParam(){return this.props.match.params}render(){var e=this.props,t=e.currUser,a=e.currentEnterprise,s=e.currentTeam,i=e.currentRegionName,r=this.state,o=r.scope,d=r.showEditName,c=r.showDelTeam,u=r.showExitTeam,h=r.eventPermissions,T=r.memberPermissions,M=r.datecenterPermissions,D=r.rolePermissions,k=r.memberPermissions.isAccess,I=r.datecenterPermissions.isAccess,P=r.rolePermissions.isAccess,L=(r.tabActiveKey,f.default.createElement("div",{className:S.default.pageHeaderContent},f.default.createElement("div",{className:S.default.avatar},f.default.createElement(m.default,{size:"large",src:_.default})),f.default.createElement("div",{className:S.default.content},f.default.createElement("div",{className:S.default.contentTitle},s.team_alias," ",A.default.canEditTeamName(s)&&f.default.createElement(n.default,{onClick:this.showEditName,type:"edit"})),f.default.createElement("div",null,"\u521b\u5efa\u4e8e",(0,p.default)(s.create_time).locale("zh-cn").format("YYYY-MM-DD"))))),j=A.default.canDeleteTeam(t),w=f.default.createElement("div",{className:S.default.extraContent},f.default.createElement("div",{className:S.default.extraBtns},!j&&f.default.createElement(l.default,{onClick:this.showExitTeam,type:"dashed"},"\u9000\u51fa\u56e2\u961f"),f.default.createElement(l.default,{disabled:!j,onClick:this.showDelTeam,type:"dashed"},"\u5220\u9664\u56e2\u961f"))),x=[];h&&x.push({key:"event",tab:"\u52a8\u6001"}),k&&x.push({key:"member",tab:"\u6210\u5458"}),I&&x.push({key:"datecenter",tab:"\u96c6\u7fa4"}),P&&x.push({key:"role",tab:"\u89d2\u8272"});var B=[];return B=(0,R.createTeam)((0,R.createEnterprise)(B,a),s,i),B.push({title:"\u56e2\u961f\u8bbe\u7f6e"}),f.default.createElement(y.default,{breadcrumbList:B,tabList:x,tabActiveKey:o,onTabChange:this.handleTabChange,content:L,extraContent:w},"datecenter"===o&&f.default.createElement(v.default,{datecenterPermissions:M}),"member"===o&&f.default.createElement(b.default,{memberPermissions:T}),"role"===o&&f.default.createElement(C.default,{rolePermissions:D}),"event"===o&&h&&f.default.createElement(E.default,{memberPermissions:T}),d&&f.default.createElement(N.default,{teamAlias:s.team_alias,onSubmit:this.handleEditName,onCancel:this.hideEditName}),c&&f.default.createElement(g.default,{onOk:this.handleDelTeam,title:"\u5220\u9664\u56e2\u961f",subDesc:"\u6b64\u64cd\u4f5c\u4e0d\u53ef\u6062\u590d",desc:"\u786e\u5b9a\u8981\u5220\u9664\u6b64\u56e2\u961f\u548c\u56e2\u961f\u4e0b\u7684\u6240\u6709\u8d44\u6e90\u5417\uff1f",onCancel:this.hideDelTeam}),u&&f.default.createElement(g.default,{onOk:this.handleExitTeam,title:"\u9000\u51fa\u56e2\u961f",subDesc:"\u6b64\u64cd\u4f5c\u4e0d\u53ef\u6062\u590d",desc:"\u786e\u5b9a\u8981\u9000\u51fa\u6b64\u56e2\u961f\u5417?",onCancel:this.hideExitTeam}))}},o=d))||o);t.default=D},XZTq:function(e,t,a){e.exports={nameID:"nameID___mjeTv",icon:"icon___2qJef",iconm:"iconm___1egs4",projectList:"projectList___3NjmB",cardTitle:"cardTitle___175nG",projectGrid:"projectGrid___1Uvu0",projectItemContent:"projectItemContent___3V0J4",datetime:"datetime___1PUaI"}},ck6v:function(e,t,a){e.exports={nameID:"nameID___1vhpm",icon:"icon___3m2j5",iconm:"iconm___3XT2O",activitiesList:"activitiesList___1UL9h",username:"username___2IePj",event:"event___1khhW",pageHeaderContent:"pageHeaderContent___3x0yD",avatar:"avatar___3sxRb",content:"content___1yF-R",contentTitle:"contentTitle___tqx2z",extraContent:"extraContent___2ASE1",statItem:"statItem___2-aLt",extraBtns:"extraBtns___z9NVU",members:"members___3MVUR",member:"member___3EwYc",projectList:"projectList___NGWfL",cardTitle:"cardTitle___1ElDp",projectGrid:"projectGrid___14c51",projectItemContent:"projectItemContent___3zMY4",datetime:"datetime___3zIEP",eventStatus:"eventStatus___3tQNy",datatime_float:"datatime_float___3jO9v",activeCard:"activeCard___2eWRL",tableList:"tableList___2kiaw",tableListOperator:"tableListOperator___3o_rz",tableListForm:"tableListForm___SUb2s",submitButtons:"submitButtons___3X9YA"}},mzlC:function(e,t,a){e.exports={nameID:"nameID___3LtGN",icon:"icon___1Pqh3",iconm:"iconm___3CAY7",activitiesList:"activitiesList___2EDh5",username:"username___1HTAc",event:"event___3HDPV",pageHeaderContent:"pageHeaderContent___2cxSM",avatar:"avatar___mCYpg",content:"content___3TccU",contentTitle:"contentTitle___2wrqz",extraContent:"extraContent___1KGdJ",statItem:"statItem___1H4NU",extraBtns:"extraBtns___1ZX24",members:"members___3zFaQ",member:"member___2YSMN",projectList:"projectList___3f2yo",cardTitle:"cardTitle___2hili",projectGrid:"projectGrid___3TTk_",projectItemContent:"projectItemContent___9scnQ",datetime:"datetime___3LV_M",eventStatus:"eventStatus___2NYEF",activeCard:"activeCard___3tuU1",tableList:"tableList___2B8_s",tableListOperator:"tableListOperator___vZlmN",tableListForm:"tableListForm___26-Xb",submitButtons:"submitButtons___2a5jy"}},nqg8:function(e,t,a){"use strict";var s=a("tAuX"),i=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("g9YV");var l=i(a("wCAj")),n=s(a("q1tI")),r=i(a("zcww")),o=i(a("hMqj"));class d extends n.PureComponent{render(){var e=this.props,t=e.list,a=e.pagination,s=e.onDelete,i=e.onEditAction,d=e.onMoveTeam,m=e.memberPermissions,c=m.isEdit,u=m.isDelete,h=e.team,p=[{title:"\u7528\u6237\u540d",dataIndex:"nick_name"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u89d2\u8272",dataIndex:"roles",render(e){return n.default.createElement("span",null,(e||[]).map(e=>{return n.default.createElement("span",{style:{marginRight:"8px"},key:"role".concat(e.role_id)},o.default.actionMap(e.role_name))}))}},{title:"\u64cd\u4f5c",dataIndex:"action",render(e,t){return n.default.createElement("div",null,u&&n.default.createElement("a",{href:"javascript:;",onClick:()=>{s(t)}},"\u5220\u9664"),c&&n.default.createElement("a",{style:{marginLeft:6},onClick:()=>{i(t)},href:"javascript:;"},"\u4fee\u6539\u89d2\u8272"),r.default.canChangeOwner(h)&&n.default.createElement("a",{style:{marginLeft:6},onClick:()=>{d(t)},href:"javascript:;"},"\u79fb\u4ea4\u56e2\u961f"))}}];return n.default.createElement(l.default,{pagination:a,dataSource:t,columns:p})}}var m=d;t.default=m}}]);